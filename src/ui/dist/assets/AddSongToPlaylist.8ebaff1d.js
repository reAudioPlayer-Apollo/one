import{M as w}from"./MiniPlayer.ec59e54c.js";import{_ as f,e as c,l as g,o as n,c as d,g as p,w as u,a as e,m as _,v as b,F as S,i as P,t as h,b as k,d as M,p as V,h as C}from"./index.c9ec6f55.js";const T={components:{MiniPlayer:w},name:"AddSongToPlaylist",props:{cover:String,artist:String,title:String,src:String},data(){return{showModal:!1,selectedPlaylist:-1,track:{},playlists:[]}},methods:{preview(){console.log(this.href);const s=new CustomEvent("player.play",{detail:{artist:this.artist,title:this.title,source:this.href}});window.dispatchEvent(s)},share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:this.href})}).then(s=>s.json()).then(s=>{this.track=s})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},add(){const s=this.track,t=this.playlists.findIndex(l=>l==this.selectedPlaylist);if(console.log(s,t),t<0){alert("no playlist selected");return}console.log("jioqwejioqwjeioqwjheio\xFCqwheuioqwhruioqwhneiopqwe"),console.log(this.src),fetch(`/api/playlists/${t}/tracks`,{method:"POST",body:JSON.stringify({source:this.src})}).then(l=>{l.status==200&&(s.added=!0,this.close())})}},watch:{showModal(){!this.showModal||(fetch("/api/playlists").then(s=>s.json()).then(s=>{this.playlists.length=0,this.playlists.push(...s)}),this.loadMetadata())}}},r=s=>(V("data-v-b01293b3"),s=s(),C(),s),q={class:"wrapper"},N={class:"header"},j=r(()=>e("h3",null,"Add song",-1)),A=r(()=>e("span",{class:"material-icons-round"}," close ",-1)),I=[A],x=r(()=>e("h4",null,"To Playlist",-1)),O=r(()=>e("br",null,null,-1)),B=["src"],D={class:"details"},E={class:"detailswrapper"},F={class:"confirm"};function J(s,t,l,U,i,a){const v=c("h7");c("mini-player");const m=c("vue-final-modal"),y=g("observe-visibility");return n(),d("div",null,[p(m,{modelValue:i.showModal,"onUpdate:modelValue":t[4]||(t[4]=o=>i.showModal=o),classes:"modal-container","content-class":"modal-content"},{default:u(()=>[e("div",q,[e("div",N,[j,e("button",{class:"modal-close",onClick:t[0]||(t[0]=(...o)=>a.close&&a.close(...o))},I)]),x,_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>i.selectedPlaylist=o)},[(n(!0),d(S,null,P(i.playlists,o=>(n(),d("option",{key:o},h(o),1))),128))],512),[[b,i.selectedPlaylist]]),O,e("div",null,[_((n(),d("div",{class:"padding-20 playlisteditor",onClick:t[2]||(t[2]=(...o)=>s.editPlaylist&&s.editPlaylist(...o))},[e("img",{class:"cover",src:l.cover},null,8,B),e("div",D,[e("div",E,[p(v,null,{default:u(()=>[k("Song")]),_:1})]),e("h1",null,h(l.title),1),e("h5",null,h(l.artist),1)])])),[[y,s.headerVisibilityChanged]])]),e("div",F,[M("",!0),e("button",{onClick:t[3]||(t[3]=(...o)=>a.add&&a.add(...o)),class:"negative"},"Add")])])]),_:1},8,["modelValue"])])}const G=f(T,[["render",J],["__scopeId","data-v-b01293b3"]]);export{G as A};
