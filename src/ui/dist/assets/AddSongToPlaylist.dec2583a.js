import{M as w}from"./MiniPlayer.6d4b6797.js";import{_ as g,e as c,l as S,o as n,c as r,g as h,w as u,a as e,m as _,v as b,F as P,i as k,t as p,b as M,p as C,h as T}from"./index.1bb84c2c.js";const V={components:{MiniPlayer:w},name:"AddSongToPlaylist",props:{cover:String,artist:String,title:String,href:String,preview:String},data(){return{showModal:!1,selectedPlaylist:-1,track:{},playlists:[]}},methods:{preview(){console.log(this.href);const s=new CustomEvent("player.play",{detail:{artist:this.artist,title:this.title,source:this.href}});window.dispatchEvent(s)},share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:this.href})}).then(s=>s.json()).then(s=>{this.track=s})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},add(){const s=this.track,t=this.playlists.findIndex(i=>i==this.selectedPlaylist);if(console.log(s,t),t<0){alert("no playlist selected");return}fetch(`/api/playlists/${t}/tracks`,{method:"POST",body:JSON.stringify({source:s.src,title:s.title,artist:s.artists.join(", "),album:this.title,cover:this.cover})}).then(i=>{i.status==200&&(s.added=!0,this.close())})}},watch:{showModal(){!this.showModal||(fetch("/api/playlists").then(s=>s.json()).then(s=>{this.playlists.length=0,this.playlists.push(...s)}),this.loadMetadata())}}},d=s=>(C("data-v-970291a8"),s=s(),T(),s),A={class:"wrapper"},I={class:"header"},N=d(()=>e("h3",null,"Add song",-1)),x=d(()=>e("span",{class:"material-icons-round"}," close ",-1)),O=[x],j=d(()=>e("h4",null,"To Playlist",-1)),B=d(()=>e("br",null,null,-1)),D=["src"],E={class:"details"},F={class:"detailswrapper"},J={class:"confirm"};function U(s,t,i,L,a,o){const v=c("h7"),m=c("mini-player"),y=c("vue-final-modal"),f=S("observe-visibility");return n(),r("div",null,[h(y,{modelValue:a.showModal,"onUpdate:modelValue":t[6]||(t[6]=l=>a.showModal=l),classes:"modal-container","content-class":"addAlbumToPlaylistPopup"},{default:u(()=>[e("div",A,[e("div",I,[N,e("button",{class:"modal-close",onClick:t[0]||(t[0]=(...l)=>o.close&&o.close(...l))},O)]),j,_(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>a.selectedPlaylist=l)},[(n(!0),r(P,null,k(a.playlists,l=>(n(),r("option",{key:l},p(l),1))),128))],512),[[b,a.selectedPlaylist]]),B,e("div",null,[_((n(),r("div",{class:"padding-20 playlisteditor",onClick:t[4]||(t[4]=(...l)=>s.editPlaylist&&s.editPlaylist(...l))},[e("img",{class:"cover",src:i.cover},null,8,D),e("div",E,[e("div",F,[h(v,null,{default:u(()=>[M("Song")]),_:1}),e("span",{class:"material-icons-round share",onClick:t[2]||(t[2]=(...l)=>o.share&&o.share(...l))},"share"),e("span",{class:"material-symbols-rounded share fill",onClick:t[3]||(t[3]=(...l)=>o.preview&&o.preview(...l))},"play_arrow")]),e("h1",null,p(i.title),1),e("h5",null,p(i.artist),1)])])),[[f,s.headerVisibilityChanged]])]),e("div",J,[h(m,{class:"miniPlayer",title:i.title,artist:i.artist,src:a.track.src},null,8,["title","artist","src"]),e("button",{onClick:t[5]||(t[5]=(...l)=>o.add&&o.add(...l)),class:"negative"},"Add")])])]),_:1},8,["modelValue"])])}const G=g(V,[["render",U],["__scopeId","data-v-970291a8"]]);export{G as A};
