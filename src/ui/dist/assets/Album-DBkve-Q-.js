import{e as I,z as N,m as A,A as k,l as n,B as D,v as B,f as j,o as l,c as i,i as f,a6 as F,d as _,g as m,L,a,E as P,H as U,t as S,P as H,F as y,h as $,a1 as M,w as V,ak as z,N as R,af as q,ao as J,_ as O}from"./index-CTxjSbok.js";import{P as G}from"./PlaylistEntry-DrzB4VXk.js";import"./EditSong.vue_vue_type_script_setup_true_lang-DjK7BvWu.js";import"./playerInPicture-Dfp9IAsf.js";const K={key:1,class:"fill-page"},Q={key:2,class:"artist p-4"},T={class:"wrap"},W={class:"artist__data"},X={class:"upper"},Y={class:"track__info__details flex flex-col justify-end"},Z={class:"text-secondary my-0 text-2xl font-bold"},ee={key:0,class:"text-muted text-base ml-4 font-light"},se={class:"trac__info__details__normal"},ae={class:"flex flew-row items-center"},te={class:"font-black text-5xl"},le={class:"items"},oe={class:"items"},ne=I({__name:"Album",setup(ie){const h=N();A();const C=k(()=>h.params.hash),s=n(null),v=n([]),r=n(null),c=n(null),p=n("url"),b=n(!1),w=async()=>{const e=await(await fetch(`/api/albums/${C.value}`)).json();if(e.spotify=e.spotify?JSON.parse(e.spotify):null,e.spotify)try{e.spotify.releaseDate=new Date(e.spotify.releaseDate)}catch{e.spotify.releaseDate=null}s.value=e,r.value=null,c.value="",b.value=!1,s.value.spotify.url.length&&(c.value=s.value.spotify.url,E(s.value.spotify.id),b.value=!0),p.value="link"},E=async t=>{const e=await fetch(`/api/spotify/albums/${t}`);if(!e){R.addError("Failed to fetch album from Spotify",await e.text(),3e3);return}v.value=await e.json()};D(c,()=>{var t,e;if(((e=(t=s.value)==null?void 0:t.spotify)==null?void 0:e.id)==J(c.value,"album")){p.value="link";return}p.value="save"});const x=k(()=>{var t,e,d;return((d=(e=(t=s.value)==null?void 0:t.spotify)==null?void 0:e.releaseDate)==null?void 0:d.toLocaleDateString())??""});return B(w),D(()=>h.params.name,()=>{s.value=null,w()}),(t,e)=>{var g;const d=j("Card");return l(),i(y,null,[s.value?(l(),f(F,{key:0,src:s.value.image,class:"-z-10"},null,8,["src"])):_("",!0),s.value?(l(),i("div",Q,[a("div",T,[a("div",W,[a("div",X,[m(P,{src:s.value.image,class:"max-w-sm rounded-xl",placeholder:"library_music",name:s.value.name},null,8,["src","name"]),a("div",Y,[a("h3",Z,[m(U,{artist:s.value.artists.join(", "),class:"inline"},null,8,["artist"]),x.value?(l(),i("span",ee,S(x.value),1)):_("",!0)]),a("div",se,[a("div",ae,[a("h1",te,S(s.value.name),1)])])])]),m(H,{class:"hideIfMobile mt-8","with-more":""}),e[3]||(e[3]=a("hr",{class:"mb-4"},null,-1)),a("div",le,[(l(!0),i(y,null,$(s.value.songs,o=>M((l(),f(G,{index:s.value.songs.findIndex(u=>u.source==o.source),selected:r.value==o.id,song:o,"playlist-id":"album","with-cover":"","with-more":"",album:s.value.id,onClick:u=>r.value==o.id?r.value=-1:r.value=o.id,onUpdate:e[0]||(e[0]=u=>t.$emit("update"))},null,8,["index","selected","song","album","onClick"])),[[q,!0]])),256))]),(g=v.value)!=null&&g.length?(l(),f(d,{key:0,class:"p-4"},{default:V(()=>[e[2]||(e[2]=a("h2",null,"All songs from this album",-1)),a("div",oe,[(l(!0),i(y,null,$(v.value,(o,u)=>(l(),f(z,{index:u,song:o,"can-import":"","cannot-add":"","with-cover":"","with-more":"",onUpdate:e[1]||(e[1]=re=>t.$emit("update"))},null,8,["index","song"]))),256))])]),_:1})):_("",!0)])])])):(l(),i("div",K,[m(L)]))],64)}}}),me=O(ne,[["__scopeId","data-v-4203b278"]]);export{me as default};
