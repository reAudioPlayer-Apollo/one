import{F as M}from"./FindSources.76c75593.js";import{S as V}from"./SpotifyPlaylistEntry.03d140a3.js";import{S as F}from"./SpotifyPlaylistHeader.d146c4ed.js";import{_ as A,e as u,q as N,o as n,c as r,g as c,w as f,a as s,s as a,v as I,F as y,j as g,t as v,u as p,b as B,f as b,d as O}from"./index.c601bd9b.js";const k={name:"AddArtistToPlaylist",components:{FindSources:M,SpotifyPlaylistHeader:F,SpotifyPlaylistEntry:V},props:{cover:String,description:String,name:String,href:String,id:String},data(){return{showModal:!1,playlists:[],selectedPlaylist:-1,playlist:[],recommendations:[],editSong:!1}},methods:{share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:this.$refs.source.value})}).then(e=>e.json()).then(e=>{console.log(e),this.dTitle=e.title,this.$refs.album.value=e.album,this.dArtist=e.artists.join(", "),this.dCover=e.cover,this.$refs.source.value=e.src})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},addAll(){for(let e=0;e<this.playlist.length;e++)this.add(e)},add(e){this.addTrack(this.playlist[e])},addRec(e){this.addTrack(this.recommendations[e])},addTrack(e){const o=this.playlists.findIndex(l=>l==this.selectedPlaylist);if(console.log(e,o),o<0){alert("no playlist selected");return}fetch(`/api/playlists/${o}/tracks`,{method:"POST",body:JSON.stringify({source:e.src,title:e.title,artist:e.artists.join(", "),album:e.album,cover:e.cover})}).then(l=>{l.status==200&&(e.added=!0)})}},watch:{dSource(){this.loadMetadata()},showModal(){!this.showModal||(fetch("/api/playlists").then(e=>e.json()).then(e=>{this.playlists.length=0,this.playlists.push(...e)}),fetch(`/api/spotify/artists/${this.id}`).then(e=>e.json()).then(e=>{this.playlist.length=0,this.playlist.push(...e)}),fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({artists:[this.id]})}).then(e=>e.json()).then(e=>{this.recommendations.length=0,this.recommendations.push(...e)}))}}},U={class:"wrapper"},L={class:"header"},E=s("h3",null,"Import artist",-1),H=s("span",{class:"material-icons-round"}," close ",-1),j=[H],D=s("h4",null,"To Playlist",-1),J=s("br",null,null,-1),R={key:0},q=s("h4",null,"Source",-1),z={class:"content"},G=s("h4",null,"Title",-1),K={class:"content"},Q=s("h4",null,"Album",-1),W={class:"content"},X=s("h4",null,"Artist",-1),Y={class:"content"},Z=s("h4",null,"Cover",-1),x={class:"content"},$=["src"],ee={class:"confirm"},te={key:1},se=["src"],oe={class:"details"},le={class:"detailswrapper"},ie=["innerHTML"],ne=s("hr",null,null,-1),de=s("hr",null,null,-1),re=s("hr",null,null,-1),ae=s("hr",null,null,-1),ue={class:"confirm"};function ce(e,o,l,T,d,i){const _=u("FindSources"),h=u("h7"),w=u("spotify-playlist-header"),S=u("spotify-playlist-entry"),C=u("vue-final-modal"),P=N("observe-visibility");return n(),r("div",null,[c(C,{onClick:e.hideFindSourcesCtx,modelValue:d.showModal,"onUpdate:modelValue":o[13]||(o[13]=t=>d.showModal=t),classes:"modal-container","content-class":"addAlbumToPlaylistPopup"},{default:f(()=>[s("div",U,[s("div",L,[E,s("button",{class:"modal-close",onClick:o[0]||(o[0]=(...t)=>i.close&&i.close(...t))},j)]),D,a(s("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>d.selectedPlaylist=t)},[(n(!0),r(y,null,g(d.playlists,t=>(n(),r("option",{key:t},v(t),1))),128))],512),[[I,d.selectedPlaylist]]),J,d.editSong?(n(),r("div",R,[q,c(_,{ref:"findSources",src:e.dSource,title:e.title,artist:e.artist},{default:f(()=>[s("div",z,[a(s("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=t=>e.dSource=t),ref:"source"},null,512),[[p,e.dSource]]),s("span",{class:"material-icons-round more",ref:"sourceMore",onClick:o[3]||(o[3]=(...t)=>e.opencontextmenu&&e.opencontextmenu(...t))},"more_vert",512)])]),_:1},8,["src","title","artist"]),G,s("div",K,[a(s("input",{"onUpdate:modelValue":o[4]||(o[4]=t=>e.dTitle=t),type:"text"},null,512),[[p,e.dTitle]])]),Q,s("div",W,[a(s("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>e.dAlbum=t),type:"text",ref:"album"},null,512),[[p,e.dAlbum]])]),X,s("div",Y,[a(s("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>e.dArtist=t),type:"text"},null,512),[[p,e.dArtist]])]),Z,s("div",x,[a(s("input",{type:"text",class:"addSong cover","onUpdate:modelValue":o[7]||(o[7]=t=>e.dCover=t),ref:"cover"},null,512),[[p,e.dCover]]),s("img",{onClick:o[8]||(o[8]=(...t)=>i.openInNewTab&&i.openInNewTab(...t)),class:"addSong cover",src:e.dCover?e.dCover:"/assets/img/music_placeholder.png"},null,8,$)]),s("div",ee,[s("button",{onClick:o[9]||(o[9]=(...t)=>i.add&&i.add(...t)),class:"negative"},"Add")])])):(n(),r("div",te,[a((n(),r("div",{class:"padding-20 playlisteditor",onClick:o[11]||(o[11]=(...t)=>e.editPlaylist&&e.editPlaylist(...t))},[s("img",{class:"cover",src:l.cover},null,8,se),s("div",oe,[s("div",le,[c(h,null,{default:f(()=>[B("Artist")]),_:1}),s("span",{class:"material-icons-round share",onClick:o[10]||(o[10]=(...t)=>i.share&&i.share(...t))},"share")]),s("h1",null,v(l.name),1),s("h5",{innerHTML:l.description},null,8,ie)])])),[[P,e.headerVisibilityChanged]]),ne,c(w),de,(n(!0),r(y,null,g(d.playlist,(t,m)=>(n(),b(S,{onAdd:i.add,key:m,added:t.added,index:m,cover:t.cover,artist:t.artists.join(", "),title:t.title,source:t.src,album:t.album,preview:t.preview},null,8,["onAdd","added","index","cover","artist","title","source","album","preview"]))),128)),s("h5",null,v("Recommendations based on "+l.name),1),re,c(w),ae,(n(!0),r(y,null,g(d.recommendations,(t,m)=>(n(),b(S,{onAdd:i.addRec,key:m,added:t.added,index:m,cover:t.cover,artist:t.artists.join(", "),title:t.title,source:t.src,album:t.album,preview:t.preview},null,8,["onAdd","added","index","cover","artist","title","source","album","preview"]))),128))])),s("div",ue,[s("button",{onClick:o[12]||(o[12]=(...t)=>i.addAll&&i.addAll(...t)),class:"negative"},"Add All")])])]),_:1},8,["onClick","modelValue"])])}const he=A(k,[["render",ce]]);const me={components:{AddArtistToPlaylist:he},name:"ArtistItem",methods:{redirect(){this.$refs.import.showModal=!0},follow(e){e.stopPropagation();const o=this.following?"DELETE":"POST";fetch("/api/spotify/following",{method:o,body:JSON.stringify({artistId:this.id})}).then(l=>{l.status==200&&(this.following=!this.following)})}},data(){return{following:!1}},props:{cover:String,name:String,description:String,id:String,showFollowButton:Boolean}},pe={class:"wrapper drop-shadow-md"},ve=["src"],_e=["innerHTML"];function fe(e,o,l,T,d,i){const _=u("add-artist-to-playlist");return n(),r("div",pe,[c(_,{cover:l.cover,name:l.name,description:l.description,id:l.id,href:`https://open.spotify.com/artist/${l.id}`,ref:"import"},null,8,["cover","name","description","id","href"]),s("div",{class:"item",onClick:o[1]||(o[1]=(...h)=>i.redirect&&i.redirect(...h))},[s("img",{src:l.cover},null,8,ve),s("h4",null,v(l.name),1),s("p",{innerHTML:l.description},null,8,_e),l.showFollowButton?(n(),r("button",{key:0,onClick:o[0]||(o[0]=(...h)=>i.follow&&i.follow(...h)),class:"followButton"},v(d.following?"Following":"Follow"),1)):O("",!0)])])}const be=A(me,[["render",fe],["__scopeId","data-v-9ad22d06"]]);export{be as A};
