import{F as v}from"./FindSources.bb6a5b0e.js";import{_ as f,e as a,o as S,c as g,g as h,w as p,a as e,s as d,u as r,l as b,p as w,i as y}from"./index.f2b9c799.js";const C={name:"EditSong",components:{FindSources:v},props:{cover:String,album:String,artist:String,source:String,title:String,id:Number},mounted(){this.$refs.upSong.addEventListener("change",()=>{const s=new FormData;var t=this.$refs.upSong.files[0],c=t.slice(0,t.size,t.type),u=new File([c],this.id+".mp3",{type:t.type});s.append("file",u),fetch("/api/config/tracks",{method:"POST",body:s}).then(o=>o.text()).then(o=>this.dSource=o)})},data(){return{showModal:!1,dCover:this.cover,dAlbum:this.album,dArtist:this.artist,dTitle:this.title,dSource:this.source}},methods:{opencontextmenu(s){this.$refs.findSourcesEdit.show(s)},hideFindSourcesCtx(){this.$refs.findSourcesEdit.hide()},add(){this.showModal=!1,console.log("fetch"),fetch(`/api/tracks/${this.id}`,{method:"PUT",body:JSON.stringify({source:this.dSource,title:this.dTitle,artist:this.dArtist,album:this.dAlbum,cover:this.dCover})}).then(s=>{console.log(s),this.$emit("close")})},loadMetadata(){fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:this.$refs.source.value})}).then(s=>s.json()).then(s=>{console.log(s),this.dTitle=s.title,this.dAlbum=s.album,this.dArtist=s.artists.join(", "),this.dCover=s.cover,this.dSource=s.src})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")}},watch:{id(){this.dCover=this.cover,this.dAlbum=this.album,this.dArtist=this.artist,this.dTitle=this.title,this.dSource=this.source}}},n=s=>(w("data-v-87613002"),s=s(),y(),s),x={class:"wrapper"},A={class:"header"},T=n(()=>e("h3",null,"Edit song",-1)),k=n(()=>e("span",{class:"material-icons-round"}," close ",-1)),E=[k],V=n(()=>e("h4",null,"Source",-1)),F={class:"content"},M=n(()=>e("span",{class:"material-symbols-rounded"},"file_upload",-1)),N=[M],I={type:"file",ref:"upSong",style:{display:"none"},accept:"audio/mp3"},U=n(()=>e("h4",null,"Title",-1)),O={class:"content"},B=n(()=>e("h4",null,"Album",-1)),P={class:"content"},D=n(()=>e("h4",null,"Artist",-1)),J={class:"content"},z=n(()=>e("h4",null,"Cover",-1)),L={class:"content"},q=["src"],G={class:"confirm"};function H(s,t,c,u,o,l){const m=a("FindSources"),_=a("vue-final-modal");return S(),g("div",null,[h(_,{onContextmenu:t[10]||(t[10]=b(()=>{},["stop"])),onClick:l.hideFindSourcesCtx,modelValue:o.showModal,"onUpdate:modelValue":t[11]||(t[11]=i=>o.showModal=i),classes:"modal-container","content-class":"modal-content"},{default:p(()=>[e("div",x,[e("div",A,[T,e("button",{class:"modal-close",onClick:t[0]||(t[0]=i=>o.showModal=!1)},E)]),V,h(m,{ref:"findSourcesEdit",src:o.dSource,title:o.dTitle,artist:o.dArtist},{default:p(()=>[e("div",F,[e("button",{onClick:t[1]||(t[1]=()=>s.$refs.upSong.click())},N),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>o.dSource=i),type:"text",ref:"source"},null,512),[[r,o.dSource]]),e("input",I,null,512),e("span",{class:"material-icons-round more",ref:"sourceMore",onClick:t[3]||(t[3]=(...i)=>l.opencontextmenu&&l.opencontextmenu(...i))},"more_vert",512)])]),_:1},8,["src","title","artist"]),U,e("div",O,[d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>o.dTitle=i),type:"text"},null,512),[[r,o.dTitle]])]),B,e("div",P,[d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>o.dAlbum=i),type:"text",ref:"album"},null,512),[[r,o.dAlbum]])]),D,e("div",J,[d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=i=>o.dArtist=i),type:"text"},null,512),[[r,o.dArtist]])]),z,e("div",L,[d(e("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t[7]||(t[7]=i=>o.dCover=i),ref:"cover"},null,512),[[r,o.dCover]]),e("img",{onClick:t[8]||(t[8]=(...i)=>l.openInNewTab&&l.openInNewTab(...i)),class:"addSong cover",src:c.cover?c.cover:"/assets/img/music_placeholder.png"},null,8,q)]),e("div",G,[e("button",{onClick:t[9]||(t[9]=(...i)=>l.add&&l.add(...i)),class:"negative"},"Save")])])]),_:1},8,["onClick","modelValue"])])}const R=f(C,[["render",H],["__scopeId","data-v-87613002"]]);export{R as E};
