import{n as x,o as r,c as v,a as n,F as A,i as N,t as y,_ as I,j as M,q as m,f as k,w as B,g as f,u as _,bU as O,bK as P,x as T,B as j,A as S,d as w,aA as q,h as D,M as $,aX as F,bS as V,c6 as W,bB as z,c7 as H}from"./index-a21b7814.js";import{a as J}from"./song-09082ef7.js";import{T as K}from"./Template-6d1fbb86.js";import{F as L}from"./Form-90b03f50.js";const U={class:"padding-20 playlisteditor"},X=["src"],G={class:"details"},Q={class:"detailswrapper"},R=["onClick"],Y=x({__name:"TrackInfo",props:{title:{type:String,required:!0},subtitle:{type:String,required:!0},cover:{type:String,required:!0},icons:{type:Array,required:!0}},setup(e){return(p,t)=>(r(),v("div",U,[n("img",{src:e.cover,class:"cover"},null,8,X),n("div",G,[n("div",Q,[(r(!0),v(A,null,N(e.icons,(l,i)=>(r(),v("span",{key:i,class:"material-icons-round",onClick:l.onClick},y(l.name),9,R))),128))]),n("h1",null,y(e.title),1),n("h6",null,y(e.subtitle),1)])]))}});const Z=I(Y,[["__scopeId","data-v-eab2eaeb"]]),ee=x({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(e,{expose:p}){const t=e,l=M(),i=m([{name:"playlist",type:"dropdown",icon:"playlist_add",required:!0,value:null,options:l.playlistsAsDropdown}]),s=m(null),u=m(null),c=m(null),g=async()=>{if(c.value){s.value.show();return}const o=await s.value.fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:t.song.href})});o&&(s.value.load(),c.value=await o.json(),s.value.show())},C=()=>{const o=new CustomEvent("player.play",{detail:{artist:t.song.artist,title:t.song.title,source:t.song.href}});window.dispatchEvent(o)},d=async o=>{if(o==="new"){const a=await T(t.song.title,t.song.artist,t.song.cover);return i.value[0].options=l.playlistsAsDropdown,i.value[0].value=a,a}return Number(o)},h=async(o,a=null)=>{var b;a??(a=u.value.toObject().playlist),a=await d(a),await J(a??u.value.toObject().playlist,c.value),t.song.added=!0,P.addSuccess(c.value.title,`Added to ${(b=l.playlists.find(E=>E.id==a))==null?void 0:b.name}`,3e3)};return p({show:g}),(o,a)=>(r(),k(K,{ref_key:"modal",ref:s,submit:{label:"Add",icon:"add"},name:"Import Song",onClose:a[0]||(a[0]=b=>o.$emit("close")),onSubmit:h},{default:B(()=>[f(Z,{cover:e.song.cover,icons:[{name:"share",onClick:()=>_(O)(e.song.href)},{name:"play_arrow",onClick:C}],title:e.song.title},null,8,["cover","icons","title"]),f(L,{ref_key:"form",ref:u,options:i.value},null,8,["options"])]),_:1},512))}}),te={key:0,class:"cover"},se={class:"artist-title"},ae={class:"title"},ne={class:"artist"},oe={key:1,class:"album"},le=["onClick"],re=x({__name:"ExternalEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null},canImport:{type:Boolean,required:!1,default:!1}},emits:["update","add"],setup(e,{emit:p}){const t=e,l=j(),i=S(()=>t.song.id==l.song.id),s=m(!1);S(()=>t.playlistId==null?l.playlist.id:t.playlistId);const u=()=>{H(t.song.title,t.song.artist,t.song.source||t.song.href)},c=m(null),g=()=>{t.canImport?c.value.show():p("add")};return(C,d)=>(r(),v(A,null,[e.canImport?(r(),k(ee,{key:0,ref_key:"updatePopup",ref:c,song:e.song},null,8,["song"])):w("",!0),n("div",{class:q([{playing:_(i),selected:e.selected,hovering:s.value,withCover:e.withCover,withAlbum:e.withAlbum},"playlist-entry"]),onDblclick:u,onMouseenter:d[0]||(d[0]=h=>s.value=!0),onMouseleave:d[1]||(d[1]=h=>s.value=!1)},[n("div",{class:q([{"material-symbols-rounded":s.value},"index text-right"]),onClick:u},y(s.value?"play_arrow":e.index+1),3),e.withCover?(r(),v("div",te,[f(D,{src:e.song.cover,type:"track"},null,8,["src"])])):w("",!0),n("div",se,[n("span",ae,[(r(),k(F(e.song.href.startsWith("http")?"a":"router-link"),{href:e.song.href,to:e.song.href,class:"linkOnHover"},{default:B(()=>[f($,{text:e.song.title},null,8,["text"])]),_:1},8,["href","to"]))]),n("span",ne,[f(V,{artist:e.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),e.withAlbum&&!_(W)?(r(),v("div",oe,[f($,{text:e.song.album},null,8,["text"])])):w("",!0),n("div",{class:"icon text-left material-symbols-rounded",onClick:z(g,["stop"])},y(e.song.added?"done":"add"),9,le)],34)],64))}});const me=I(re,[["__scopeId","data-v-2482bde4"]]);export{me as E,Z as T,ee as _};
