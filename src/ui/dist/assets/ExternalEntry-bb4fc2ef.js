import{m as k,o as r,c as v,a as o,F as $,i as N,t as f,_ as I,j as B,n as y,f as A,w as E,g as u,u as _,bM as O,bU as P,z as T,y as C,d as w,ay as S,h as j,M as q,bY as D,bZ as F,bz as z,b_ as V,e as H}from"./index-b250113a.js";import{a as J,c as L}from"./song-9e4416db.js";import{F as U,T as W}from"./Form-5d19c4aa.js";const Y={class:"padding-20 playlisteditor"},Z=["src"],G={class:"details"},K={class:"detailswrapper"},Q=["onClick"],R=k({__name:"TrackInfo",props:{title:{type:String,required:!0},subtitle:{type:String,required:!0},cover:{type:String,required:!0},icons:{type:Array,required:!0}},setup(e){return(p,t)=>(r(),v("div",Y,[o("img",{src:e.cover,class:"cover"},null,8,Z),o("div",G,[o("div",K,[(r(!0),v($,null,N(e.icons,(l,i)=>(r(),v("span",{key:i,class:"material-icons-round",onClick:l.onClick},f(l.name),9,Q))),128))]),o("h1",null,f(e.title),1),o("h6",null,f(e.subtitle),1)])]))}});const X=I(R,[["__scopeId","data-v-eab2eaeb"]]),ee=k({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(e,{expose:p}){const t=e,l=B(),i=y([{name:"playlist",type:"dropdown",icon:"playlist_add",required:!0,value:null,options:l.playlistsAsDropdown}]),a=y(null),d=y(null),c=y(null),g=async()=>{if(c.value){a.value.show();return}const s=await a.value.fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:t.song.href})});s&&(a.value.load(),c.value=await s.json(),a.value.show())},x=()=>{const s=new CustomEvent("player.play",{detail:{artist:t.song.artist,title:t.song.title,source:t.song.href}});window.dispatchEvent(s)},m=async s=>{if(s==="new"){const n=await L(t.song.title,t.song.artist,t.song.cover);return i.value[0].options=l.playlistsAsDropdown,i.value[0].value=n,n}return Number(s)},h=async(s,n=null)=>{var b;n??(n=d.value.toObject().playlist),n=await m(n),await J(n??d.value.toObject().playlist,c.value),t.song.added=!0,P.addSuccess(c.value.title,`Added to ${(b=l.playlists.find(M=>M.id==n))==null?void 0:b.name}`,3e3)};return p({show:g}),(s,n)=>(r(),A(W,{ref_key:"modal",ref:a,submit:{label:"Add",icon:"add"},name:"Import Song",onClose:n[0]||(n[0]=b=>s.$emit("close")),onSubmit:h},{default:E(()=>[u(X,{cover:e.song.cover,icons:[{name:"share",onClick:()=>_(O)(e.song.href)},{name:"play_arrow",onClick:x}],title:e.song.title},null,8,["cover","icons","title"]),u(U,{ref_key:"form",ref:d,options:i.value},null,8,["options"])]),_:1},512))}}),te={key:0,class:"cover"},se={class:"artist-title"},ae={class:"title"},ne={class:"artist"},oe={key:1,class:"album"},le=["onClick"],re=k({__name:"ExternalEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null},canImport:{type:Boolean,required:!1,default:!1}},emits:["update","add"],setup(e,{emit:p}){const t=e,l=T(),i=C(()=>t.song.id==l.song.id),a=y(!1);C(()=>t.playlistId==null?l.playlist.id:t.playlistId);const d=()=>{V(t.song.title,t.song.artist,t.song.source||t.song.href)},c=y(null),g=()=>{t.canImport?c.value.show():p("add")};return(x,m)=>{const h=H("router-link");return r(),v($,null,[e.canImport?(r(),A(ee,{key:0,ref_key:"updatePopup",ref:c,song:e.song},null,8,["song"])):w("",!0),o("div",{class:S([{playing:_(i),selected:e.selected,hovering:a.value,withCover:e.withCover,withAlbum:e.withAlbum},"playlist-entry"]),onDblclick:d,onMouseenter:m[0]||(m[0]=s=>a.value=!0),onMouseleave:m[1]||(m[1]=s=>a.value=!1)},[o("div",{class:S([{"material-symbols-rounded":a.value},"index text-right"]),onClick:d},f(a.value?"play_arrow":e.index+1),3),e.withCover?(r(),v("div",te,[u(j,{src:e.song.cover,type:"track"},null,8,["src"])])):w("",!0),o("div",se,[o("span",ae,[u(h,{to:`/track/${e.song.id}`,class:"linkOnHover"},{default:E(()=>[u(q,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),o("span",ne,[u(D,{artist:e.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),e.withAlbum&&!_(F)?(r(),v("div",oe,[u(q,{text:e.song.album},null,8,["text"])])):w("",!0),o("div",{class:"icon text-left material-symbols-rounded",onClick:z(g,["stop"])},f(e.song.added?"done":"add"),9,le)],34)],64)}}});const de=I(re,[["__scopeId","data-v-64c25366"]]);export{de as E,X as T,ee as _};
