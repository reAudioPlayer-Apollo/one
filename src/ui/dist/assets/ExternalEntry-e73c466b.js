import{m as b,o as r,c as y,a as n,F as q,i as E,t as p,_ as $,j as N,n as v,f as I,w as A,g as c,u as _,L as O,H as B,A as x,d as w,D as C,h as M,M as S,I as P,N as T,O as j,e as D,J as F}from"./index-2fc95183.js";import{a as V,c as H}from"./song-910f5498.js";import{F as J,T as L}from"./Form-92818e8b.js";const z={class:"padding-20 playlisteditor"},W=["src"],G={class:"details"},K={class:"detailswrapper"},Q=["onClick"],R=b({__name:"TrackInfo",props:{title:{type:String,required:!0},subtitle:{type:String,required:!0},cover:{type:String,required:!0},icons:{type:Array,required:!0}},setup(e){return(f,t)=>(r(),y("div",z,[n("img",{src:e.cover,class:"cover"},null,8,W),n("div",G,[n("div",K,[(r(!0),y(q,null,E(e.icons,(l,i)=>(r(),y("span",{key:i,class:"material-icons-round",onClick:l.onClick},p(l.name),9,Q))),128))]),n("h1",null,p(e.title),1),n("h6",null,p(e.subtitle),1)])]))}});const U=$(R,[["__scopeId","data-v-eab2eaeb"]]),X=b({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(e,{expose:f}){const t=e,l=N(),i=v([{name:"playlist",type:"dropdown",icon:"playlist_add",required:!0,value:null,options:l.playlistsAsDropdown}]),a=v(null),u=v(null),d=v(null),g=async()=>{if(d.value){a.value.show();return}const s=await a.value.fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:t.song.href})});s&&(a.value.load(),d.value=await s.json(),a.value.show())},k=()=>{const s=new CustomEvent("player.play",{detail:{artist:t.song.artist,title:t.song.title,source:t.song.href}});window.dispatchEvent(s)},m=async s=>{if(s==="new"){const o=await H(t.song.title,t.song.artist,t.song.cover);return i.value[0].options=l.playlistsAsDropdown,i.value[0].value=o,o}return Number(s)},h=async(s,o=null)=>{o??(o=u.value.toObject().playlist),o=await m(o),await V(o??u.value.toObject().playlist,d.value),t.song.added=!0};return f({show:g}),(s,o)=>(r(),I(L,{ref_key:"modal",ref:a,submit:{label:"Add",icon:"add"},name:"Import Song",onClose:o[0]||(o[0]=oe=>s.$emit("close")),onSubmit:h},{default:A(()=>[c(U,{cover:e.song.cover,icons:[{name:"share",onClick:()=>_(O)(e.song.href)},{name:"play_arrow",onClick:k}],title:e.song.title},null,8,["cover","icons","title"]),c(J,{ref_key:"form",ref:u,options:i.value},null,8,["options"])]),_:1},512))}}),Y={key:0,class:"cover"},Z={class:"artist-title"},ee={class:"title"},te={class:"artist"},se={key:1,class:"album"},ae=["onClick"],ne=b({__name:"ExternalEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null},canImport:{type:Boolean,required:!1,default:!1}},emits:["update","add"],setup(e,{emit:f}){const t=e,l=B(),i=x(()=>t.song.id==l.song.id),a=v(!1);x(()=>t.playlistId==null?l.playlist.id:t.playlistId);const u=()=>{j(t.song.title,t.song.artist,t.song.source||t.song.href)},d=v(null),g=()=>{t.canImport?d.value.show():f("add")};return(k,m)=>{const h=D("router-link");return r(),y(q,null,[e.canImport?(r(),I(X,{key:0,ref_key:"updatePopup",ref:d,song:e.song},null,8,["song"])):w("",!0),n("div",{class:C([{playing:_(i),selected:e.selected,hovering:a.value,withCover:e.withCover,withAlbum:e.withAlbum},"playlist-entry"]),onDblclick:u,onMouseenter:m[0]||(m[0]=s=>a.value=!0),onMouseleave:m[1]||(m[1]=s=>a.value=!1)},[n("div",{class:C([{"material-symbols-rounded":a.value},"index text-right"]),onClick:u},p(a.value?"play_arrow":e.index+1),3),e.withCover?(r(),y("div",Y,[c(M,{src:e.song.cover,type:"track"},null,8,["src"])])):w("",!0),n("div",Z,[n("span",ee,[c(h,{to:`/track/${e.song.id}`,class:"linkOnHover"},{default:A(()=>[c(S,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),n("span",te,[c(P,{artist:e.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),e.withAlbum&&!_(F)?(r(),y("div",se,[c(S,{text:e.song.album},null,8,["text"])])):w("",!0),n("div",{class:"icon text-left material-symbols-rounded",onClick:T(g,["stop"])},p(e.song.added?"done":"add"),9,ae)],34)],64)}}});const ce=$(ne,[["__scopeId","data-v-64c25366"]]);export{ce as E,U as T,X as _};
