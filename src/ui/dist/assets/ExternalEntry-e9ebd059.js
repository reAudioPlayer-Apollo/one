import{m as x,o as i,c as m,a as n,F as q,i as O,t as f,_ as I,j as N,n as y,f as E,w as _,g as r,u as k,C as P,N as A,G as S,d as w,J as $,h as B,M as b,y as T,P as M,e as j,O as D}from"./index-bcfdc045.js";import{F,T as V,a as H,c as J}from"./song-e4cd4635.js";const z={class:"padding-20 playlisteditor"},G=["src"],L={class:"details"},W={class:"detailswrapper"},K=["onClick"],Q=x({__name:"TrackInfo",props:{title:{type:String,required:!0},subtitle:{type:String,required:!0},cover:{type:String,required:!0},icons:{type:Array,required:!0}},setup(e){return(p,t)=>(i(),m("div",z,[n("img",{src:e.cover,class:"cover"},null,8,G),n("div",L,[n("div",W,[(i(!0),m(q,null,O(e.icons,(l,c)=>(i(),m("span",{key:c,class:"material-icons-round",onClick:l.onClick},f(l.name),9,K))),128))]),n("h1",null,f(e.title),1),n("h6",null,f(e.subtitle),1)])]))}});const R=I(Q,[["__scopeId","data-v-eab2eaeb"]]),U=x({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(e,{expose:p}){const t=e,l=N(),c=y([{name:"playlist",type:"dropdown",icon:"playlist_add",required:!0,value:null,options:l.playlistsAsDropdown}]),a=y(null),u=y(null),d=y(null),h=async()=>{if(d.value){a.value.show();return}const s=await a.value.fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:t.song.href})});s&&(a.value.load(),d.value=await s.json(),a.value.show())},C=()=>{const s=new CustomEvent("player.play",{detail:{artist:t.song.artist,title:t.song.title,source:t.song.href}});window.dispatchEvent(s)},v=async s=>{if(s==="new"){const o=await J(t.song.title,t.song.artist,t.song.cover);return c.value[0].options=l.playlistsAsDropdown,c.value[0].value=o,o}return Number(s)},g=async(s,o=null)=>{o??(o=u.value.toObject().playlist),o=await v(o),await H(o??u.value.toObject().playlist,d.value),t.song.added=!0};return p({show:h}),(s,o)=>(i(),E(V,{ref_key:"modal",ref:a,submit:{label:"Add",icon:"add"},name:"Import Song",onClose:o[0]||(o[0]=ne=>s.$emit("close")),onSubmit:g},{default:_(()=>[r(R,{cover:e.song.cover,icons:[{name:"share",onClick:()=>k(P)(e.song.href)},{name:"play_arrow",onClick:C}],title:e.song.title},null,8,["cover","icons","title"]),r(F,{ref_key:"form",ref:u,options:c.value},null,8,["options"])]),_:1},512))}}),X={key:0,class:"cover"},Y={class:"artist-title"},Z={class:"title"},ee={class:"artist"},te={key:1,class:"album"},se=["onClick"],ae=x({__name:"ExternalEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null},canImport:{type:Boolean,required:!1,default:!1}},emits:["update","add"],setup(e,{emit:p}){const t=e,l=A(),c=S(()=>t.song.id==l.song.id),a=y(!1);S(()=>t.playlistId==null?l.playlist.id:t.playlistId);const u=()=>{M(t.song.title,t.song.artist,t.song.source||t.song.href)},d=y(null),h=()=>{t.canImport?d.value.show():p("add")};return(C,v)=>{const g=j("router-link");return i(),m(q,null,[e.canImport?(i(),E(U,{key:0,ref_key:"updatePopup",ref:d,song:e.song},null,8,["song"])):w("",!0),n("div",{class:$([{playing:k(c),selected:e.selected,hovering:a.value,withCover:e.withCover,withAlbum:e.withAlbum},"playlist-entry"]),onDblclick:u,onMouseenter:v[0]||(v[0]=s=>a.value=!0),onMouseleave:v[1]||(v[1]=s=>a.value=!1)},[n("div",{class:$([{"material-symbols-rounded":a.value},"index text-right"]),onClick:u},f(a.value?"play_arrow":e.index+1),3),e.withCover?(i(),m("div",X,[r(B,{src:e.song.cover,type:"track"},null,8,["src"])])):w("",!0),n("div",Y,[n("span",Z,[r(g,{to:`/track/${e.song.id}`,class:"linkOnHover"},{default:_(()=>[r(b,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),n("span",ee,[r(g,{to:`/search/artist:${e.song.artist}`,class:"linkOnHover"},{default:_(()=>[r(b,{text:e.song.artist},null,8,["text"])]),_:1},8,["to"])])]),e.withAlbum&&!k(D)?(i(),m("div",te,[r(b,{text:e.song.album},null,8,["text"])])):w("",!0),n("div",{class:"icon text-left material-symbols-rounded",onClick:T(h,["stop"])},f(e.song.added?"done":"add"),9,se)],34)],64)}}});const re=I(ae,[["__scopeId","data-v-a07b7511"]]);export{re as E,R as T,U as _};
