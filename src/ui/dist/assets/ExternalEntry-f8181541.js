import{n as x,o as r,c as m,a as n,F as A,i as T,t as y,_ as E,j as M,q as d,f as k,w as I,g as f,u as _,bY as N,bR as P,c6 as D,x as O,D as j,B as S,d as b,J as q,h as F,M as $,b9 as V,bT as J,cf as W,A as z,ci as H}from"./index-5c7f0e31.js";import{T as L}from"./Template-de6f577d.js";import{F as R}from"./Form-0c0eece5.js";const Y={class:"padding-20 playlisteditor"},G=["src"],K={class:"details"},Q={class:"detailswrapper"},U=["onClick"],X=x({__name:"TrackInfo",props:{title:{type:String,required:!0},subtitle:{type:String,required:!0},cover:{type:String,required:!0},icons:{type:Array,required:!0}},setup(e){return(g,t)=>(r(),m("div",Y,[n("img",{src:e.cover,class:"cover"},null,8,G),n("div",K,[n("div",Q,[(r(!0),m(A,null,T(e.icons,(l,i)=>(r(),m("span",{key:i,class:"material-icons-round",onClick:l.onClick},y(l.name),9,U))),128))]),n("h1",null,y(e.title),1),n("h6",null,y(e.subtitle),1)])]))}});const Z=E(X,[["__scopeId","data-v-eab2eaeb"]]),ee=x({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(e,{expose:g}){const t=e,l=M(),i=d([{name:"playlist",type:"dropdown",icon:"playlist_add",required:!0,value:null,options:l.playlistsAsDropdown}]),a=d(null),v=d(null),c=d(null),p=async()=>{if(c.value){a.value.show();return}const o=await a.value.fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:t.song.href})});o&&(a.value.load(),c.value=await o.json(),a.value.show())},C=()=>{const o=new CustomEvent("player.play",{detail:{artist:t.song.artist,title:t.song.title,source:t.song.href}});window.dispatchEvent(o)},u=async o=>{if(o==="new"){const s=await O(t.song.title,t.song.artist,t.song.cover);return i.value[0].options=l.playlistsAsDropdown,i.value[0].value=s,s}return o},h=async(o,s=null)=>{var w;s??(s=v.value.toObject().playlist),console.log(s),s=await u(s),await P(s,c.value),t.song.added=!0,D.addSuccess(c.value.title,`Added to ${(w=l.playlists.find(B=>B.id==s))==null?void 0:w.name}`,3e3)};return g({show:p}),(o,s)=>(r(),k(L,{ref_key:"modal",ref:a,submit:{label:"Add",icon:"add"},name:"Import Song",onClose:s[0]||(s[0]=w=>o.$emit("close")),onSubmit:h},{default:I(()=>[f(Z,{cover:e.song.cover,icons:[{name:"share",onClick:()=>_(N)(e.song.href)},{name:"play_arrow",onClick:C}],title:e.song.title},null,8,["cover","icons","title"]),f(R,{ref_key:"form",ref:v,options:i.value},null,8,["options"])]),_:1},512))}}),te={key:0,class:"cover"},se={class:"artist-title"},ae={class:"title"},ne={class:"artist"},oe={key:1,class:"album"},le=["onClick"],re=x({__name:"ExternalEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null},canImport:{type:Boolean,required:!1,default:!1}},emits:["update","add"],setup(e,{emit:g}){const t=e,l=j(),i=S(()=>t.song.id==l.song.id),a=d(!1);S(()=>t.playlistId==null?l.playlist.id:t.playlistId);const v=()=>{H(t.song.title,t.song.artist,t.song.source||t.song.href)},c=d(null),p=()=>{t.canImport?c.value.show():g("add")};return(C,u)=>(r(),m(A,null,[e.canImport?(r(),k(ee,{key:0,ref_key:"updatePopup",ref:c,song:e.song},null,8,["song"])):b("",!0),n("div",{class:q([{playing:_(i),selected:e.selected,hovering:a.value,withCover:e.withCover,withAlbum:e.withAlbum},"playlist-entry"]),onDblclick:v,onMouseenter:u[0]||(u[0]=h=>a.value=!0),onMouseleave:u[1]||(u[1]=h=>a.value=!1)},[n("div",{class:q([{"material-symbols-rounded":a.value},"index text-right"]),onClick:v},y(a.value?"play_arrow":e.index+1),3),e.withCover?(r(),m("div",te,[f(F,{src:e.song.cover,type:"track"},null,8,["src"])])):b("",!0),n("div",se,[n("span",ae,[(r(),k(V(e.song.href.startsWith("http")?"a":"router-link"),{href:e.song.href,to:e.song.href,class:"linkOnHover"},{default:I(()=>[f($,{text:e.song.title},null,8,["text"])]),_:1},8,["href","to"]))]),n("span",ne,[f(J,{artist:e.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),e.withAlbum&&!_(W)?(r(),m("div",oe,[f($,{text:e.song.album},null,8,["text"])])):b("",!0),n("div",{class:"icon text-left material-symbols-rounded",onClick:z(p,["stop"])},y(e.song.added?"done":"add"),9,le)],34)],64))}});const de=E(re,[["__scopeId","data-v-2482bde4"]]);export{de as E,Z as T,ee as _};
