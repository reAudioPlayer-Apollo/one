import{G as m,C as f}from"./gistClient-c75c5027.js";import{_ as v,i as P,o as p,c as u,a as o,g as d,F as C,h as F,f as I,e as h,j as S,k as $}from"./index-24e68ff2.js";import{I as k}from"./IconButton-7756cddf.js";import"./song-ff103b64.js";const B={name:"import",async mounted(){this.$refs.upFile.addEventListener("change",()=>{var a,i,e,n;const s=(a=this.$refs.upFile.files)==null?void 0:a[0];if(s){this.uploadedCoverName=(n=(e=(i=this.$refs.upFile)==null?void 0:i.files)==null?void 0:e[0])==null?void 0:n.name;var t=new FileReader;t.onloadend=()=>{this.cloudPlaylists=JSON.parse(t.result)},t.readAsText(s)}}),this.cloudPlaylists=await m.getContent()},methods:{fetchLocalPlaylists(){this.localPlaylists=[];for(let s=0;s<this.dataStore.playlists.length;s++)fetch(`/api/playlists/${s}`).then(t=>t.json()).then(t=>this.localPlaylists.push(t))}},watch:{dataStore:{handler(){this.fetchLocalPlaylists()},deep:!0}},data(){const s=P();return{localPlaylists:[],cloudPlaylists:[],userData:{},dataStore:s}},components:{IconButton:k,CloudPlaylist:f}},y=s=>(S("data-v-0c0aa212"),s=s(),$(),s),E={class:"import"},g={class:"action"},w=y(()=>o("h1",null,"Restore From File",-1)),b={ref:"upFile",accept:"application/json",style:{display:"none"},type:"file"},G={class:"action"},L=y(()=>o("h2",null,"Synchronise From Github Gists",-1)),N={class:"data"};function R(s,t,a,i,e,n){const r=h("IconButton"),_=h("CloudPlaylist");return p(),u("div",E,[o("div",g,[w,o("input",b,null,512),d(r,{icon:"file_upload",label:"Upload",onClick:t[0]||(t[0]=()=>s.$refs.upFile.click())}),d(r,{icon:"done",label:"Apply",onClick:t[1]||(t[1]=c=>s.$refs.playlistsElements.forEach(l=>l.import()))})]),o("div",G,[L,d(r,{icon:"cloud_download",label:"Synchronise",onClick:t[2]||(t[2]=c=>s.$refs.playlistsElements.forEach(l=>l.import()))})]),o("div",N,[(p(!0),u(C,null,F(e.cloudPlaylists,(c,l)=>(p(),I(_,{key:l,ref_for:!0,ref:"playlistsElements",localPlaylists:e.localPlaylists,playlist:c,onRemove:()=>e.cloudPlaylists.splice(l,1)},null,8,["localPlaylists","playlist","onRemove"]))),128))])])}const x=v(B,[["render",R],["__scopeId","data-v-0c0aa212"]]);export{x as default};
