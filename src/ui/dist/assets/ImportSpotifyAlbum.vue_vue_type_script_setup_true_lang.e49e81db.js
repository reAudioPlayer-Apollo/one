import{F as b,T as y,a as w}from"./song.21840599.js";import{T as h,P as g}from"./TrackInfo.2257f372.js";import{v as k,i as C,x as n,o as A,f as S,w as T,g as r,u as I,y as N,a as $}from"./index.789939b0.js";const j=$("br",null,null,-1),F=k({__name:"ImportSpotifyAlbum",props:{album:{type:Object,required:!0}},setup(t,{expose:m}){const l=t,c=C(),d=[{name:"playlist",type:"dropdown",required:!0,value:null,options:c.playlists.map(e=>({label:e.name,value:e.id}))}],s=n(null),u=n(null),a=n([]),f=async()=>{if(s.value.load(),a.value.length==0){const e=await fetch(`/api/spotify/albums/${l.album.id}`);a.value=await e.json()}s.value.show()},p=()=>{const e=new CustomEvent("player.play",{detail:{artist:l.album.artist,title:l.album.title,source:l.album.href}});window.dispatchEvent(e)},i=async e=>{a.value[e].added||(await w(u.value.toObject().playlist,a.value[e]),a.value[e].added=!0)},v=()=>{a.value.forEach((e,o)=>{i(o)})};return m({show:f}),(e,o)=>(A(),S(y,{ref_key:"modal",ref:s,name:"Import Album",submitName:"Add All",onSubmit:v,onClose:o[0]||(o[0]=B=>e.$emit("close"))},{default:T(()=>[r(h,{title:t.album.title,subtitle:t.album.artist,cover:t.album.cover,icons:[{name:"share",onClick:()=>I(N)(t.album.href)},{name:"play_arrow",onClick:p}]},null,8,["title","subtitle","cover","icons"]),r(b,{ref_key:"form",ref:u,options:d},null,512),j,r(g,{songs:a.value,onAdd:i,noCover:""},null,8,["songs"])]),_:1},512))}});export{F as _};
