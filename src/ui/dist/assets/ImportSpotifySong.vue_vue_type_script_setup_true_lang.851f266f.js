import{F as v,T as g,a as y}from"./song.21840599.js";import{T as w}from"./TrackInfo.2257f372.js";import{v as h,i as k,x as s,o as S,f as b,w as C,g as i,u as T,y as I}from"./index.789939b0.js";const q=h({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(t,{expose:c}){const o=t,u=k(),d=[{name:"playlist",type:"dropdown",required:!0,value:null,options:u.playlists.map(e=>({label:e.name,value:e.id}))}],a=s(null),r=s(null),n=s(null),m=async()=>{if(a.value.load(),!n.value){const e=await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:o.song.href})});n.value=await e.json()}a.value.show()},p=()=>{const e=new CustomEvent("player.play",{detail:{artist:o.song.artist,title:o.song.title,source:o.song.href}});window.dispatchEvent(e)},f=async()=>{o.song.added||(await y(r.value.toObject().playlist,n.value),o.song.added=!0)};return c({show:m}),(e,l)=>(S(),b(g,{ref_key:"modal",ref:a,name:"Import Song",submitName:"Add",onSubmit:f,onClose:l[0]||(l[0]=N=>e.$emit("close"))},{default:C(()=>[i(w,{title:t.song.title,cover:t.song.cover,icons:[{name:"share",onClick:()=>T(I)(t.song.href)},{name:"play_arrow",onClick:p}]},null,8,["title","cover","icons"]),i(v,{ref_key:"form",ref:r,options:d},null,512)]),_:1},512))}});export{q as _};
