import{_ as p,o as i,c as _,a as r,L as m,e as d,f as h,t as a,b as y,d as u,aS as g}from"./index-103cc068.js";const w={name:"Error",props:{msg:String},methods:{toggleSidebar(){this.$emit("toggleSidebar")}}},v={class:"error"},b=["innerHTML"];function L(s,t,o,l,e,c){return i(),_("div",v,[r("h1",{innerHTML:o.msg},null,8,b)])}const k=p(w,[["render",L],["__scopeId","data-v-99b2e9f2"]]);const x={name:"NewsArticle",components:{Loader:m,Error:k},data(){return{error:"",article:{},fullWidth:!1}},methods:{updateData(){fetch(`/api/news/articles/${this.$route.params.url}`).then(async s=>{if(s.status==404){this.error="This wouldn't have happened if you had clicked on the links we provided!<br>ヽ(ಠ_ಠ)ノ",setTimeout(this.updateData,1e3);return}if(s.status==400){window.open(await s.text()),this.$router.push("/news");return}if(s.status==200){if(this.article=await s.json(),this.article.headline==="N/A"){window.open(this.article.href),this.$router.push("/news");return}let t=this.article.body.split(" ").filter(e=>e.includes('href="/'));t=t.map(e=>e.split('href="')[1].split('"')[0]);const o=this.article.href.split("/")[2],l=t.map(e=>"https://"+o+e);for(const e in t){let c=l[e];fetch("/api/news/articles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:l[e]})}).then(async n=>{n.status==200?c=await n.text():console.error(await n.text()),this.article.body=this.article.body.replaceAll(t[e],c)})}return}this.error=s.statusText})}},mounted(){this.updateData()}},T={key:2,class:"padding-20 newsArticle"},N=["innerHTML"],H={class:"leading-tight headline"},M=["innerHTML"],A={key:0,class:"date"},E=["href"],S={key:1,class:"my-4"},W=["innerHTML"];function C(s,t,o,l,e,c){const n=d("Error"),f=d("Loader");return e.error?(i(),h(n,{key:0,msg:e.error},null,8,["msg"])):e.article.headline?(i(),_("div",T,[r("span",{class:"toggleWidth material-icons-round",onClick:t[0]||(t[0]=B=>e.fullWidth=!e.fullWidth)},a(e.fullWidth?"close_fullscreen":"open_in_full"),1),r("div",{class:g([{slim:!e.fullWidth},"wrapper"])},[r("h6",{class:"accentLink topic",innerHTML:e.article.topic},null,8,N),r("h1",H,a(e.article.headline),1),r("h4",{class:"standfirst",innerHTML:e.article.standfirst},null,8,M),e.article.date?(i(),_("h6",A,[y(a(e.article.date)+", ",1),r("a",{href:e.article.href},a(e.article.href),9,E)])):u("",!0),e.article.body?(i(),_("hr",S)):u("",!0),r("div",{class:"body leading-relaxed text-md",innerHTML:e.article.body},null,8,W)],2)])):(i(),h(f,{key:1}))}const V=p(x,[["render",C],["__scopeId","data-v-32bc12c0"]]);export{V as default};
