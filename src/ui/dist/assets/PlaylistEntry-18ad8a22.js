import{n as L,j as Y,A as _,q as A,bD as Q,o as l,c as y,r as W,g as o,w as a,b as f,F as j,i as O,f as P,t as p,u as c,d as w,c1 as X,bM as G,bQ as J,x as K,c8 as Z,e as b,b0 as ee,B as te,a as m,aH as N,h as oe,M as T,z as se,bV as ne,cf as ae,c0 as ie,cg as le,_ as ue}from"./index-1856ec92.js";import{_ as re}from"./EditSong.vue_vue_type_script_setup_true_lang-8a2aaef1.js";import{p as de}from"./playerInPicture-af203fdf.js";const ce=L({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:String,required:!1,default:""}},emits:["update","edit"],setup(e,{expose:B,emit:n}){const t=e,I=Y(),u=_(()=>I.playlists),C=_(()=>t.playlistId==-1),k=()=>{de(t.song.artist,t.song.title,t.song.source)},h=async s=>{var r;s!=-1&&(await G(s,t.song),J.addSuccess(t.song.title,`Added to ${(r=u.value.find(i=>i.id==s))==null?void 0:r.name}`,3e3),n("update"))},$=async()=>{const s=await K(t.song.title,t.song.artist,t.song.cover);await h(s),n("update")},D=async()=>{await Z(t.playlistId,t.song.id),n("update")},S=A(null),g=A(null),v=()=>{g.value.visible?q():x()},q=()=>{g.value.hide()},x=()=>{const s=S.value.getBoundingClientRect(),r={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};g.value.show(r)};B({show:x,toggle:v,hide:q});const E=_(()=>({Soundcloud:`https://soundcloud.com/search?q=${t.song.artist} ${t.song.title}`,Audius:`https://audius.co/search/${t.song.artist} ${t.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${t.song.artist} ${t.song.title}`,Spotify:`https://open.spotify.com/search/${t.song.artist} ${t.song.title}`})),F=()=>{n("edit")},R=s=>{window.open(E.value[s]),F()};return(s,r)=>{const i=b("v-contextmenu-item"),V=b("v-contextmenu-submenu"),M=b("v-contextmenu-divider"),U=b("v-contextmenu"),z=ee("contextmenu");return Q((l(),y("div",{ref_key:"box",ref:S},[W(s.$slots,"default"),o(U,{ref_key:"contextmenu",ref:g},{default:a(()=>[o(i,{onClick:k},{default:a(()=>[f(" Preview ")]),_:1}),o(V,{title:"Find source"},{default:a(()=>[(l(!0),y(j,null,O(Object.keys(c(E)),d=>(l(),P(i,{key:d,onClick:H=>R(d)},{default:a(()=>[f(p(d),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(M),o(i,{onClick:r[0]||(r[0]=d=>s.$emit("like"))},{default:a(()=>[f(p((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),c(C)?w("",!0):(l(),P(i,{key:0,onClick:D},{default:a(()=>[f(" Remove from this playlist ")]),_:1})),o(V,{title:"Add to playlist"},{default:a(()=>[o(i,{onClick:$},{default:a(()=>[f("Add to new playlist")]),_:1}),o(M),(l(!0),y(j,null,O(c(u),d=>(l(),P(i,{key:d.id,onClick:H=>h(d.id)},{default:a(()=>[f(p(d.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(M),o(i,{onClick:F},{default:a(()=>[f(" Update Metadata ")]),_:1}),o(M),o(i,{onClick:r[1]||(r[1]=d=>c(X)(e.song.id))},{default:a(()=>[f("Download")]),_:1})]),_:1},512)])),[[z,void 0,"contextmenu"]])}}}),ve={key:0,class:"cover"},fe={class:"artist-title"},ge={class:"title"},me={class:"artist"},ye={key:1,class:"album"},pe={class:"duration text-center"},ke=L({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:String,required:!1,default:null}},emits:["update"],setup(e,{emit:B}){const n=e,t=te(),I=_(()=>n.song.id==t.song.id),u=A(!1),C=()=>{n.song.favourite=!n.song.favourite,le(n.song.id,n.song.favourite)},k=_(()=>n.playlistId==null?t.playlist.id:n.playlistId),h=()=>{if(k.value=="track"){t.loadPlaylist("track",n.song.id);return}t.loadSong(k.value,n.index)},$=A(null),D=()=>{$.value.show()},S=()=>{B("update")};return(g,v)=>{const q=b("router-link");return l(),P(ce,{ref:"ctxMenu",liked:e.song.favourite,playlistId:c(k),song:e.song,onEdit:D,onLike:C,onUpdate:S},{default:a(()=>[o(re,{ref_key:"updatePopup",ref:$,song:e.song,onUpdate:v[0]||(v[0]=x=>g.$emit("update"))},null,8,["song"]),m("div",{class:N([{playing:c(I),selected:e.selected,hovering:u.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore},"playlist-entry"]),onDblclick:h,onMouseenter:v[2]||(v[2]=x=>u.value=!0),onMouseleave:v[3]||(v[3]=x=>u.value=!1)},[m("div",{class:N([{"material-symbols-rounded":u.value},"index text-right"]),onClick:h},p(u.value?"play_arrow":e.index+1),3),e.withCover?(l(),y("div",ve,[o(oe,{src:e.song.cover,type:"track"},null,8,["src"])])):w("",!0),m("div",fe,[m("span",ge,[o(q,{to:`/track/${c(se)(e.song.id)}`,class:"linkOnHover"},{default:a(()=>[o(T,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),m("span",me,[o(ne,{artist:e.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),e.withAlbum&&!c(ae)?(l(),y("div",ye,[o(T,{text:e.song.album},null,8,["text"])])):w("",!0),e.selected||u.value||e.song.favourite?(l(),y("div",{key:2,class:N([{favourite:e.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:C},p(e.song.favourite?"favorite":"heart_plus"),3)):w("",!0),m("div",pe,p(c(ie)(e.song.duration)),1),w("",!0)],34)]),_:1},8,["liked","playlistId","song"])}}});const be=ue(ke,[["__scopeId","data-v-718c5b3c"]]);export{be as P};
