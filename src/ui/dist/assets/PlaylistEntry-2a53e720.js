import{m as L,j as z,A as C,n as P,E as G,o as l,c as y,r as W,g as o,w as s,b as d,F as V,i as H,f as M,t as p,u as c,d as x,e as b,G as X,H as J,a as g,D as E,h as K,M as F,x as Q,I as Z,_ as ee}from"./index-766c4f9b.js";import{_ as te}from"./EditSong.vue_vue_type_script_setup_true_lang-49e8cc70.js";import{p as oe}from"./playerInPicture-af203fdf.js";import{d as ne,a as se,c as ae,r as le,f as ie}from"./song-bd75baee.js";const ue=L({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:Number,required:!1,default:-1}},emits:["update","edit"],setup(e,{expose:A,emit:a}){const t=e,B=z(),i=C(()=>B.playlists),$=C(()=>t.playlistId==-1),_=()=>{oe(t.song.artist,t.song.title,t.song.source)},h=async n=>{n!=-1&&await se(n,t.song)},S=async()=>{const n=await ae(t.song.title,t.song.artist,t.song.cover);h(n)},N=async()=>{await le(t.playlistId,t.song.id),a("update")},q=P(null),f=P(null),u=()=>{f.value.visible?k():w()},k=()=>{f.value.hide()},w=()=>{const n=q.value.getBoundingClientRect(),m={top:n.height+n.top+window.scrollY,left:n.width+n.left+window.scrollX};f.value.show(m)};A({show:w,toggle:u,hide:k});const O=C(()=>({Soundcloud:`https://soundcloud.com/search?q=${t.song.artist} ${t.song.title}`,Audius:`https://audius.co/search/${t.song.artist} ${t.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${t.song.artist} ${t.song.title}`,Spotify:`https://open.spotify.com/search/${t.song.artist} ${t.song.title}`})),j=()=>{a("edit")},R=n=>{window.open(O.value[n]),j()};return(n,m)=>{const r=b("v-contextmenu-item"),T=b("v-contextmenu-submenu"),I=b("v-contextmenu-divider"),U=b("v-contextmenu"),Y=X("contextmenu");return G((l(),y("div",{ref_key:"box",ref:q},[W(n.$slots,"default"),o(U,{ref_key:"contextmenu",ref:f},{default:s(()=>[o(r,{onClick:_},{default:s(()=>[d(" Preview ")]),_:1}),o(T,{title:"Find source"},{default:s(()=>[(l(!0),y(V,null,H(Object.keys(c(O)),v=>(l(),M(r,{key:v,onClick:D=>R(v)},{default:s(()=>[d(p(v),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(I),o(r,{onClick:m[0]||(m[0]=v=>n.$emit("like"))},{default:s(()=>[d(p((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),c($)?x("",!0):(l(),M(r,{key:0,onClick:N},{default:s(()=>[d(" Remove from this playlist ")]),_:1})),o(T,{title:"Add to playlist"},{default:s(()=>[o(r,{onClick:S},{default:s(()=>[d("Add to new playlist")]),_:1}),o(I),(l(!0),y(V,null,H(c(i),(v,D)=>(l(),M(r,{key:D,onClick:ye=>h(D)},{default:s(()=>[d(p(v.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(I),o(r,{onClick:j},{default:s(()=>[d(" Update Metadata ")]),_:1}),o(I),o(r,{onClick:m[1]||(m[1]=v=>c(ne)(e.song.id))},{default:s(()=>[d("Download")]),_:1})]),_:1},512)])),[[Y,void 0,"contextmenu"]])}}}),re={key:0,class:"cover"},de={class:"artist-title"},ce={class:"title"},ve={class:"artist"},fe={key:1,class:"album"},me={class:"duration text-center"},ge=L({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null}},emits:["update"],setup(e,{emit:A}){const a=e,t=J(),B=C(()=>a.song.id==t.song.id),i=P(!1),$=()=>{a.song.favourite=!a.song.favourite,ie(a.song.id,a.song.favourite)},_=C(()=>a.playlistId==null?t.playlist.id:a.playlistId),h=()=>{t.loadSong(_.value,a.index)},S=P(null),N=()=>{S.value.show()},q=()=>{A("update")};return(f,u)=>{const k=b("router-link");return l(),M(ue,{ref:"ctxMenu",liked:e.song.favourite,playlistId:c(_),song:e.song,onEdit:N,onLike:$,onUpdate:q},{default:s(()=>[o(te,{ref_key:"updatePopup",ref:S,song:e.song,onUpdate:u[0]||(u[0]=w=>f.$emit("update"))},null,8,["song"]),g("div",{class:E([{playing:c(B),selected:e.selected,hovering:i.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore},"playlist-entry"]),onDblclick:h,onMouseenter:u[2]||(u[2]=w=>i.value=!0),onMouseleave:u[3]||(u[3]=w=>i.value=!1)},[g("div",{class:E([{"material-symbols-rounded":i.value},"index text-right"]),onClick:h},p(i.value?"play_arrow":e.index+1),3),e.withCover?(l(),y("div",re,[o(K,{src:e.song.cover,type:"track"},null,8,["src"])])):x("",!0),g("div",de,[g("span",ce,[o(k,{to:`/track/${c(Q)(e.song.id)}`,class:"linkOnHover"},{default:s(()=>[o(F,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),g("span",ve,[o(k,{to:`/search/artist:${e.song.artist}`,class:"linkOnHover"},{default:s(()=>[o(F,{text:e.song.artist},null,8,["text"])]),_:1},8,["to"])])]),e.withAlbum&&!c(Z)?(l(),y("div",fe,[o(F,{text:e.song.album},null,8,["text"])])):x("",!0),e.selected||i.value||e.song.favourite?(l(),y("div",{key:2,class:E([{favourite:e.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:$},p(e.song.favourite?"favorite":"heart_plus"),3)):x("",!0),g("div",me,p(e.song.duration=="-1:59"?"N/A":e.song.duration),1),x("",!0)],34)]),_:1},8,["liked","playlistId","song"])}}});const xe=ee(ge,[["__scopeId","data-v-044b44aa"]]);export{xe as P};
