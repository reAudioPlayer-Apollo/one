import{m as R,j as z,A as _,n as I,E as G,o as l,c as y,r as J,g as o,w as n,b as c,F as T,i as V,f as P,t as p,u as i,d as w,e as b,G as K,H as W,a as g,D as E,h as X,M as L,I as Q,x as Z,J as ee,K as te,_ as oe}from"./index-bd58183e.js";import{_ as se}from"./EditSong.vue_vue_type_script_setup_true_lang-8eff8a14.js";import{p as ne}from"./playerInPicture-af203fdf.js";import{d as ae,a as le,c as ie,r as re,f as ue}from"./song-84027a95.js";const de=R({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:Number,required:!1,default:-1}},emits:["update","edit"],setup(e,{expose:A,emit:a}){const t=e,B=z(),r=_(()=>B.playlists),C=_(()=>t.playlistId==-1),k=()=>{ne(t.song.artist,t.song.title,t.song.source)},h=async s=>{s!=-1&&await le(s,t.song)},$=async()=>{const s=await ie(t.song.title,t.song.artist,t.song.cover);h(s)},D=async()=>{await re(t.playlistId,t.song.id),a("update")},S=I(null),f=I(null),u=()=>{f.value.visible?q():x()},q=()=>{f.value.hide()},x=()=>{const s=S.value.getBoundingClientRect(),m={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};f.value.show(m)};A({show:x,toggle:u,hide:q});const F=_(()=>({Soundcloud:`https://soundcloud.com/search?q=${t.song.artist} ${t.song.title}`,Audius:`https://audius.co/search/${t.song.artist} ${t.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${t.song.artist} ${t.song.title}`,Spotify:`https://open.spotify.com/search/${t.song.artist} ${t.song.title}`})),j=()=>{a("edit")},U=s=>{window.open(F.value[s]),j()};return(s,m)=>{const d=b("v-contextmenu-item"),O=b("v-contextmenu-submenu"),M=b("v-contextmenu-divider"),H=b("v-contextmenu"),Y=K("contextmenu");return G((l(),y("div",{ref_key:"box",ref:S},[J(s.$slots,"default"),o(H,{ref_key:"contextmenu",ref:f},{default:n(()=>[o(d,{onClick:k},{default:n(()=>[c(" Preview ")]),_:1}),o(O,{title:"Find source"},{default:n(()=>[(l(!0),y(T,null,V(Object.keys(i(F)),v=>(l(),P(d,{key:v,onClick:N=>U(v)},{default:n(()=>[c(p(v),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(M),o(d,{onClick:m[0]||(m[0]=v=>s.$emit("like"))},{default:n(()=>[c(p((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),i(C)?w("",!0):(l(),P(d,{key:0,onClick:D},{default:n(()=>[c(" Remove from this playlist ")]),_:1})),o(O,{title:"Add to playlist"},{default:n(()=>[o(d,{onClick:$},{default:n(()=>[c("Add to new playlist")]),_:1}),o(M),(l(!0),y(T,null,V(i(r),(v,N)=>(l(),P(d,{key:N,onClick:ke=>h(N)},{default:n(()=>[c(p(v.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(M),o(d,{onClick:j},{default:n(()=>[c(" Update Metadata ")]),_:1}),o(M),o(d,{onClick:m[1]||(m[1]=v=>i(ae)(e.song.id))},{default:n(()=>[c("Download")]),_:1})]),_:1},512)])),[[Y,void 0,"contextmenu"]])}}}),ce={key:0,class:"cover"},ve={class:"artist-title"},fe={class:"title"},me={class:"artist"},ge={key:1,class:"album"},ye={class:"duration text-center"},pe=R({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:String,required:!1,default:null}},emits:["update"],setup(e,{emit:A}){const a=e,t=W(),B=_(()=>a.song.id==t.song.id),r=I(!1),C=()=>{a.song.favourite=!a.song.favourite,ue(a.song.id,a.song.favourite)},k=_(()=>a.playlistId==null?t.playlist.id:a.playlistId),h=()=>{if(k.value=="track"){t.loadPlaylist("track",a.song.id);return}t.loadSong(Number(k.value),a.index)},$=I(null),D=()=>{$.value.show()},S=()=>{A("update")};return(f,u)=>{const q=b("router-link");return l(),P(de,{ref:"ctxMenu",liked:e.song.favourite,playlistId:i(k),song:e.song,onEdit:D,onLike:C,onUpdate:S},{default:n(()=>[o(se,{ref_key:"updatePopup",ref:$,song:e.song,onUpdate:u[0]||(u[0]=x=>f.$emit("update"))},null,8,["song"]),g("div",{class:E([{playing:i(B),selected:e.selected,hovering:r.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore},"playlist-entry"]),onDblclick:h,onMouseenter:u[2]||(u[2]=x=>r.value=!0),onMouseleave:u[3]||(u[3]=x=>r.value=!1)},[g("div",{class:E([{"material-symbols-rounded":r.value},"index text-right"]),onClick:h},p(r.value?"play_arrow":e.index+1),3),e.withCover?(l(),y("div",ce,[o(X,{src:e.song.cover,type:"track"},null,8,["src"])])):w("",!0),g("div",ve,[g("span",fe,[o(q,{to:`/track/${i(Z)(e.song.id)}`,class:"linkOnHover"},{default:n(()=>[o(L,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),g("span",me,[o(Q,{artist:e.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),e.withAlbum&&!i(ee)?(l(),y("div",ge,[o(L,{text:e.song.album},null,8,["text"])])):w("",!0),e.selected||r.value||e.song.favourite?(l(),y("div",{key:2,class:E([{favourite:e.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:C},p(e.song.favourite?"favorite":"heart_plus"),3)):w("",!0),g("div",ye,p(i(te)(e.song.duration)),1),w("",!0)],34)]),_:1},8,["liked","playlistId","song"])}}});const _e=oe(pe,[["__scopeId","data-v-ce80610e"]]);export{_e as P};
