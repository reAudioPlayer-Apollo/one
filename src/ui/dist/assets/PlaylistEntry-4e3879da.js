import{e as R,j as K,B as w,n as N,f as x,bp as W,c2 as X,o as u,c as g,r as G,g as t,w as o,b as r,F as L,h as T,i as D,t as $,u as y,cL as Z,cM as ee,d as I,cj as te,cN as se,a as i,cc as oe,cr as ne,x as ae,cB as le,cO as ie,ce as de,cE as ue,K as re,cP as ce,Q as j,J as me,M as V,z as ve,O as fe,cQ as ge,ci as ye,cR as pe,_ as _e}from"./index-ca817924.js";import{_ as he}from"./EditSong.vue_vue_type_script_setup_true_lang-ec9862b2.js";import{p as xe}from"./playerInPicture-af203fdf.js";const we=i("span",{class:"material-symbols-rounded"},"preview",-1),be=i("span",{class:"material-symbols-rounded"},"search",-1),ke=i("span",{class:"material-symbols-rounded"},"queue_music",-1),$e=i("span",{class:"material-symbols-rounded"}," add_to_queue ",-1),Se=i("span",{class:"material-symbols-rounded"}," queue_play_next ",-1),Ce=i("span",{class:"material-symbols-rounded"},"delete",-1),qe=i("span",{class:"material-symbols-rounded"},"playlist_add",-1),Pe=i("span",{class:"material-symbols-rounded"},"edit",-1),Me=i("span",{class:"material-symbols-rounded"},"file_download",-1),Ae=i("span",{class:"material-symbols-rounded"},"replay",-1),Be=i("span",{class:"material-symbols-rounded"},"share",-1),De=R({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:String,required:!1,default:""}},emits:["update","edit"],setup(s,{expose:E,emit:F}){const l=K(),S=w(()=>l.playlists.filter(n=>n.type==="classic")),e=s,p=F,v=w(()=>e.playlistId==-1),C=()=>{xe(e.song.artist,e.song.title,e.song.source)},f=async n=>{var d;n!=-1&&(await oe(n,e.song),ne.addSuccess(e.song.title,`Added to ${(d=S.value.find(a=>a.id==n))==null?void 0:d.name}`,3e3),p("update"))},q=async()=>{const n=await ae(e.song.title,e.song.artist,e.song.cover);await f(n),p("update")},P=async()=>{await le(e.playlistId,e.song.id),p("update")},M=N(null),_=N(null),O=()=>{_.value.visible?A():m()},A=()=>{_.value.hide()},m=()=>{const n=M.value.getBoundingClientRect(),d={top:n.height+n.top+window.scrollY,left:n.width+n.left+window.scrollX};_.value.show(d)};E({show:m,toggle:O,hide:A});const b=w(()=>({Soundcloud:`https://soundcloud.com/search?q=${e.song.artist} ${e.song.title}`,Audius:`https://audius.co/search/${e.song.artist} ${e.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${e.song.artist} ${e.song.title}`,Spotify:`https://open.spotify.com/search/${e.song.artist} ${e.song.title}`})),k=()=>{p("edit")},U=n=>{window.open(b.value[n]),k()},z=()=>{const n=ie(e.song);de(n,`${e.song.artist} - ${e.song.title}`)};return(n,d)=>{const a=x("v-contextmenu-item"),B=x("v-contextmenu-submenu"),h=x("v-contextmenu-divider"),H=x("v-context-menu-divider"),Q=x("v-contextmenu"),Y=W("contextmenu");return X((u(),g("div",{ref_key:"box",ref:M},[G(n.$slots,"default"),t(Q,{ref_key:"contextmenu",ref:_},{default:o(()=>[t(a,{onClick:C},{default:o(()=>[we,r(" Preview ")]),_:1}),t(a,null,{default:o(()=>[be,t(B,{title:"Find source"},{default:o(()=>[(u(!0),g(L,null,T(Object.keys(b.value),c=>(u(),D(a,{key:c,onClick:J=>U(c)},{default:o(()=>[r($(c),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(h),t(a,null,{default:o(()=>[ke,t(B,{title:"Add to queue"},{default:o(()=>[t(a,{onClick:d[0]||(d[0]=()=>y(Z)(e.song.id))},{default:o(()=>[$e,r(" Play Next ")]),_:1}),t(a,{onClick:d[1]||(d[1]=()=>y(ee)(e.song.id))},{default:o(()=>[Se,r(" Play Last ")]),_:1})]),_:1})]),_:1}),t(h),t(H),v.value?I("",!0):(u(),D(a,{key:0,onClick:P},{default:o(()=>[Ce,r(" Remove from this playlist ")]),_:1})),t(a,null,{default:o(()=>[qe,t(B,{title:"Add to playlist"},{default:o(()=>[t(a,{onClick:q},{default:o(()=>[r(" Add to new playlist ")]),_:1}),t(h),(u(!0),g(L,null,T(S.value,c=>(u(),D(a,{key:c.id,onClick:J=>f(c.id)},{default:o(()=>[r($(c.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(h),t(a,{onClick:k},{default:o(()=>[Pe,r(" Edit ")]),_:1}),t(h),t(a,{onClick:d[2]||(d[2]=c=>y(te)(s.song.id))},{default:o(()=>[Me,r(" Download ")]),_:1}),t(a,{onClick:d[3]||(d[3]=c=>y(se)(s.song.id))},{default:o(()=>[Ae,r(" Uncache ")]),_:1}),t(h),t(a,null,{default:o(()=>[Be,t(B,{title:"Export..."},{default:o(()=>[t(a,{onClick:d[4]||(d[4]=c=>z())},{default:o(()=>[r(" to file ")]),_:1})]),_:1})]),_:1})]),_:1},512)])),[[Y,void 0,"contextmenu"]])}}}),Ie={key:0,class:"index text-right downloading"},Ne={key:2,class:"cover"},Ee={class:"artist-title"},Fe={class:"title"},Oe={class:"artist"},je={key:3,class:"album"},Le={class:"duration text-center"},Te=R({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:String,required:!1,default:null},artist:{type:String,required:!1,default:null},album:{type:String,required:!1,default:null}},emits:["update"],setup(s,{emit:E}){const F=ue(),l=s,S=E,e=re(),p=w(()=>l.song.id==e.song.id),v=N(!1),C=()=>{l.song.favourite=!l.song.favourite,pe(l.song.id,l.song.favourite)},f=w(()=>l.playlistId==null?e.playlist.id:l.playlistId),q=async()=>{if(f.value=="track"){e.loadPlaylist("track",l.song.id);return}if(f.value=="artist"){await e.loadPlaylist("artist",l.artist),e.loadSong(null,l.index);return}if(f.value=="album"){await e.loadPlaylist("album",l.album),e.loadSong(null,l.index);return}e.loadSong(f.value,l.index)},P=N(null),M=()=>{P.value.show()},_=()=>{S("update")},O=w(()=>F.isSongDownloading(l.song.id));return(A,m)=>{const b=x("router-link");return u(),D(De,{ref:"ctxMenu",liked:s.song.favourite,playlistId:f.value,song:s.song,onEdit:M,onLike:C,onUpdate:_},{default:o(()=>[t(he,{ref_key:"updatePopup",ref:P,song:s.song,onUpdate:m[0]||(m[0]=k=>A.$emit("update"))},null,8,["song"]),i("div",{class:j([{playing:p.value,selected:s.selected,hovering:v.value,withCover:s.withCover,withAlbum:s.withAlbum,withMore:s.withMore},"playlist-entry"]),onDblclick:q,onMouseenter:m[1]||(m[1]=k=>v.value=!0),onMouseleave:m[2]||(m[2]=k=>v.value=!1)},[O.value?(u(),g("div",Ie,[t(ce)])):(u(),g("div",{key:1,class:j([{"material-symbols-rounded":v.value},"index text-right"]),onClick:q},$(v.value?"play_arrow":s.index+1),3)),s.withCover?(u(),g("div",Ne,[t(me,{src:s.song.cover,type:"track"},null,8,["src"])])):I("",!0),i("div",Ee,[i("span",Fe,[t(b,{to:`/track/${y(ve)(s.song.id)}`,class:"linkOnHover"},{default:o(()=>[t(V,{text:s.song.title},null,8,["text"])]),_:1},8,["to"])]),i("span",Oe,[t(fe,{artist:s.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),s.withAlbum&&!y(ge)?(u(),g("div",je,[t(b,{to:s.song.album.href,class:"linkOnHover"},{default:o(()=>[t(V,{text:s.song.album.name},null,8,["text"])]),_:1},8,["to"])])):I("",!0),s.selected||v.value||s.song.favourite?(u(),g("div",{key:4,class:j([{favourite:s.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:C},$(s.song.favourite?"favorite":"heart_plus"),3)):I("",!0),i("div",Le,$(y(ye)(s.song.duration)),1)],34)]),_:1},8,["liked","playlistId","song"])}}});const ze=_e(Te,[["__scopeId","data-v-67cfb148"]]);export{ze as P};
