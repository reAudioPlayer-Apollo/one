import{l as L,i as Y,z as C,m as P,E as G,o as l,c as y,r as J,g as o,w as n,b as c,F as j,h as H,f as M,t as p,u as i,d as x,e as b,G as W,H as X,a as g,D as E,C as K,M as F,v as Q,I as Z,J as ee,_ as te}from"./index-24e68ff2.js";import{_ as oe}from"./EditSong.vue_vue_type_script_setup_true_lang-8abc43d2.js";import{p as se}from"./playerInPicture-af203fdf.js";import{d as ne,a as ae,c as le,r as ie,f as ue}from"./song-ff103b64.js";const re=L({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:Number,required:!1,default:-1}},emits:["update","edit"],setup(e,{expose:B,emit:a}){const t=e,D=Y(),u=C(()=>D.playlists),$=C(()=>t.playlistId==-1),_=()=>{se(t.song.artist,t.song.title,t.song.source)},h=async s=>{s!=-1&&await ae(s,t.song)},S=async()=>{const s=await le(t.song.title,t.song.artist,t.song.cover);h(s)},A=async()=>{await ie(t.playlistId,t.song.id),a("update")},q=P(null),f=P(null),r=()=>{f.value.visible?k():w()},k=()=>{f.value.hide()},w=()=>{const s=q.value.getBoundingClientRect(),m={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};f.value.show(m)};B({show:w,toggle:r,hide:k});const O=C(()=>({Soundcloud:`https://soundcloud.com/search?q=${t.song.artist} ${t.song.title}`,Audius:`https://audius.co/search/${t.song.artist} ${t.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${t.song.artist} ${t.song.title}`,Spotify:`https://open.spotify.com/search/${t.song.artist} ${t.song.title}`})),T=()=>{a("edit")},R=s=>{window.open(O.value[s]),T()};return(s,m)=>{const d=b("v-contextmenu-item"),V=b("v-contextmenu-submenu"),I=b("v-contextmenu-divider"),U=b("v-contextmenu"),z=W("contextmenu");return G((l(),y("div",{ref_key:"box",ref:q},[J(s.$slots,"default"),o(U,{ref_key:"contextmenu",ref:f},{default:n(()=>[o(d,{onClick:_},{default:n(()=>[c(" Preview ")]),_:1}),o(V,{title:"Find source"},{default:n(()=>[(l(!0),y(j,null,H(Object.keys(i(O)),v=>(l(),M(d,{key:v,onClick:N=>R(v)},{default:n(()=>[c(p(v),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(I),o(d,{onClick:m[0]||(m[0]=v=>s.$emit("like"))},{default:n(()=>[c(p((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),i($)?x("",!0):(l(),M(d,{key:0,onClick:A},{default:n(()=>[c(" Remove from this playlist ")]),_:1})),o(V,{title:"Add to playlist"},{default:n(()=>[o(d,{onClick:S},{default:n(()=>[c("Add to new playlist")]),_:1}),o(I),(l(!0),y(j,null,H(i(u),(v,N)=>(l(),M(d,{key:N,onClick:pe=>h(N)},{default:n(()=>[c(p(v.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(I),o(d,{onClick:T},{default:n(()=>[c(" Update Metadata ")]),_:1}),o(I),o(d,{onClick:m[1]||(m[1]=v=>i(ne)(e.song.id))},{default:n(()=>[c("Download")]),_:1})]),_:1},512)])),[[z,void 0,"contextmenu"]])}}}),de={key:0,class:"cover"},ce={class:"artist-title"},ve={class:"title"},fe={class:"artist"},me={key:1,class:"album"},ge={class:"duration text-center"},ye=L({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null}},emits:["update"],setup(e,{emit:B}){const a=e,t=X(),D=C(()=>a.song.id==t.song.id),u=P(!1),$=()=>{a.song.favourite=!a.song.favourite,ue(a.song.id,a.song.favourite)},_=C(()=>a.playlistId==null?t.playlist.id:a.playlistId),h=()=>{t.loadSong(_.value,a.index)},S=P(null),A=()=>{S.value.show()},q=()=>{B("update")};return(f,r)=>{const k=b("router-link");return l(),M(re,{ref:"ctxMenu",liked:e.song.favourite,playlistId:i(_),song:e.song,onEdit:A,onLike:$,onUpdate:q},{default:n(()=>[o(oe,{ref_key:"updatePopup",ref:S,song:e.song,onUpdate:r[0]||(r[0]=w=>f.$emit("update"))},null,8,["song"]),g("div",{class:E([{playing:i(D),selected:e.selected,hovering:u.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore},"playlist-entry"]),onDblclick:h,onMouseenter:r[2]||(r[2]=w=>u.value=!0),onMouseleave:r[3]||(r[3]=w=>u.value=!1)},[g("div",{class:E([{"material-symbols-rounded":u.value},"index text-right"]),onClick:h},p(u.value?"play_arrow":e.index+1),3),e.withCover?(l(),y("div",de,[o(K,{src:e.song.cover,type:"track"},null,8,["src"])])):x("",!0),g("div",ce,[g("span",ve,[o(k,{to:`/track/${i(Q)(e.song.id)}`,class:"linkOnHover"},{default:n(()=>[o(F,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),g("span",fe,[o(k,{to:`/search/artist:${e.song.artist}`,class:"linkOnHover"},{default:n(()=>[o(F,{text:e.song.artist},null,8,["text"])]),_:1},8,["to"])])]),e.withAlbum&&!i(Z)?(l(),y("div",me,[o(F,{text:e.song.album},null,8,["text"])])):x("",!0),e.selected||u.value||e.song.favourite?(l(),y("div",{key:2,class:E([{favourite:e.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:$},p(e.song.favourite?"favorite":"heart_plus"),3)):x("",!0),g("div",ge,p(i(ee)(e.song.duration)),1),x("",!0)],34)]),_:1},8,["liked","playlistId","song"])}}});const be=te(ye,[["__scopeId","data-v-bb69c73c"]]);export{be as P};
