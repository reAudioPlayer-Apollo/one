import{e as U,j as W,D as k,n as B,f as x,ad as X,a3 as G,o as r,c as g,r as J,g as t,w as o,b as u,F as j,h as H,i as M,t as C,u as p,cN as Z,cO as ee,cP as te,d as I,ak as se,cQ as oe,a as d,ac as ne,N as ae,x as le,aE as ie,cR as de,af as ue,aH as re,a7 as ce,cS as me,Q as T,H as fe,M as L,A as ve,K as ye,cT as ge,aj as pe,cU as _e,_ as he}from"./index-vqANRdX_.js";import{_ as we}from"./EditSong.vue_vue_type_script_setup_true_lang-DOgyo5DL.js";import{p as xe}from"./playerInPicture-Dfp9IAsf.js";const ke=d("span",{class:"material-symbols-rounded"},"preview",-1),be=d("span",{class:"material-symbols-rounded"},"search",-1),Se=d("span",{class:"material-symbols-rounded"},"queue_music",-1),$e=d("span",{class:"material-symbols-rounded"}," play_arrow ",-1),Ce=d("span",{class:"material-symbols-rounded"}," add_to_queue ",-1),qe=d("span",{class:"material-symbols-rounded"}," queue_play_next ",-1),Pe=d("span",{class:"material-symbols-rounded"},"delete",-1),Ne=d("span",{class:"material-symbols-rounded"},"playlist_add",-1),Ae=d("span",{class:"material-symbols-rounded"},"edit",-1),De=d("span",{class:"material-symbols-rounded"},"file_download",-1),Me=d("span",{class:"material-symbols-rounded"},"replay",-1),Ie=d("span",{class:"material-symbols-rounded"},"share",-1),Be=U({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:String,required:!1,default:""}},emits:["update","edit"],setup(s,{expose:E,emit:F}){const i=W(),b=k(()=>i.playlists.filter(n=>n.type==="classic")),e=s,_=F,f=()=>{xe(e.song.artist,e.song.title,e.song.source)},q=k(()=>{var n;return((n=i.playlists.find(a=>a.id===e.playlistId))==null?void 0:n.type)!=="classic"}),v=async n=>{var a,l;await ne(n,e.song),ae.addSuccess(e.song.title,`Added to ${(a=b.value.find(y=>y.id==n))==null?void 0:a.name}`,3e3,void 0,(l=b.value.find(y=>y.id==n))==null?void 0:l.href),_("update")},P=async()=>{const n=await le("classic",e.song.title,e.song.artist,e.song.cover);await v(n),_("update")},N=async()=>{await ie(e.playlistId,e.song.id),_("update")},A=B(null),h=B(null),O=()=>{h.value.visible?D():m()},D=()=>{h.value.hide()},m=()=>{const n=A.value.getBoundingClientRect(),a={top:n.height+n.top+window.scrollY,left:n.width+n.left+window.scrollX};h.value.show(a)};E({show:m,toggle:O,hide:D});const S=k(()=>({Soundcloud:`https://soundcloud.com/search?q=${e.song.artist} ${e.song.title}`,Audius:`https://audius.co/search/${e.song.artist} ${e.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${e.song.artist} ${e.song.title}`,Spotify:`https://open.spotify.com/search/${e.song.artist} ${e.song.title}`})),$=()=>{_("edit")},V=n=>{window.open(S.value[n]),$()},R=()=>{const n=de(e.song);ue(n,`${e.song.artist} - ${e.song.title}`)};return(n,a)=>{const l=x("v-contextmenu-item"),y=x("v-contextmenu-submenu"),w=x("v-contextmenu-divider"),Q=x("v-context-menu-divider"),Y=x("v-contextmenu"),z=X("contextmenu");return G((r(),g("div",{ref_key:"box",ref:A},[J(n.$slots,"default"),t(Y,{ref_key:"contextmenu",ref:h},{default:o(()=>[t(l,{onClick:f},{default:o(()=>[ke,u(" Preview ")]),_:1}),t(l,null,{default:o(()=>[be,t(y,{title:"Find source"},{default:o(()=>[(r(!0),g(j,null,H(Object.keys(S.value),c=>(r(),M(l,{key:c,onClick:K=>V(c)},{default:o(()=>[u(C(c),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(w),t(l,null,{default:o(()=>[Se,t(y,{title:"Add to queue"},{default:o(()=>[t(l,{onClick:a[0]||(a[0]=()=>p(Z)(e.song.id))},{default:o(()=>[$e,u(" Play Now ")]),_:1}),t(l,{onClick:a[1]||(a[1]=()=>p(ee)(e.song.id))},{default:o(()=>[Ce,u(" Play Next ")]),_:1}),t(l,{onClick:a[2]||(a[2]=()=>p(te)(e.song.id))},{default:o(()=>[qe,u(" Play Last ")]),_:1})]),_:1})]),_:1}),t(w),t(Q),q.value?I("",!0):(r(),M(l,{key:0,onClick:N},{default:o(()=>[Pe,u(" Remove from this playlist ")]),_:1})),t(l,null,{default:o(()=>[Ne,t(y,{title:"Add to playlist"},{default:o(()=>[t(l,{onClick:P},{default:o(()=>[u(" Add to new playlist ")]),_:1}),t(w),(r(!0),g(j,null,H(b.value,c=>(r(),M(l,{key:c.id,onClick:K=>v(c.id)},{default:o(()=>[u(C(c.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(w),t(l,{onClick:$},{default:o(()=>[Ae,u(" Edit ")]),_:1}),t(w),t(l,{onClick:a[3]||(a[3]=c=>p(se)(s.song.id))},{default:o(()=>[De,u(" Download ")]),_:1}),t(l,{onClick:a[4]||(a[4]=c=>p(oe)(s.song.id))},{default:o(()=>[Me,u(" Uncache ")]),_:1}),t(w),t(l,null,{default:o(()=>[Ie,t(y,{title:"Export..."},{default:o(()=>[t(l,{onClick:a[5]||(a[5]=c=>R())},{default:o(()=>[u(" to file ")]),_:1})]),_:1})]),_:1})]),_:1},512)])),[[z,void 0,"contextmenu"]])}}}),Ee={key:0,class:"index text-right downloading"},Fe={key:2,class:"cover"},Oe={class:"artist-title"},Te={class:"title"},je={class:"artist"},He={key:3,class:"album"},Le={class:"duration text-center"},Ue=U({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:String,required:!1,default:null},artist:{type:String,required:!1,default:null},album:{type:String,required:!1,default:null}},emits:["update"],setup(s,{emit:E}){const F=re(),i=s,b=E,e=ce(),_=k(()=>i.song.id==e.song.id),f=B(!1),q=()=>{i.song.favourite=!i.song.favourite,_e(i.song.id,i.song.favourite)},v=k(()=>i.playlistId==null?e.playlist.id:i.playlistId),P=async()=>{if(v.value=="track"){e.loadPlaylist("track",i.song.id);return}if(v.value=="artist"){await e.loadPlaylist("artist",i.artist),e.loadSong(null,i.index);return}if(v.value=="album"){await e.loadPlaylist("album",i.album),e.loadSong(null,i.index);return}e.loadSong(v.value,i.index)},N=B(null),A=()=>{N.value.show()},h=()=>{b("update")},O=k(()=>F.isSongDownloading(i.song.id));return(D,m)=>{const S=x("router-link");return r(),M(Be,{ref:"ctxMenu",liked:s.song.favourite,playlistId:v.value,song:s.song,onEdit:A,onLike:q,onUpdate:h},{default:o(()=>[t(we,{ref_key:"updatePopup",ref:N,song:s.song,onUpdate:m[0]||(m[0]=$=>D.$emit("update"))},null,8,["song"]),d("div",{class:T([{playing:_.value,selected:s.selected,hovering:f.value,withCover:s.withCover,withAlbum:s.withAlbum,withMore:s.withMore},"playlist-entry"]),onDblclick:P,onMouseenter:m[1]||(m[1]=$=>f.value=!0),onMouseleave:m[2]||(m[2]=$=>f.value=!1)},[O.value?(r(),g("div",Ee,[t(me)])):(r(),g("div",{key:1,class:T([{"material-symbols-rounded":f.value},"index text-right"]),onClick:P},C(f.value?"play_arrow":s.index+1),3)),s.withCover?(r(),g("div",Fe,[t(fe,{src:s.song.cover,type:"track"},null,8,["src"])])):I("",!0),d("div",Oe,[d("span",Te,[t(S,{to:`/track/${p(ve)(s.song.id)}`,class:"linkOnHover"},{default:o(()=>[t(L,{text:s.song.title},null,8,["text"])]),_:1},8,["to"])]),d("span",je,[t(ye,{artist:s.song.artist,class:"text-muted text-xs"},null,8,["artist"])])]),s.withAlbum&&!p(ge)?(r(),g("div",He,[t(S,{to:s.song.album.href,class:"linkOnHover"},{default:o(()=>[t(L,{text:s.song.album.name},null,8,["text"])]),_:1},8,["to"])])):I("",!0),s.selected||f.value||s.song.favourite?(r(),g("div",{key:4,class:T([{favourite:s.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:q},C(s.song.favourite?"favorite":"heart_plus"),3)):I("",!0),d("div",Le,C(p(pe)(s.song.duration)),1)],34)]),_:1},8,["liked","playlistId","song"])}}}),Ye=he(Ue,[["__scopeId","data-v-67cfb148"]]);export{Ye as P};
