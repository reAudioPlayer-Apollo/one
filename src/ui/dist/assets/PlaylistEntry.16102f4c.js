import{m as H,o as a,c as d,d as p,x as I,k as K,l as W,a as r,_ as U,j as X,A,n as B,B as G,r as Q,g as o,w as n,b as m,F as R,i as T,f as P,t as h,u as _,e as x,J as Z,K as ee,h as te,M as F,y as oe}from"./index.8211b952.js";import{_ as se}from"./EditSong.vue_vue_type_script_setup_true_lang.7767f3e5.js";import{p as ne}from"./playerInPicture.37a9ab56.js";import{a as ae,c as le,r as ie,d as re,f as ue}from"./song.c5eb49fd.js";const O=e=>(K("data-v-e39c43d9"),e=e(),W(),e),de=O(()=>r("div",{class:"index text-right"},"#",-1)),ce=O(()=>r("div",{class:"artist-title"}," title ",-1)),ve={key:0,class:"album"},me=O(()=>r("div",{class:"duration"},[r("span",{class:"material-symbols-rounded"},"schedule")],-1)),fe=H({__name:"PlaylistHeader",props:{index:{type:Number,required:!0},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1}},setup(e){return(b,l)=>(a(),d("div",{class:I(["playlist-header",{withAlbum:e.withAlbum,withMore:e.withMore}])},[de,ce,e.withAlbum?(a(),d("div",ve," album ")):p("",!0),me],2))}});const qe=U(fe,[["__scopeId","data-v-e39c43d9"]]),ye=H({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:Number,required:!1,default:-1}},emits:["update","edit"],setup(e,{expose:b,emit:l}){const t=e,N=X(),u=A(()=>N.playlists),$=A(()=>t.playlistId==-1),C=()=>{ne(t.song.artist,t.song.title,t.song.src||t.song.source)},w=async s=>{s!=-1&&await ae(s,t.song)},S=async()=>{const s=await le(t.song.title,t.song.artist,t.song.cover);w(s)},D=async()=>{await ie(t.playlistId,t.song.id),l("update")},M=B(null),c=B(null),i=()=>{c.value.visible?k():f()},k=()=>{c.value.hide()},f=()=>{const s=M.value.getBoundingClientRect(),g={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};c.value.show(g)};b({show:f,toggle:i,hide:k});const j={Soundcloud:`https://soundcloud.com/search?q=${t.song.artist} ${t.song.title}`,Audius:`https://audius.co/search/${t.song.artist} ${t.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${t.song.artist} ${t.song.title}`,Spotify:`https://open.spotify.com/search/${t.song.artist} ${t.song.title}`},V=()=>{l("edit")},z=s=>{window.open(j[s]),V()};return(s,g)=>{const v=x("v-contextmenu-item"),L=x("v-contextmenu-submenu"),q=x("v-contextmenu-divider"),Y=x("v-contextmenu"),J=Z("contextmenu");return G((a(),d("div",{ref_key:"box",ref:M},[Q(s.$slots,"default"),o(Y,{ref_key:"contextmenu",ref:c},{default:n(()=>[o(v,{onClick:C},{default:n(()=>[m(" Preview ")]),_:1}),o(L,{title:"Find source"},{default:n(()=>[(a(!0),d(R,null,T(Object.keys(j),y=>(a(),P(v,{key:y,onClick:E=>z(y)},{default:n(()=>[m(h(y),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(q),o(v,{onClick:g[0]||(g[0]=y=>s.$emit("like"))},{default:n(()=>[m(h((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),_($)?p("",!0):(a(),P(v,{key:0,onClick:D},{default:n(()=>[m(" Remove from this playlist ")]),_:1})),o(L,{title:"Add to playlist"},{default:n(()=>[o(v,{onClick:S},{default:n(()=>[m("Add to new playlist")]),_:1}),o(q),(a(!0),d(R,null,T(_(u),(y,E)=>(a(),P(v,{key:E,onClick:be=>w(E)},{default:n(()=>[m(h(y.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(q),o(v,{onClick:V},{default:n(()=>[m(" Update Metadata ")]),_:1}),o(q),o(v,{onClick:g[1]||(g[1]=y=>_(re)(e.song.id))},{default:n(()=>[m("Download")]),_:1})]),_:1},512)])),[[J,void 0,"contextmenu"]])}}}),ge={key:0,class:"cover"},pe={class:"artist-title"},he={class:"title"},we={class:"artist"},ke={key:1,class:"album"},xe={class:"duration text-center"},_e=H({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null}},emits:["update"],setup(e,{emit:b}){const l=e,t=ee(),N=A(()=>l.song.id==t.song.id),u=B(!1),$=()=>{l.song.favourite=!l.song.favourite,ue(l.song.id,l.song.favourite)},C=A(()=>l.playlistId==null?t.playlist.id:l.playlistId),w=()=>{t.loadSong(C.value,l.index)},S=B(null),D=()=>{S.value.show()},M=()=>{b("update")};return(c,i)=>{const k=x("router-link");return a(),P(ye,{song:e.song,onEdit:D,onUpdate:M,onLike:$,playlistId:_(C),liked:e.song.favourite,ref:"ctxMenu"},{default:n(()=>[o(se,{ref_key:"updatePopup",ref:S,song:e.song,onUpdate:i[0]||(i[0]=f=>c.$emit("update"))},null,8,["song"]),r("div",{class:I(["playlist-entry",{playing:_(N),selected:e.selected,hovering:u.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore}]),onMouseenter:i[2]||(i[2]=f=>u.value=!0),onMouseleave:i[3]||(i[3]=f=>u.value=!1),onDblclick:w},[r("div",{class:I(["index text-right",{"material-symbols-rounded":u.value}]),onClick:w},h(u.value?"play_arrow":e.index+1),3),e.withCover?(a(),d("div",ge,[o(te,{src:e.song.cover,type:"track"},null,8,["src"])])):p("",!0),r("div",pe,[r("span",he,[o(k,{class:"linkOnHover",to:`/track/${e.song.id}`},{default:n(()=>[o(F,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),r("span",we,[o(k,{class:"linkOnHover",to:`/search/artist:${e.song.artist}`},{default:n(()=>[o(F,{text:e.song.artist},null,8,["text"])]),_:1},8,["to"])])]),e.withAlbum?(a(),d("div",ke,[o(F,{text:e.song.album},null,8,["text"])])):p("",!0),e.selected||u.value||e.song.favourite?(a(),d("div",{key:2,class:I(["favourite-icon icon text-right material-symbols-rounded",{favourite:e.song.favourite}]),onClick:$},h(e.song.favourite?"favorite":"heart_plus"),3)):p("",!0),r("div",xe,h(e.song.duration=="-1:59"?"N/A":e.song.duration),1),e.withMore&&(e.selected||u.value)?(a(),d("div",{key:3,onClick:i[1]||(i[1]=oe((...f)=>c.$refs.ctxMenu.toggle&&c.$refs.ctxMenu.toggle(...f),["stop"])),class:"icon text-left material-symbols-rounded"}," more_horiz ")):p("",!0)],34)]),_:1},8,["song","playlistId","liked"])}}});const Ie=U(_e,[["__scopeId","data-v-b30a0372"]]);export{qe as P,Ie as a};
