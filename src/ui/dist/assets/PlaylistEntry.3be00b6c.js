import{m as T,j as z,E as M,n as P,y as J,o as l,c as g,r as K,g as o,w as s,b as d,F as L,i as R,f as I,t as y,u as p,d as x,e as b,I as W,J as X,a as m,C as E,h as G,M as F,K as Q,_ as Z}from"./index.287edd0f.js";import{_ as ee}from"./EditSong.vue_vue_type_script_setup_true_lang.757fd74a.js";import{p as te}from"./playerInPicture.37a9ab56.js";import{a as oe,c as ne,r as se,d as ae,f as le}from"./song.d347a36d.js";const ie=T({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:Number,required:!1,default:-1}},emits:["update","edit"],setup(e,{expose:A,emit:a}){const t=e,B=z(),i=M(()=>B.playlists),C=M(()=>t.playlistId==-1),$=()=>{te(t.song.artist,t.song.title,t.song.source)},k=async n=>{n!=-1&&await oe(n,t.song)},_=async()=>{const n=await ne(t.song.title,t.song.artist,t.song.cover);k(n)},N=async()=>{await se(t.playlistId,t.song.id),a("update")},S=P(null),v=P(null),u=()=>{v.value.visible?h():w()},h=()=>{v.value.hide()},w=()=>{const n=S.value.getBoundingClientRect(),f={top:n.height+n.top+window.scrollY,left:n.width+n.left+window.scrollX};v.value.show(f)};A({show:w,toggle:u,hide:h});const O={Soundcloud:`https://soundcloud.com/search?q=${t.song.artist} ${t.song.title}`,Audius:`https://audius.co/search/${t.song.artist} ${t.song.title}`,"Youtube Music":`https://music.youtube.com/search?q=${t.song.artist} ${t.song.title}`,Spotify:`https://open.spotify.com/search/${t.song.artist} ${t.song.title}`},j=()=>{a("edit")},U=n=>{window.open(O[n]),j()};return(n,f)=>{const r=b("v-contextmenu-item"),V=b("v-contextmenu-submenu"),q=b("v-contextmenu-divider"),H=b("v-contextmenu"),Y=W("contextmenu");return J((l(),g("div",{ref_key:"box",ref:S},[K(n.$slots,"default"),o(H,{ref_key:"contextmenu",ref:v},{default:s(()=>[o(r,{onClick:$},{default:s(()=>[d(" Preview ")]),_:1}),o(V,{title:"Find source"},{default:s(()=>[(l(!0),g(L,null,R(Object.keys(O),c=>(l(),I(r,{key:c,onClick:D=>U(c)},{default:s(()=>[d(y(c),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(q),o(r,{onClick:f[0]||(f[0]=c=>n.$emit("like"))},{default:s(()=>[d(y((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),p(C)?x("",!0):(l(),I(r,{key:0,onClick:N},{default:s(()=>[d(" Remove from this playlist ")]),_:1})),o(V,{title:"Add to playlist"},{default:s(()=>[o(r,{onClick:_},{default:s(()=>[d("Add to new playlist")]),_:1}),o(q),(l(!0),g(L,null,R(p(i),(c,D)=>(l(),I(r,{key:D,onClick:ge=>k(D)},{default:s(()=>[d(y(c.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),o(q),o(r,{onClick:j},{default:s(()=>[d(" Update Metadata ")]),_:1}),o(q),o(r,{onClick:f[1]||(f[1]=c=>p(ae)(e.song.id))},{default:s(()=>[d("Download")]),_:1})]),_:1},512)])),[[Y,void 0,"contextmenu"]])}}}),ue={key:0,class:"cover"},re={class:"artist-title"},de={class:"title"},ce={class:"artist"},ve={key:1,class:"album"},fe={class:"duration text-center"},me=T({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null}},emits:["update"],setup(e,{emit:A}){const a=e,t=X(),B=M(()=>a.song.id==t.song.id),i=P(!1),C=()=>{a.song.favourite=!a.song.favourite,le(a.song.id,a.song.favourite)},$=M(()=>a.playlistId==null?t.playlist.id:a.playlistId),k=()=>{t.loadSong($.value,a.index)},_=P(null),N=()=>{_.value.show()},S=()=>{A("update")};return(v,u)=>{const h=b("router-link");return l(),I(ie,{ref:"ctxMenu",liked:e.song.favourite,playlistId:p($),song:e.song,onEdit:N,onLike:C,onUpdate:S},{default:s(()=>[o(ee,{ref_key:"updatePopup",ref:_,song:e.song,onUpdate:u[0]||(u[0]=w=>v.$emit("update"))},null,8,["song"]),m("div",{class:E([{playing:p(B),selected:e.selected,hovering:i.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore},"playlist-entry"]),onDblclick:k,onMouseenter:u[2]||(u[2]=w=>i.value=!0),onMouseleave:u[3]||(u[3]=w=>i.value=!1)},[m("div",{class:E([{"material-symbols-rounded":i.value},"index text-right"]),onClick:k},y(i.value?"play_arrow":e.index+1),3),e.withCover?(l(),g("div",ue,[o(G,{src:e.song.cover,type:"track"},null,8,["src"])])):x("",!0),m("div",re,[m("span",de,[o(h,{to:`/track/${e.song.id}`,class:"linkOnHover"},{default:s(()=>[o(F,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),m("span",ce,[o(h,{to:`/search/artist:${e.song.artist}`,class:"linkOnHover"},{default:s(()=>[o(F,{text:e.song.artist},null,8,["text"])]),_:1},8,["to"])])]),e.withAlbum&&!p(Q)?(l(),g("div",ve,[o(F,{text:e.song.album},null,8,["text"])])):x("",!0),e.selected||i.value||e.song.favourite?(l(),g("div",{key:2,class:E([{favourite:e.song.favourite},"favourite-icon icon text-right material-symbols-rounded"]),onClick:C},y(e.song.favourite?"favorite":"heart_plus"),3)):x("",!0),m("div",fe,y(e.song.duration=="-1:59"?"N/A":e.song.duration),1),x("",!0)],34)]),_:1},8,["liked","playlistId","song"])}}});const we=Z(me,[["__scopeId","data-v-e78075bc"]]);export{we as P};
