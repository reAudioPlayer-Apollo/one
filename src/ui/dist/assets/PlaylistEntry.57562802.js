import{m as H,o as i,c as v,d as g,n as P,k as T,l as U,a as l,_ as V,j as z,A as q,q as A,B as J,r as W,g as t,w as n,b as y,t as x,u as k,f as E,F as X,h as Y,e as w,I as G,J as K,M as D,y as Q}from"./index.a83ce700.js";import{_ as Z}from"./EditSong.vue_vue_type_script_setup_true_lang.3c2803b2.js";import{p as ee}from"./playerInPicture.37a9ab56.js";import{a as te,c as oe,r as se,d as ne,f as ae}from"./song.0328dbbf.js";const F=e=>(T("data-v-2a60ceac"),e=e(),U(),e),le=F(()=>l("div",{class:"index text-right"},"#",-1)),ie=F(()=>l("div",{class:"artist-title"}," title ",-1)),re={key:0,class:"album"},de=F(()=>l("div",{class:"duration"},[l("span",{class:"material-symbols-rounded"},"schedule")],-1)),ue=H({__name:"PlaylistHeader",props:{index:{type:Number,required:!0},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1}},setup(e){return(_,a)=>(i(),v("div",{class:P(["playlist-header",{withAlbum:e.withAlbum,withMore:e.withMore}])},[le,ie,e.withAlbum?(i(),v("div",re," album ")):g("",!0),de],2))}});const $e=V(ue,[["__scopeId","data-v-2a60ceac"]]),ce=H({__name:"SongContext",props:{song:{type:Object,required:!0},playlistId:{type:Number,required:!1,default:-1}},emits:["update"],setup(e,{expose:_,emit:a}){const o=e,B=z(),d=q(()=>B.playlists),b=q(()=>o.playlistId==-1),C=()=>{ee(o.song.artist,o.song.title,o.song.src||o.song.source)},h=async s=>{s!=-1&&await te(s,o.song)},$=async()=>{const s=await oe(o.song.title,o.song.artist,o.song.cover);h(s)},N=async()=>{await se(o.playlistId,o.song.id),a("update")},S=A(null),u=A(null),r=()=>{u.value.visible?p():m()},p=()=>{u.value.hide()},m=()=>{const s=S.value.getBoundingClientRect(),c={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};u.value.show(c)};return _({show:m,toggle:r,hide:p}),(s,c)=>{const f=w("v-contextmenu-item"),M=w("v-contextmenu-divider"),j=w("v-contextmenu-submenu"),L=w("v-contextmenu"),R=G("contextmenu");return J((i(),v("div",{ref_key:"box",ref:S},[W(s.$slots,"default"),t(L,{ref_key:"contextmenu",ref:u},{default:n(()=>[t(f,{onClick:C},{default:n(()=>[y("Preview")]),_:1}),t(M),t(f,{onClick:c[0]||(c[0]=I=>s.$emit("like"))},{default:n(()=>[y(x((e.song.favourite?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1}),k(b)?g("",!0):(i(),E(f,{key:0,onClick:N},{default:n(()=>[y(" Remove from this playlist ")]),_:1})),t(j,{title:"Add to playlist"},{default:n(()=>[t(f,{onClick:$},{default:n(()=>[y("Add to new playlist")]),_:1}),t(M),(i(!0),v(X,null,Y(k(d),(I,O)=>(i(),E(f,{key:O,onClick:xe=>h(O)},{default:n(()=>[y(x(I.name),1)]),_:2},1032,["onClick"]))),128))]),_:1}),t(M),t(f,{onClick:c[1]||(c[1]=I=>s.$emit("edit"))},{default:n(()=>[y("Update Metadata")]),_:1}),t(M),t(f,{onClick:c[2]||(c[2]=I=>k(ne)(e.song.id))},{default:n(()=>[y("Download")]),_:1})]),_:1},512)])),[[R,void 0,"contextmenu"]])}}}),ve={key:0,class:"cover"},me=["src"],fe={class:"artist-title"},ye={class:"title"},ge={class:"artist"},he={key:1,class:"album"},pe={class:"duration text-center"},we=H({__name:"PlaylistEntry",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},withCover:{type:Boolean,required:!1,default:!1},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},selected:{type:Boolean,required:!1,default:!1},playlistId:{type:Number,required:!1,default:null}},emits:["update"],setup(e,{emit:_}){const a=e,o=K(),B=q(()=>a.song.id==o.song.id),d=A(!1),b=()=>{a.song.favourite=!a.song.favourite,ae(a.song.id,a.song.favourite)},C=q(()=>a.playlistId==null?o.playlist.id:a.playlistId),h=()=>{o.loadSong(C.value,a.index)},$=A(null),N=()=>{$.value.show()},S=()=>{_("update")};return(u,r)=>{const p=w("router-link");return i(),E(ce,{song:e.song,onEdit:N,onUpdate:S,onLike:b,playlistId:k(C),liked:e.song.favourite,ref:"ctxMenu"},{default:n(()=>[t(Z,{ref_key:"updatePopup",ref:$,song:e.song,onUpdate:r[0]||(r[0]=m=>u.$emit("update"))},null,8,["song"]),l("div",{class:P(["playlist-entry",{playing:k(B),selected:e.selected,hovering:d.value,withCover:e.withCover,withAlbum:e.withAlbum,withMore:e.withMore}]),onMouseenter:r[2]||(r[2]=m=>d.value=!0),onMouseleave:r[3]||(r[3]=m=>d.value=!1),onDblclick:h},[l("div",{class:P(["index text-right",{"material-symbols-rounded":d.value}]),onClick:h},x(d.value?"play_arrow":e.index+1),3),e.withCover?(i(),v("div",ve,[l("img",{src:e.song.cover},null,8,me)])):g("",!0),l("div",fe,[l("span",ye,[t(p,{class:"linkOnHover",to:`/track/${e.song.id}`},{default:n(()=>[t(D,{text:e.song.title},null,8,["text"])]),_:1},8,["to"])]),l("span",ge,[t(p,{class:"linkOnHover",to:`/search/artist:${e.song.artist}`},{default:n(()=>[t(D,{text:e.song.artist},null,8,["text"])]),_:1},8,["to"])])]),e.withAlbum?(i(),v("div",he,[t(D,{text:e.song.album},null,8,["text"])])):g("",!0),e.selected||d.value||e.song.favourite?(i(),v("div",{key:2,class:P(["favourite-icon icon text-right material-symbols-rounded",{favourite:e.song.favourite}]),onClick:b},x(e.song.favourite?"favorite":"heart_plus"),3)):g("",!0),l("div",pe,x(e.song.duration=="-1:59"?"N/A":e.song.duration),1),e.withMore&&(e.selected||d.value)?(i(),v("div",{key:3,onClick:r[1]||(r[1]=Q((...m)=>u.$refs.ctxMenu.toggle&&u.$refs.ctxMenu.toggle(...m),["stop"])),class:"icon text-left material-symbols-rounded"}," more_horiz ")):g("",!0)],34)]),_:1},8,["song","playlistId","liked"])}}});const Se=V(we,[["__scopeId","data-v-301f3433"]]);export{$e as P,Se as a};
