import{n as S,j as k,q as d,o as p,f as v,w as g,g as u,u as T,b$ as x,a as i,bN as A,x as I,_ as j,C as N,h as B,p as D,e as _,d as b,c as M,t as O}from"./index-fe2c9584.js";import{T as q}from"./Template-f7fd23e9.js";import{F as V}from"./Form-6220abd3.js";import{P as E}from"./Playlist-41f8fb8f.js";import{T as F}from"./ExternalEntry-7bdbc9d0.js";import{p as H}from"./playerInPicture-af203fdf.js";const L=i("br",null,null,-1),W=S({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(n,{expose:r}){const e=n,y=k(),c=d([{name:"playlist",type:"dropdown",required:!0,value:null,options:y.playlistsAsDropdown}]),l=d(null),o=d(null),s=d([]),m=async()=>{if(l.value.load(),s.value.length==0){const t=await fetch(`/api/spotify/playlists/${e.playlist.id}`);s.value=await t.json()}l.value.show()},f=()=>{H("Spotify Playlist",e.playlist.name,e.playlist.href)},h=async t=>{if(t==="new"){const a=await I(e.playlist.name,e.playlist.description,e.playlist.cover);return c.value[0].options=y.playlistsAsDropdown,c.value[0].value=a,a}return Number(t)},w=async(t,a=null)=>{s.value[t].added||(a??(a=o.value.toObject().playlist),a=await h(a),await A(a??o.value.toObject().playlist,s.value[t]),s.value[t].added=!0)},P=async()=>{let t=o.value.toObject().playlist;t=await h(t),s.value.forEach((a,C)=>{w(C,t)})};return r({show:m}),(t,a)=>(p(),v(q,{ref_key:"modal",ref:l,submit:{label:"Add All",icon:"add"},name:"Import Playlist",onClose:a[0]||(a[0]=C=>t.$emit("close")),onSubmit:P},{default:g(()=>[u(F,{cover:n.playlist.cover,icons:[{name:"share",onClick:()=>T(x)(n.playlist.href)},{name:"play_arrow",onClick:f}],title:n.playlist.name},null,8,["cover","icons","title"]),u(V,{ref_key:"form",ref:o,options:c.value},null,8,["options"]),L,u(E,{songs:s.value,onAdd:w},null,8,["songs"])]),_:1},512))}});const $={components:{Card:N,Cover:B,AddPlaylistToPlaylist:W},name:"PlaylistItem",methods:{parseCover:D,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String,type:String}},z={class:"title"},G={key:0,class:"material-symbols-rounded"},J=["innerHTML"];function K(n,r,e,y,c,l){const o=_("add-playlist-to-playlist"),s=_("Cover"),m=_("Card");return p(),v(m,{class:"wrapper drop-shadow-md","with-hover":""},{default:g(()=>[e.spotify?(p(),v(o,{key:0,ref:"import",playlist:{cover:e.cover,name:e.title,description:e.description,id:e.id,href:e.href}},null,8,["playlist"])):b("",!0),i("div",{class:"item",onClick:r[0]||(r[0]=(...f)=>l.redirect&&l.redirect(...f))},[u(s,{src:l.parseCover(e.cover),type:"playlist"},null,8,["src"]),i("div",z,[e.type=="special"?(p(),M("span",G," neurology ")):b("",!0),i("h4",null,O(e.title),1)]),i("p",{class:"text-muted text-xs hideIfMobile",innerHTML:e.description},null,8,J)])]),_:1})}const ee=j($,[["render",K],["__scopeId","data-v-8be4ce3c"]]);export{ee as P};
