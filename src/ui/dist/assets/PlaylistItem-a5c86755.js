import{m as S,j as b,n as c,o as v,f as _,w as P,g as d,u as k,a as p,L as T,_ as A,h as I,p as j,d as x,t as N,e as f}from"./index-2fc95183.js";import{F as B,T as D}from"./Form-92818e8b.js";import{P as M}from"./Playlist-6be6df27.js";import{T as O}from"./ExternalEntry-e73c466b.js";import{a as L,c as V}from"./song-910f5498.js";import{p as q}from"./playerInPicture-af203fdf.js";import{C as F}from"./Card-3ca661b0.js";const H=p("br",null,null,-1),E=S({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(n,{expose:i}){const t=n,u=b(),r=c([{name:"playlist",type:"dropdown",required:!0,value:null,options:u.playlistsAsDropdown}]),s=c(null),o=c(null),l=c([]),m=async()=>{if(s.value.load(),l.value.length==0){const e=await fetch(`/api/spotify/playlists/${t.playlist.id}`);l.value=await e.json()}s.value.show()},y=()=>{q("Spotify Playlist",t.playlist.name,t.playlist.href)},h=async e=>{if(e==="new"){const a=await V(t.playlist.name,t.playlist.description,t.playlist.cover);return r.value[0].options=u.playlistsAsDropdown,r.value[0].value=a,a}return Number(e)},w=async(e,a=null)=>{l.value[e].added||(a??(a=o.value.toObject().playlist),a=await h(a),await L(a??o.value.toObject().playlist,l.value[e]),l.value[e].added=!0)},g=async()=>{let e=o.value.toObject().playlist;e=await h(e),l.value.forEach((a,C)=>{w(C,e)})};return i({show:m}),(e,a)=>(v(),_(D,{ref_key:"modal",ref:s,submit:{label:"Add All",icon:"add"},name:"Import Playlist",onClose:a[0]||(a[0]=C=>e.$emit("close")),onSubmit:g},{default:P(()=>[d(O,{cover:n.playlist.cover,icons:[{name:"share",onClick:()=>k(T)(n.playlist.href)},{name:"play_arrow",onClick:y}],title:n.playlist.name},null,8,["cover","icons","title"]),d(B,{ref_key:"form",ref:o,options:r.value},null,8,["options"]),H,d(M,{songs:l.value,onAdd:w},null,8,["songs"])]),_:1},512))}});const W={components:{Card:F,Cover:I,AddPlaylistToPlaylist:E},name:"PlaylistItem",methods:{parseCover:j,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},$=["innerHTML"];function z(n,i,t,u,r,s){const o=f("add-playlist-to-playlist"),l=f("Cover"),m=f("Card");return v(),_(m,{class:"wrapper drop-shadow-md","with-hover":""},{default:P(()=>[t.spotify?(v(),_(o,{key:0,ref:"import",playlist:{cover:t.cover,name:t.title,description:t.description,id:t.id,href:t.href}},null,8,["playlist"])):x("",!0),p("div",{class:"item",onClick:i[0]||(i[0]=(...y)=>s.redirect&&s.redirect(...y))},[d(l,{src:s.parseCover(t.cover),type:"playlist"},null,8,["src"]),p("h4",null,N(t.title),1),p("p",{class:"text-muted text-xs hideIfMobile",innerHTML:t.description},null,8,$)])]),_:1})}const Y=A(W,[["render",z],["__scopeId","data-v-3a82f04d"]]);export{Y as P};
