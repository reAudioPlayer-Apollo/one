import{i as k,k as x,q as u,o as y,f as v,w as P,g as p,cJ as A,u as I,cq as T,x as B,cK as j,c9 as q,a as r,cb as D,y as M,_ as N,C as O,h as V,p as E,e as _,d as b,c as H,t as g}from"./index-7c35142e.js";import{p as L}from"./playerInPicture-af203fdf.js";const F=r("br",null,null,-1),J=k({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(n,{expose:c}){const e=x(),l=n,d=u([{name:"playlist",type:"dropdown",required:!0,value:null,options:e.playlistsAsDropdown}]),o=u(null),i=u(null),s=u([]),m=async()=>{if(o.value.load(),s.value.length==0){const t=await fetch(`/api/spotify/playlists/${l.playlist.id}`);s.value=await t.json()}o.value.show()},f=()=>{L("Spotify Playlist",l.playlist.name,l.playlist.href)},h=async t=>{if(t==="new"){const a=await M("classic",l.playlist.name,l.playlist.description,l.playlist.cover);return d.value[0].options=e.playlistsAsDropdown,d.value[0].value=a,a}return t},w=async(t,a=null)=>{s.value[t].added||(a??(a=i.value.toObject().playlist),a=await h(a),await D(a,s.value[t]),s.value[t].added=!0)},S=async()=>{let t=i.value.toObject().playlist;t=await h(t),s.value.forEach((a,C)=>{w(C,t)})};return c({show:m}),(t,a)=>(y(),v(q,{ref_key:"modal",ref:o,submit:{label:"Add All",icon:"add"},name:"Import Playlist",onClose:a[0]||(a[0]=C=>t.$emit("close")),onSubmit:S},{default:P(()=>[p(A,{cover:n.playlist.cover,icons:[{name:"share",onClick:()=>I(T)(n.playlist.href)},{name:"play_arrow",onClick:f}],title:n.playlist.name},null,8,["cover","icons","title"]),p(B,{ref_key:"form",ref:i,options:d.value},null,8,["options"]),F,p(j,{songs:s.value,onAdd:w},null,8,["songs"])]),_:1},512))}});const K={components:{Card:O,Cover:V,AddPlaylistToPlaylist:J},name:"PlaylistItem",methods:{parseCover:E,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String,type:{type:String,default:"classic"}}},W={class:"title"},z={key:0,class:"material-symbols-rounded"},G=["innerHTML"];function Q(n,c,e,l,d,o){const i=_("add-playlist-to-playlist"),s=_("Cover"),m=_("Card");return y(),v(m,{class:"wrapper drop-shadow-md","with-hover":""},{default:P(()=>[e.spotify?(y(),v(i,{key:0,ref:"import",playlist:{cover:e.cover,name:e.title,description:e.description,id:e.id,href:e.href}},null,8,["playlist"])):b("",!0),r("div",{class:"item",onClick:c[0]||(c[0]=(...f)=>o.redirect&&o.redirect(...f))},[p(s,{src:o.parseCover(e.cover),type:"playlist",name:e.title},null,8,["src","name"]),r("div",W,[e.type!="classic"?(y(),H("span",z,g(e.type=="smart"?"neurology":"bolt"),1)):b("",!0),r("h4",null,g(e.title),1)]),r("p",{class:"text-muted text-xs hideIfMobile",innerHTML:e.description},null,8,G)])]),_:1})}const X=N(K,[["render",Q],["__scopeId","data-v-254ebb4a"]]);export{X as P};
