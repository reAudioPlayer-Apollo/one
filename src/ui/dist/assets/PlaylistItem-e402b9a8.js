import{i as k,k as x,q as p,o as u,f as v,w as S,g as y,u as T,cc as A,a as r,bZ as I,x as B,_ as j,C as D,h as M,p as N,e as _,d as g,c as q,t as P}from"./index-22c3a330.js";import{T as O}from"./Template-1066d4b3.js";import{F as V}from"./Form-0e823432.js";import{P as E}from"./Playlist-8a3bb36b.js";import{T as F}from"./ExternalEntry-b91da4ba.js";import{p as H}from"./playerInPicture-af203fdf.js";const L=r("br",null,null,-1),W=k({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(i,{expose:c}){const t=x(),l=i,d=p([{name:"playlist",type:"dropdown",required:!0,value:null,options:t.playlistsAsDropdown}]),o=p(null),n=p(null),s=p([]),m=async()=>{if(o.value.load(),s.value.length==0){const e=await fetch(`/api/spotify/playlists/${l.playlist.id}`);s.value=await e.json()}o.value.show()},f=()=>{H("Spotify Playlist",l.playlist.name,l.playlist.href)},h=async e=>{if(e==="new"){const a=await B("classic",l.playlist.name,l.playlist.description,l.playlist.cover);return d.value[0].options=t.playlistsAsDropdown,d.value[0].value=a,a}return e},w=async(e,a=null)=>{s.value[e].added||(a??(a=n.value.toObject().playlist),a=await h(a),await I(a,s.value[e]),s.value[e].added=!0)},b=async()=>{let e=n.value.toObject().playlist;e=await h(e),s.value.forEach((a,C)=>{w(C,e)})};return c({show:m}),(e,a)=>(u(),v(O,{ref_key:"modal",ref:o,submit:{label:"Add All",icon:"add"},name:"Import Playlist",onClose:a[0]||(a[0]=C=>e.$emit("close")),onSubmit:b},{default:S(()=>[y(F,{cover:i.playlist.cover,icons:[{name:"share",onClick:()=>T(A)(i.playlist.href)},{name:"play_arrow",onClick:f}],title:i.playlist.name},null,8,["cover","icons","title"]),y(V,{ref_key:"form",ref:n,options:d.value},null,8,["options"]),L,y(E,{songs:s.value,onAdd:w},null,8,["songs"])]),_:1},512))}});const Z={components:{Card:D,Cover:M,AddPlaylistToPlaylist:W},name:"PlaylistItem",methods:{parseCover:N,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String,type:{type:String,default:"classic"}}},z={class:"title"},G={key:0,class:"material-symbols-rounded"},J=["innerHTML"];function K(i,c,t,l,d,o){const n=_("add-playlist-to-playlist"),s=_("Cover"),m=_("Card");return u(),v(m,{class:"wrapper drop-shadow-md","with-hover":""},{default:S(()=>[t.spotify?(u(),v(n,{key:0,ref:"import",playlist:{cover:t.cover,name:t.title,description:t.description,id:t.id,href:t.href}},null,8,["playlist"])):g("",!0),r("div",{class:"item",onClick:c[0]||(c[0]=(...f)=>o.redirect&&o.redirect(...f))},[y(s,{src:o.parseCover(t.cover),type:"playlist"},null,8,["src"]),r("div",z,[t.type!="classic"?(u(),q("span",G,P(t.type=="smart"?"neurology":"bolt"),1)):g("",!0),r("h4",null,P(t.title),1)]),r("p",{class:"text-muted text-xs hideIfMobile",innerHTML:t.description},null,8,J)])]),_:1})}const tt=j(Z,[["render",K],["__scopeId","data-v-7d67aac6"]]);export{tt as P};
