import{_ as b,e as c,v as M,o as n,c as r,g as p,w as _,a as t,x as a,y as k,F as g,h as S,t as v,z as h,b as V,f as w,j as I,d as N}from"./index.6f3ae9d0.js";import{F}from"./FindSources.086862af.js";import{S as U}from"./SpotifyPlaylistEntry.5c580e40.js";import{S as B}from"./SpotifyPlaylistHeader.de36cb21.js";const H={name:"AddPlaylistToPlaylist",components:{FindSources:F,SpotifyPlaylistHeader:B,SpotifyPlaylistEntry:U},props:{cover:String,description:String,title:String,href:String,id:String},data(){return{showModal:!1,playlists:[],selectedPlaylist:-1,playlist:[],editSong:!1}},methods:{share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:this.$refs.source.value})}).then(e=>e.json()).then(e=>{console.log(e),this.dTitle=e.title,this.$refs.album.value=e.album,this.dArtist=e.artists.join(", "),this.dCover=e.cover,this.$refs.source.value=e.src})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},addAll(){for(let e=0;e<this.playlist.length;e++)this.add(e)},add(e){const s=this.playlist[e],i=this.playlists.findIndex(u=>u==this.selectedPlaylist);if(console.log(s,i),i<0){alert("no playlist selected");return}fetch(`/api/playlists/${i}/tracks`,{method:"POST",body:JSON.stringify({source:s.src,title:s.title,artist:s.artists.join(", "),album:s.album,cover:s.cover})}).then(u=>{u.status==200&&(s.added=!0)})}},watch:{dSource(){this.loadMetadata()},showModal(){!this.showModal||(fetch("/api/playlists").then(e=>e.json()).then(e=>{this.playlists.length=0,this.playlists.push(...e)}),fetch(`/api/spotify/playlists/${this.id}`).then(e=>e.json()).then(e=>{this.playlist.length=0,this.playlist.push(...e)}))}}},L={class:"wrapper"},O={class:"header"},D=t("h3",null,"Import playlist",-1),j=t("span",{class:"material-icons-round"}," close ",-1),E=[j],J=t("h4",null,"To Playlist",-1),z=t("br",null,null,-1),q={key:0},x=t("h4",null,"Source",-1),G={class:"content"},K=t("h4",null,"Title",-1),Q={class:"content"},R=t("h4",null,"Album",-1),W={class:"content"},X=t("h4",null,"Artist",-1),Y={class:"content"},Z=t("h4",null,"Cover",-1),$={class:"content"},ee=["src"],te={class:"confirm"},se={key:1},le=["src"],ie={class:"details"},oe={class:"detailswrapper"},ne=["innerHTML"],de=t("hr",null,null,-1),re=t("hr",null,null,-1),ae={class:"confirm"};function ce(e,s,i,u,d,o){const y=c("FindSources"),m=c("h7"),P=c("spotify-playlist-header"),C=c("spotify-playlist-entry"),T=c("vue-final-modal"),A=M("observe-visibility");return n(),r("div",null,[p(T,{onClick:e.hideFindSourcesCtx,modelValue:d.showModal,"onUpdate:modelValue":s[13]||(s[13]=l=>d.showModal=l),classes:"modal-container","content-class":"addAlbumToPlaylistPopup"},{default:_(()=>[t("div",L,[t("div",O,[D,t("button",{class:"modal-close",onClick:s[0]||(s[0]=(...l)=>o.close&&o.close(...l))},E)]),J,a(t("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>d.selectedPlaylist=l)},[(n(!0),r(g,null,S(d.playlists,l=>(n(),r("option",{key:l},v(l),1))),128))],512),[[k,d.selectedPlaylist]]),z,d.editSong?(n(),r("div",q,[x,p(y,{ref:"findSources",src:e.dSource,title:i.title,artist:e.artist},{default:_(()=>[t("div",G,[a(t("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=l=>e.dSource=l),ref:"source"},null,512),[[h,e.dSource]]),t("span",{class:"material-icons-round more",ref:"sourceMore",onClick:s[3]||(s[3]=(...l)=>e.opencontextmenu&&e.opencontextmenu(...l))},"more_vert",512)])]),_:1},8,["src","title","artist"]),K,t("div",Q,[a(t("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>e.dTitle=l),type:"text"},null,512),[[h,e.dTitle]])]),R,t("div",W,[a(t("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>e.dAlbum=l),type:"text",ref:"album"},null,512),[[h,e.dAlbum]])]),X,t("div",Y,[a(t("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>e.dArtist=l),type:"text"},null,512),[[h,e.dArtist]])]),Z,t("div",$,[a(t("input",{type:"text",class:"addSong cover","onUpdate:modelValue":s[7]||(s[7]=l=>e.dCover=l),ref:"cover"},null,512),[[h,e.dCover]]),t("img",{onClick:s[8]||(s[8]=(...l)=>o.openInNewTab&&o.openInNewTab(...l)),class:"addSong cover",src:e.dCover?e.dCover:"/assets/img/music_placeholder.png"},null,8,ee)]),t("div",te,[t("button",{onClick:s[9]||(s[9]=(...l)=>o.add&&o.add(...l)),class:"negative"},"Add")])])):(n(),r("div",se,[a((n(),r("div",{class:"padding-20 playlisteditor",onClick:s[11]||(s[11]=(...l)=>e.editPlaylist&&e.editPlaylist(...l))},[t("img",{class:"cover",src:i.cover},null,8,le),t("div",ie,[t("div",oe,[p(m,null,{default:_(()=>[V("Playlist")]),_:1}),t("span",{class:"material-icons-round share",onClick:s[10]||(s[10]=(...l)=>o.share&&o.share(...l))},"share")]),t("h1",null,v(i.title),1),t("h5",{innerHTML:i.description},null,8,ne)])])),[[A,e.headerVisibilityChanged]]),de,p(P),re,(n(!0),r(g,null,S(d.playlist,(l,f)=>(n(),w(C,{onAdd:o.add,key:f,added:l.added,index:f,cover:l.cover,artist:l.artists.join(", "),title:l.title,source:l.src,album:l.album,preview:l.preview},null,8,["onAdd","added","index","cover","artist","title","source","album","preview"]))),128))])),t("div",ae,[t("button",{onClick:s[12]||(s[12]=(...l)=>o.addAll&&o.addAll(...l)),class:"negative"},"Add All")])])]),_:1},8,["onClick","modelValue"])])}const ue=b(H,[["render",ce]]);const he={components:{AddPlaylistToPlaylist:ue},name:"PlaylistItem",methods:{parseCover:I,redirect(){this.spotify?this.$refs.import.showModal=!0:this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},pe={class:"wrapper drop-shadow-md"},ye=["src"],me=["innerHTML"];function _e(e,s,i,u,d,o){const y=c("add-playlist-to-playlist");return n(),r("div",pe,[i.spotify?(n(),w(y,{key:0,cover:i.cover,href:i.href,title:i.title,description:i.description,id:i.id,ref:"import"},null,8,["cover","href","title","description","id"])):N("",!0),t("div",{class:"item",onClick:s[0]||(s[0]=(...m)=>o.redirect&&o.redirect(...m))},[t("img",{src:o.parseCover(i.cover)},null,8,ye),t("h4",null,v(i.title),1),t("p",{class:"hideIfMobile",innerHTML:i.description},null,8,me)])])}const be=b(he,[["render",_e],["__scopeId","data-v-c1a95789"]]);export{be as P};
