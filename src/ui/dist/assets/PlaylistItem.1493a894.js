import{B as w,i as g,C as c,o as p,f,w as C,g as d,u as S,G as P,a as o,_ as b,j as k,e as I,c as T,d as B,t as A}from"./index.12f03f32.js";import{F as N,T as j,a as E}from"./song.e52b21df.js";import{T as M,P as V}from"./TrackInfo.517dd8b6.js";const q=o("br",null,null,-1),x=w({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(a,{expose:i}){const e=a,u=g(),m=[{name:"playlist",type:"dropdown",required:!0,value:null,options:u.playlists.map(t=>({label:t.name,value:t.id}))}],s=c(null),n=c(null),l=c([]),_=async()=>{if(s.value.load(),l.value.length==0){const t=await fetch(`/api/spotify/playlists/${e.playlist.id}`);l.value=await t.json()}s.value.show()},v=()=>{console.log(e.playlist);const t=new CustomEvent("player.play",{detail:{artist:"Spotify Playlist",title:e.playlist.name,source:e.playlist.href}});window.dispatchEvent(t)},y=async t=>{l.value[t].added||(await E(n.value.toObject().playlist,l.value[t]),l.value[t].added=!0)},h=()=>{l.value.forEach((t,r)=>{y(r)})};return i({show:_}),(t,r)=>(p(),f(j,{ref_key:"modal",ref:s,name:"Import Playlist",submitName:"Add All",onSubmit:h,onClose:r[0]||(r[0]=G=>t.$emit("close"))},{default:C(()=>[d(M,{title:a.playlist.name,cover:a.playlist.cover,icons:[{name:"share",onClick:()=>S(P)(a.playlist.href)},{name:"play_arrow",onClick:v}]},null,8,["title","cover","icons"]),d(N,{ref_key:"form",ref:n,options:m},null,512),q,d(V,{songs:l.value,onAdd:y},null,8,["songs"])]),_:1},512))}});const D={components:{AddPlaylistToPlaylist:x},name:"PlaylistItem",methods:{parseCover:k,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},F={class:"wrapper drop-shadow-md"},H=["src"],L=["innerHTML"];function O(a,i,e,u,m,s){const n=I("add-playlist-to-playlist");return p(),T("div",F,[e.spotify?(p(),f(n,{key:0,playlist:{cover:e.cover,name:e.title,description:e.description,id:e.id,href:e.href},ref:"import"},null,8,["playlist"])):B("",!0),o("div",{class:"item",onClick:i[0]||(i[0]=(...l)=>s.redirect&&s.redirect(...l))},[o("img",{src:s.parseCover(e.cover)},null,8,H),o("h4",null,A(e.title),1),o("p",{class:"hideIfMobile",innerHTML:e.description},null,8,L)])])}const Q=b(D,[["render",O],["__scopeId","data-v-8e2d9bf7"]]);export{Q as P};
