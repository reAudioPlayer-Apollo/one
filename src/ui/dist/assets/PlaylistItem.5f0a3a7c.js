import{F as M}from"./FindSources.cd82711f.js";import{S as k}from"./SpotifyPlaylistEntry.2a296d34.js";import{S as V}from"./SpotifyPlaylistHeader.49f3c380.js";import{_ as b,e as c,q as I,o as n,c as r,g as p,w as _,a as e,s as a,v as N,F as g,j as S,t as v,u as h,b as F,f as w,d as U}from"./index.12dec214.js";const B={name:"AddPlaylistToPlaylist",components:{FindSources:M,SpotifyPlaylistHeader:V,SpotifyPlaylistEntry:k},props:{cover:String,description:String,title:String,href:String,id:String},data(){return{showModal:!1,playlists:[],selectedPlaylist:-1,playlist:[],editSong:!1}},methods:{share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:this.$refs.source.value})}).then(t=>t.json()).then(t=>{console.log(t),this.dTitle=t.title,this.$refs.album.value=t.album,this.dArtist=t.artists.join(", "),this.dCover=t.cover,this.$refs.source.value=t.src})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},addAll(){for(let t=0;t<this.playlist.length;t++)this.add(t)},add(t){const s=this.playlist[t],i=this.playlists.findIndex(u=>u==this.selectedPlaylist);if(console.log(s,i),i<0){alert("no playlist selected");return}fetch(`/api/playlists/${i}/tracks`,{method:"POST",body:JSON.stringify({source:s.src,title:s.title,artist:s.artists.join(", "),album:s.album,cover:s.cover})}).then(u=>{u.status==200&&(s.added=!0)})}},watch:{dSource(){this.loadMetadata()},showModal(){!this.showModal||(fetch("/api/playlists").then(t=>t.json()).then(t=>{this.playlists.length=0,this.playlists.push(...t)}),fetch(`/api/spotify/playlists/${this.id}`).then(t=>t.json()).then(t=>{this.playlist.length=0,this.playlist.push(...t)}))}}},H={class:"wrapper"},L={class:"header"},O=e("h3",null,"Import playlist",-1),D=e("span",{class:"material-icons-round"}," close ",-1),j=[D],E=e("h4",null,"To Playlist",-1),J=e("br",null,null,-1),q={key:0},z=e("h4",null,"Source",-1),G={class:"content"},K=e("h4",null,"Title",-1),Q={class:"content"},R=e("h4",null,"Album",-1),W={class:"content"},X=e("h4",null,"Artist",-1),Y={class:"content"},Z=e("h4",null,"Cover",-1),x={class:"content"},$=["src"],tt={class:"confirm"},et={key:1},st=["src"],lt={class:"details"},it={class:"detailswrapper"},ot=["innerHTML"],nt=e("hr",null,null,-1),dt=e("hr",null,null,-1),rt={class:"confirm"};function at(t,s,i,u,d,o){const y=c("FindSources"),m=c("h7"),P=c("spotify-playlist-header"),C=c("spotify-playlist-entry"),T=c("vue-final-modal"),A=I("observe-visibility");return n(),r("div",null,[p(T,{onClick:t.hideFindSourcesCtx,modelValue:d.showModal,"onUpdate:modelValue":s[13]||(s[13]=l=>d.showModal=l),classes:"modal-container","content-class":"addAlbumToPlaylistPopup"},{default:_(()=>[e("div",H,[e("div",L,[O,e("button",{class:"modal-close",onClick:s[0]||(s[0]=(...l)=>o.close&&o.close(...l))},j)]),E,a(e("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>d.selectedPlaylist=l)},[(n(!0),r(g,null,S(d.playlists,l=>(n(),r("option",{key:l},v(l),1))),128))],512),[[N,d.selectedPlaylist]]),J,d.editSong?(n(),r("div",q,[z,p(y,{ref:"findSources",src:t.dSource,title:i.title,artist:t.artist},{default:_(()=>[e("div",G,[a(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=l=>t.dSource=l),ref:"source"},null,512),[[h,t.dSource]]),e("span",{class:"material-icons-round more",ref:"sourceMore",onClick:s[3]||(s[3]=(...l)=>t.opencontextmenu&&t.opencontextmenu(...l))},"more_vert",512)])]),_:1},8,["src","title","artist"]),K,e("div",Q,[a(e("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>t.dTitle=l),type:"text"},null,512),[[h,t.dTitle]])]),R,e("div",W,[a(e("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>t.dAlbum=l),type:"text",ref:"album"},null,512),[[h,t.dAlbum]])]),X,e("div",Y,[a(e("input",{"onUpdate:modelValue":s[6]||(s[6]=l=>t.dArtist=l),type:"text"},null,512),[[h,t.dArtist]])]),Z,e("div",x,[a(e("input",{type:"text",class:"addSong cover","onUpdate:modelValue":s[7]||(s[7]=l=>t.dCover=l),ref:"cover"},null,512),[[h,t.dCover]]),e("img",{onClick:s[8]||(s[8]=(...l)=>o.openInNewTab&&o.openInNewTab(...l)),class:"addSong cover",src:t.dCover?t.dCover:"/assets/img/music_placeholder.png"},null,8,$)]),e("div",tt,[e("button",{onClick:s[9]||(s[9]=(...l)=>o.add&&o.add(...l)),class:"negative"},"Add")])])):(n(),r("div",et,[a((n(),r("div",{class:"padding-20 playlisteditor",onClick:s[11]||(s[11]=(...l)=>t.editPlaylist&&t.editPlaylist(...l))},[e("img",{class:"cover",src:i.cover},null,8,st),e("div",lt,[e("div",it,[p(m,null,{default:_(()=>[F("Playlist")]),_:1}),e("span",{class:"material-icons-round share",onClick:s[10]||(s[10]=(...l)=>o.share&&o.share(...l))},"share")]),e("h1",null,v(i.title),1),e("h5",{innerHTML:i.description},null,8,ot)])])),[[A,t.headerVisibilityChanged]]),nt,p(P),dt,(n(!0),r(g,null,S(d.playlist,(l,f)=>(n(),w(C,{onAdd:o.add,key:f,added:l.added,index:f,cover:l.cover,artist:l.artists.join(", "),title:l.title,source:l.src,album:l.album,preview:l.preview},null,8,["onAdd","added","index","cover","artist","title","source","album","preview"]))),128))])),e("div",rt,[e("button",{onClick:s[12]||(s[12]=(...l)=>o.addAll&&o.addAll(...l)),class:"negative"},"Add All")])])]),_:1},8,["onClick","modelValue"])])}const ct=b(B,[["render",at]]);const ut={components:{AddPlaylistToPlaylist:ct},name:"PlaylistItem",methods:{redirect(){this.spotify?this.$refs.import.showModal=!0:this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},ht={class:"wrapper drop-shadow-md"},pt=["src"],yt=["innerHTML"];function mt(t,s,i,u,d,o){const y=c("add-playlist-to-playlist");return n(),r("div",ht,[i.spotify?(n(),w(y,{key:0,cover:i.cover,href:i.href,title:i.title,description:i.description,id:i.id,ref:"import"},null,8,["cover","href","title","description","id"])):U("",!0),e("div",{class:"item",onClick:s[0]||(s[0]=(...m)=>o.redirect&&o.redirect(...m))},[e("img",{src:i.cover},null,8,pt),e("h4",null,v(i.title),1),e("p",{class:"hideIfMobile",innerHTML:i.description},null,8,yt)])])}const St=b(ut,[["render",mt],["__scopeId","data-v-0946cc54"]]);export{St as P};
