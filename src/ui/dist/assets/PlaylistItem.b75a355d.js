import{m as P,j as S,q as u,o as p,f as _,w as b,g as m,u as k,G as C,a as i,_ as T,i as A,e as j,c as N,d as B,t as D}from"./index.a83ce700.js";import{F as M,T as O,a as q,c as x}from"./song.0328dbbf.js";import{T as V,P as E}from"./TrackInfo.52d373b8.js";import{p as F}from"./playerInPicture.37a9ab56.js";const H=i("br",null,null,-1),L=P({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(n,{expose:r}){const e=n,d=S(),c=u([{name:"playlist",type:"dropdown",required:!0,value:null,options:d.playlistsAsDropdown}]),o=u(null),l=u(null),s=u([]),h=async()=>{if(o.value.load(),s.value.length==0){const a=await fetch(`/api/spotify/playlists/${e.playlist.id}`);s.value=await a.json()}o.value.show()},w=()=>{F("Spotify Playlist",e.playlist.name,e.playlist.href)},f=async a=>{if(a==="new"){const t=await x(e.playlist.name,e.playlist.description,e.playlist.cover);return c.value[0].options=d.playlistsAsDropdown,c.value[0].value=t,t}return Number(a)},y=async(a,t=null)=>{s.value[a].added||(t!=null||(t=l.value.toObject().playlist),t=await f(t),await q(t!=null?t:l.value.toObject().playlist,s.value[a]),s.value[a].added=!0)},g=async()=>{let a=l.value.toObject().playlist;a=await f(a),s.value.forEach((t,v)=>{y(v,a)})};return r({show:h}),(a,t)=>(p(),_(O,{ref_key:"modal",ref:o,name:"Import Playlist",submitName:"Add All",onSubmit:g,onClose:t[0]||(t[0]=v=>a.$emit("close"))},{default:b(()=>[m(V,{title:n.playlist.name,cover:n.playlist.cover,icons:[{name:"share",onClick:()=>k(C)(n.playlist.href)},{name:"play_arrow",onClick:w}]},null,8,["title","cover","icons"]),m(M,{ref_key:"form",ref:l,options:c.value},null,8,["options"]),H,m(E,{songs:s.value,onAdd:y},null,8,["songs"])]),_:1},512))}});const G={components:{AddPlaylistToPlaylist:L},name:"PlaylistItem",methods:{parseCover:A,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},W={class:"wrapper drop-shadow-md"},z=["src"],J=["innerHTML"];function K(n,r,e,d,c,o){const l=j("add-playlist-to-playlist");return p(),N("div",W,[e.spotify?(p(),_(l,{key:0,playlist:{cover:e.cover,name:e.title,description:e.description,id:e.id,href:e.href},ref:"import"},null,8,["playlist"])):B("",!0),i("div",{class:"item",onClick:r[0]||(r[0]=(...s)=>o.redirect&&o.redirect(...s))},[i("img",{src:o.parseCover(e.cover)},null,8,z),i("h4",null,D(e.title),1),i("p",{class:"hideIfMobile",innerHTML:e.description},null,8,J)])])}const Y=T(G,[["render",K],["__scopeId","data-v-f6c144a8"]]);export{Y as P};
