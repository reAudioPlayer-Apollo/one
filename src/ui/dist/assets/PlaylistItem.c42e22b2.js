import{m as g,j as C,n as c,o as y,f as w,w as S,g as u,u as k,G as T,a as d,_ as A,h as j,p as N,e as h,c as B,d as D,t as M}from"./index.bb9dc178.js";import{F as O,T as x,a as V,c as q}from"./song.bd0028ce.js";import{T as E,P as F}from"./TrackInfo.c60b5960.js";import{p as H}from"./playerInPicture.37a9ab56.js";const L=d("br",null,null,-1),G=g({__name:"ImportSpotifyPlaylist",props:{playlist:{type:Object,required:!0}},setup(n,{expose:i}){const e=n,p=C(),r=c([{name:"playlist",type:"dropdown",required:!0,value:null,options:p.playlistsAsDropdown}]),o=c(null),l=c(null),s=c([]),m=async()=>{if(o.value.load(),s.value.length==0){const a=await fetch(`/api/spotify/playlists/${e.playlist.id}`);s.value=await a.json()}o.value.show()},P=()=>{H("Spotify Playlist",e.playlist.name,e.playlist.href)},f=async a=>{if(a==="new"){const t=await q(e.playlist.name,e.playlist.description,e.playlist.cover);return r.value[0].options=p.playlistsAsDropdown,r.value[0].value=t,t}return Number(a)},v=async(a,t=null)=>{s.value[a].added||(t!=null||(t=l.value.toObject().playlist),t=await f(t),await V(t!=null?t:l.value.toObject().playlist,s.value[a]),s.value[a].added=!0)},b=async()=>{let a=l.value.toObject().playlist;a=await f(a),s.value.forEach((t,_)=>{v(_,a)})};return i({show:m}),(a,t)=>(y(),w(x,{ref_key:"modal",ref:o,name:"Import Playlist",submitName:"Add All",onSubmit:b,onClose:t[0]||(t[0]=_=>a.$emit("close"))},{default:S(()=>[u(E,{title:n.playlist.name,cover:n.playlist.cover,icons:[{name:"share",onClick:()=>k(T)(n.playlist.href)},{name:"play_arrow",onClick:P}]},null,8,["title","cover","icons"]),u(O,{ref_key:"form",ref:l,options:r.value},null,8,["options"]),L,u(F,{songs:s.value,onAdd:v},null,8,["songs"])]),_:1},512))}});const W={components:{Cover:j,AddPlaylistToPlaylist:G},name:"PlaylistItem",methods:{parseCover:N,redirect(){this.spotify?this.$refs.import.show():this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},$={class:"wrapper drop-shadow-md"},z=["innerHTML"];function J(n,i,e,p,r,o){const l=h("add-playlist-to-playlist"),s=h("Cover");return y(),B("div",$,[e.spotify?(y(),w(l,{key:0,playlist:{cover:e.cover,name:e.title,description:e.description,id:e.id,href:e.href},ref:"import"},null,8,["playlist"])):D("",!0),d("div",{class:"item",onClick:i[0]||(i[0]=(...m)=>o.redirect&&o.redirect(...m))},[u(s,{src:o.parseCover(e.cover),type:"playlist"},null,8,["src"]),d("h4",null,M(e.title),1),d("p",{class:"hideIfMobile",innerHTML:e.description},null,8,z)])])}const X=A(W,[["render",J],["__scopeId","data-v-f4be4e0b"]]);export{X as P};
