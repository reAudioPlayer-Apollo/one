import{i as K,q as d,s as L,G as b,D as R,E as P,o as u,c as i,g as _,L as Q,d as c,a as s,f as q,K as A,h as j,t as f,w as J,N as y,b as z,F as B,j as G,M as H,O as U,C as W,Q as X,m as Z,n as ee,_ as te}from"./index-2c0fdb7d.js";import{C as se}from"./CollectionHeader-9983ee18.js";import{p as le}from"./playerInPicture-af203fdf.js";const $=g=>(Z("data-v-ec9cef16"),g=g(),ee(),g),ae={key:0,class:"fill-page"},oe={class:"p-4 overflow-hidden h-full"},re={class:"releases w-full"},ue={class:"current"},ne={key:0,class:"w-max flex flex-col gap-4"},ie={class:"flex justify-between w-full items-center"},ce={class:"flex gap-4 items-center"},de={class:"info"},ve={key:0},pe={key:1,class:"m-0"},me={key:2,class:"m-0 text-muted"},_e={class:"actions"},fe={key:1,class:"h-96 flex flex-col justify-center"},he=$(()=>s("span",{class:"italic text-sm text-muted"}," Nothing to preview ",-1)),xe=[he],ye={class:"flex items-center gap-4 w-max"},ge={key:0,class:"flex justify-end mb-2"},ke=$(()=>s("span",{class:"material-symbols-rounded"}," done_all ",-1)),we={class:"entries overflow-y-auto flex flex-col gap-2"},Ce={class:"entry"},be={class:"info overflow-hidden"},Re={class:"m-0 overflow-hidden"},$e={class:"m-0 overflow-hidden text-sm text-muted"},De={class:"text-sm m-0 text-muted"},Se=["onClick"],Ee=["onClick"],Ne=["onClick"],Ie={key:1,class:"flex flex-col items-center"},Me=$(()=>s("span",{class:"italic text-sm text-muted"}," No releases in this queue ",-1)),qe=[Me],F="reap.releases.seen",O="reap.releases.remember",je=K({__name:"Releases",setup(g){const k=d(!0),o=d("unseen"),T=L();b(o,t=>{const e={queue:t};T.replace({query:e})});const v=R(()=>{switch(o.value){case"unseen":return h.value.filter(t=>!p.value.includes(t.url));case"out-today":return V.value;case"watching":return n.value;case"all":return h.value;case"seen":return p.value.map(t=>h.value.find(e=>e.url==t))}}),a=R(()=>v.value[0]),D=t=>{le(t.artist,t.title,t.url)},r=d(null),S=d(null),w=new Date,h=d([]),E=t=>{r.value=t,X(()=>{var e;(e=S.value)==null||e.show()})},V=R(()=>h.value.filter(t=>{const e=new Date(t.releaseDate);return w.getMonth()==e.getMonth()&&w.getDate()==e.getDate()&&w.getFullYear()==e.getFullYear()})),N=t=>{n.value.find(e=>e.url==t.url)||n.value.push(t)},I=t=>{n.value=n.value.filter(e=>e.url!=t.url)},C=t=>{var x;let e=!1;t.url===((x=a.value)==null?void 0:x.url)&&(e=!0),p.value.includes(t.url)||p.value.push(t.url),e&&D(a.value)},p=d([]),n=d([]);return P(async()=>{var e;k.value=!0;const t=await fetch("/api/releases");h.value=await t.json(),k.value=!1,p.value=((e=localStorage.getItem(F))==null?void 0:e.split(","))??[],n.value=JSON.parse(localStorage.getItem(O)??"[]")}),b(p,t=>{localStorage.setItem(F,t.join(","))},{deep:!0}),b(n,t=>{localStorage.setItem(O,JSON.stringify(t))},{deep:!0}),(t,e)=>{var x,M;return u(),i(B,null,[k.value?(u(),i("div",ae,[_(Q)])):c("",!0),s("div",oe,[r.value?(u(),q(A,{key:0,id:(x=r.value.url)==null?void 0:x.replace("https://open.spotify.com/album/",""),ref_key:"addReleaseRef",ref:S,album:{id:(M=r.value.url)==null?void 0:M.replace("https://open.spotify.com/album/",""),title:r.value.title,artist:r.value.artists.join(", "),cover:r.value.cover,href:r.value.url,releaseDate:r.value.releaseDate},artist:r.value.artist,cover:r.value.cover,href:r.value.url,title:r.value.title},null,8,["id","album","artist","cover","href","title"])):c("",!0),_(se),s("div",re,[s("div",ue,[a.value?(u(),i("div",ne,[a.value?(u(),q(j,{key:0,class:"rounded-3xl",src:a.value.cover},null,8,["src"])):c("",!0),s("div",ie,[s("div",ce,[s("span",{class:"preview material-symbols-rounded text-3xl cursor-pointer",onClick:e[0]||(e[0]=l=>D(a.value))}," play_circle "),s("div",de,[a.value?(u(),i("h3",ve,f(a.value.title),1)):c("",!0),a.value?(u(),i("p",pe,f(a.value.artist),1)):c("",!0),a.value?(u(),i("p",me,f(a.value.releaseDate),1)):c("",!0)])]),s("div",_e,[s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:e[1]||(e[1]=l=>E(a.value))}," add "),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:e[2]||(e[2]=l=>n.value.find(m=>m.url===a.value.url)?I(a.value):N(a.value))},f(n.value.find(l=>l.url===a.value.url)?"playlist_remove":"push_pin"),1),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:e[3]||(e[3]=l=>C(a.value))}," done_all ")])])])):(u(),i("div",fe,xe))]),_(W,{class:"queue w-full p-2 h-full flex flex-col gap-2 relative"},{default:J(()=>[s("div",ye,[s("h5",{class:y(["cursor-pointer",{selected:o.value=="unseen"}]),onClick:e[4]||(e[4]=l=>o.value="unseen")}," Unseen ",2),s("h5",{class:y(["cursor-pointer",{selected:o.value=="out-today"}]),onClick:e[5]||(e[5]=l=>o.value="out-today")}," Out Today ",2),s("h5",{class:y(["cursor-pointer",{selected:o.value=="watching"}]),onClick:e[6]||(e[6]=l=>o.value="watching")}," Watching ",2),s("h5",{class:y(["cursor-pointer",{selected:o.value=="seen"}]),onClick:e[7]||(e[7]=l=>o.value="seen")}," Seen ",2),s("h5",{class:y(["cursor-pointer",{selected:o.value=="all"}]),onClick:e[8]||(e[8]=l=>o.value="all")}," All ",2)]),o.value==="unseen"&&v.value.length?(u(),i("div",ge,[s("span",{class:"cursor-pointer text-sm text-muted hover:text-primary flex items-center gap-2",onClick:e[9]||(e[9]=l=>v.value.forEach(C))},[z(" Mark all as seen "),ke])])):c("",!0),s("div",we,[v.value.length?(u(!0),i(B,{key:0},G(v.value,l=>(u(),i("div",Ce,[_(j,{class:"rounded-xl",src:l.cover},null,8,["src"]),s("div",be,[s("p",Re,[_(H,{text:l.title},null,8,["text"])]),s("p",$e,[_(U,{artist:l.artist},null,8,["artist"])])]),s("p",De,f(l.releaseDate),1),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:m=>C(l)}," done_all ",8,Se),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:m=>n.value.find(Y=>Y.url===l.url)?I(l):N(l)},f(n.value.find(m=>m.url===l.url)?"playlist_remove":"push_pin"),9,Ee),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:m=>E(l)}," add ",8,Ne)]))),256)):c("",!0)]),v.value.length?c("",!0):(u(),i("div",Ie,qe))]),_:1})])])],64)}}});const Te=te(je,[["__scopeId","data-v-ec9cef16"]]);export{Te as default};
