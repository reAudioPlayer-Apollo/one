import{A as C}from"./ArtistItem-829c015f.js";import{I as x}from"./ReleaseItem-28e1fb55.js";import{_ as q}from"./ExternalEntry-40e265ed.js";import{_ as k,h as T,e as h,o as e,c as o,g as m,a as n,t as p,d,r as B,O as D,F as f,f as c,w as v,i as g,k as L,l as N}from"./index-d1ada720.js";import"./Form-ad7c154c.js";import"./IconButton-bb489a5c.js";import"./Dropdown-c0e9af92.js";import"./Playlist-b64c1691.js";import"./PlaylistHeader-a2a7c36e.js";import"./song-1a7db152.js";import"./ImportSpotifyAlbum.vue_vue_type_script_setup_true_lang-0144d4d7.js";const F={components:{Cover:T,AddSongToPlaylist:q},name:"SearchItem",methods:{redirect(){this.$refs.addAlbum.show()}},props:{cover:String,title:String,artist:String,releaseDate:String,href:String,preview:String}},O={class:"wrapper drop-shadow-md"},V={key:0,class:"note"};function $(r,a,s,S,i,l){const u=h("add-song-to-playlist"),y=h("Cover");return e(),o("div",O,[m(u,{song:{cover:s.cover,artist:s.artist,title:s.title,preview:s.preview,href:s.href},ref:"addAlbum"},null,8,["song"]),n("div",{class:"item",onClick:a[0]||(a[0]=(..._)=>l.redirect&&l.redirect(..._))},[m(y,{src:s.cover},null,8,["src"]),n("h4",null,p(s.title),1),n("p",null,p(s.artist),1),s.releaseDate?(e(),o("p",V,"Released on "+p(s.releaseDate),1)):d("",!0)])])}const E=k(F,[["render",$],["__scopeId","data-v-49217ea9"]]);const P={name:"Shelf",props:{heading:String,href:String},methods:{redirect(){this.href&&this.$router.push(this.href)}}},j={class:"shelf"},J={key:0,class:"header"},R={class:"items"};function Y(r,a,s,S,i,l){return e(),o("div",j,[s.heading?(e(),o("div",J,[n("h2",null,p(s.heading),1),n("h5",{onClick:a[0]||(a[0]=(...u)=>l.redirect&&l.redirect(...u))},"See All")])):d("",!0),n("div",R,[B(r.$slots,"default",{},void 0,!0)])])}const z=k(P,[["render",Y],["__scopeId","data-v-a60bb56d"]]);const G={name:"TrackItem",components:{Cover:T},methods:{redirect(){console.log("redirect"),this.$router.push(this.href)}},props:{cover:String,title:String,artist:String,href:String}},H={class:"wrapper drop-shadow-md"};function K(r,a,s,S,i,l){const u=h("Cover");return e(),o("div",H,[n("div",{class:"item",onClick:a[0]||(a[0]=(...y)=>l.redirect&&l.redirect(...y))},[m(u,{src:s.cover},null,8,["src"]),n("h4",null,p(s.title),1),n("p",null,p(s.artist),1)])])}const M=k(G,[["render",K],["__scopeId","data-v-d03d3ef1"]]);const Q={name:"Search",components:{Shelf:z,Item:x,SearchItem:E,ArtistItem:C,TrackItem:M,Loader:D},data(){return{query:"",spotifyTracks:[],spotifyArtists:[],tracks:[],artists:[],youtubeTracks:[],loading:!1,error:null}},methods:{search(){this.query=this.$route.params.query,this.query&&(this.loading=!0,this.error=null,fetch("/api/search",{method:"POST",body:JSON.stringify({query:this.query,scope:["local","spotify"]})}).then(r=>r.json()).then(r=>{this.spotifyTracks.length=0,this.spotifyArtists.length=0,this.tracks.length=0,this.artists.length=0,this.youtubeTracks.length=0,this.spotifyTracks.push(...r.spotifyTracks||[]),this.spotifyArtists.push(...r.spotifyArtists||[]),this.tracks.push(...r.tracks||[]),this.artists.push(...r.artists||[]),this.youtubeTracks.push(...r.youtubeTracks||[]),this.loading=!1}).catch(r=>{this.error=r,this.loading=!1}))},enterText(r){r.key==="Enter"&&this.$router.push("/search/"+this.query)}},watch:{$route(){this.search()}},mounted(){this.search()}},U=r=>(L("data-v-978a9a83"),r=r(),N(),r),W={class:"search"},X={key:0,class:"fill-page"},Z={key:1,class:"fill-page"},tt=U(()=>n("h1",null,"Something went wrong",-1));function et(r,a,s,S,i,l){const u=h("Loader"),y=h("TrackItem"),_=h("Shelf"),I=h("search-item"),w=h("Item"),b=h("artist-item");return e(),o("div",W,[i.loading?(e(),o("div",X,[m(u)])):i.error?(e(),o("div",Z,[tt,n("p",null,p(i.error),1)])):(e(),o(f,{key:2},[i.tracks.length?(e(),c(_,{key:0,heading:"Songs"},{default:v(()=>[(e(!0),o(f,null,g(i.tracks,t=>(e(),c(y,{key:t.url,artist:t.artists.join(", "),cover:t.cover,href:t.url,title:t.title},null,8,["artist","cover","href","title"]))),128))]),_:1})):d("",!0),i.spotifyTracks.length?(e(),c(_,{key:1,heading:"Songs (Spotify)"},{default:v(()=>[(e(!0),o(f,null,g(i.spotifyTracks,t=>(e(),c(I,{key:t.url,artist:t.artists.join(", "),cover:t.cover,href:t.url,preview:t.preview,title:t.title},null,8,["artist","cover","href","preview","title"]))),128))]),_:1})):d("",!0),i.youtubeTracks.length?(e(),c(_,{key:2,heading:"Songs (Youtube)"},{default:v(()=>[(e(!0),o(f,null,g(i.youtubeTracks,t=>(e(),c(I,{key:t.url,artist:t.artists.join(", "),cover:t.cover,href:t.url,title:t.title},null,8,["artist","cover","href","title"]))),128))]),_:1})):d("",!0),i.artists.length?(e(),c(_,{key:3,heading:"Artists"},{default:v(()=>[(e(!0),o(f,null,g(i.artists,t=>(e(),c(w,{key:t.url,artist:t.artists.join(", "),cover:t.cover,href:t.url,title:t.title},null,8,["artist","cover","href","title"]))),128))]),_:1})):d("",!0),i.spotifyArtists.length?(e(),c(_,{key:4,heading:"Artists (Spotify)"},{default:v(()=>[(e(!0),o(f,null,g(i.spotifyArtists,(t,A)=>(e(),c(b,{id:t.id,key:A,cover:t.cover,description:t.description,name:t.name,showFollowButton:!0},null,8,["id","cover","description","name"]))),128))]),_:1})):d("",!0)],64))])}const dt=k(Q,[["render",et],["__scopeId","data-v-978a9a83"]]);export{dt as default};
