import{A as C}from"./ArtistItem.c59751c6.js";import{I as x}from"./ReleaseItem.792eb766.js";import{F as q,T as $,a as N}from"./song.22c0d5cf.js";import{T as B}from"./TrackInfo.f16b2cd4.js";import{B as O,i as D,C as b,o as s,f as c,w as y,g as w,u as F,G as L,_ as T,e as f,c as n,a as l,t as g,d as p,r as j,L as E,F as m,h as k}from"./index.6f3ae9d0.js";import"./AlbumHeader.70d1b95c.js";import"./MiniPlayer.b80f9ee9.js";const P=O({__name:"ImportSpotifySong",props:{song:{type:Object,required:!0}},setup(r,{expose:a}){const e=r,v=D(),o=[{name:"playlist",type:"dropdown",required:!0,value:null,options:v.playlists.map(d=>({label:d.name,value:d.id}))}],i=b(null),u=b(null),h=b(null),_=async()=>{if(i.value.load(),!h.value){const d=await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:e.song.href})});h.value=await d.json()}i.value.show()},S=()=>{const d=new CustomEvent("player.play",{detail:{artist:e.song.artist,title:e.song.title,source:e.song.href}});window.dispatchEvent(d)},I=async()=>{e.song.added||(await N(u.value.toObject().playlist,h.value),e.song.added=!0)};return a({show:_}),(d,t)=>(s(),c($,{ref_key:"modal",ref:i,name:"Import Song",submitName:"Add",onSubmit:I,onClose:t[0]||(t[0]=A=>d.$emit("close"))},{default:y(()=>[w(B,{title:r.song.title,cover:r.song.cover,icons:[{name:"share",onClick:()=>F(L)(r.song.href)},{name:"play_arrow",onClick:S}]},null,8,["title","cover","icons"]),w(q,{ref_key:"form",ref:u,options:o},null,512)]),_:1},512))}});const V={components:{AddSongToPlaylist:P},name:"SearchItem",methods:{redirect(){this.$refs.addAlbum.show()}},props:{cover:String,title:String,artist:String,releaseDate:String,href:String,preview:String}},J={class:"wrapper drop-shadow-md"},G=["src"],R={key:0,class:"note"};function Y(r,a,e,v,o,i){const u=f("add-song-to-playlist");return s(),n("div",J,[w(u,{song:{cover:e.cover,artist:e.artist,title:e.title,preview:e.preview,href:e.href},ref:"addAlbum"},null,8,["song"]),l("div",{class:"item",onClick:a[0]||(a[0]=(...h)=>i.redirect&&i.redirect(...h))},[l("img",{src:e.cover},null,8,G),l("h4",null,g(e.title),1),l("p",null,g(e.artist),1),e.releaseDate?(s(),n("p",R,"Released on "+g(e.releaseDate),1)):p("",!0)])])}const z=T(V,[["render",Y],["__scopeId","data-v-5e8b8cdc"]]);const H={name:"Shelf",props:{heading:String,href:String},methods:{redirect(){!this.href||this.$router.push(this.href)}}},K={class:"shelf"},M={key:0,class:"header"},Q={class:"items"};function U(r,a,e,v,o,i){return s(),n("div",K,[e.heading?(s(),n("div",M,[l("h2",null,g(e.heading),1),l("h5",{onClick:a[0]||(a[0]=(...u)=>i.redirect&&i.redirect(...u))},"See All")])):p("",!0),l("div",Q,[j(r.$slots,"default",{},void 0,!0)])])}const W=T(H,[["render",U],["__scopeId","data-v-a88c43f2"]]);const X={name:"TrackItem",methods:{redirect(){console.log("redirect"),this.$router.push(this.href)}},props:{cover:String,title:String,artist:String,href:String}},Z={class:"wrapper drop-shadow-md"},tt=["src"];function et(r,a,e,v,o,i){return s(),n("div",Z,[l("div",{class:"item",onClick:a[0]||(a[0]=(...u)=>i.redirect&&i.redirect(...u))},[l("img",{src:e.cover},null,8,tt),l("h4",null,g(e.title),1),l("p",null,g(e.artist),1)])])}const st=T(X,[["render",et],["__scopeId","data-v-28d2ff3e"]]);const rt={name:"Search",components:{Shelf:W,Item:x,SearchItem:z,ArtistItem:C,TrackItem:st,Loader:E},data(){return{query:"",spotifyTracks:[],spotifyArtists:[],tracks:[],artists:[],youtubeTracks:[],loading:!1}},methods:{search(){this.query=this.$route.params.query,this.query&&(this.loading=!0,fetch("/api/search",{method:"POST",body:JSON.stringify({query:this.query})}).then(r=>r.json()).then(r=>{this.spotifyTracks.length=0,this.spotifyArtists.length=0,this.tracks.length=0,this.artists.length=0,this.youtubeTracks.length=0,this.spotifyTracks.push(...r.spotifyTracks||[]),this.spotifyArtists.push(...r.spotifyArtists||[]),this.tracks.push(...r.tracks||[]),this.artists.push(...r.artists||[]),this.youtubeTracks.push(...r.youtubeTracks||[]),this.loading=!1}))},enterText(r){r.key==="Enter"&&this.$router.push("/search/"+this.query)}},watch:{$route(){this.search()}},mounted(){this.search()}},ot={class:"search"},it={key:0,class:"fillPage"};function nt(r,a,e,v,o,i){const u=f("Loader"),h=f("TrackItem"),_=f("Shelf"),S=f("search-item"),I=f("Item"),d=f("artist-item");return s(),n("div",ot,[o.loading?(s(),n("div",it,[w(u)])):(s(),n(m,{key:1},[o.tracks.length?(s(),c(_,{key:0,heading:"Songs"},{default:y(()=>[(s(!0),n(m,null,k(o.tracks,t=>(s(),c(h,{key:t.url,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["cover","href","artist","title"]))),128))]),_:1})):p("",!0),o.spotifyTracks.length?(s(),c(_,{key:1,heading:"Songs (Spotify)"},{default:y(()=>[(s(!0),n(m,null,k(o.spotifyTracks,t=>(s(),c(S,{key:t.url,preview:t.preview,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["preview","cover","href","artist","title"]))),128))]),_:1})):p("",!0),o.youtubeTracks.length?(s(),c(_,{key:2,heading:"Songs (Youtube)"},{default:y(()=>[(s(!0),n(m,null,k(o.youtubeTracks,t=>(s(),c(S,{key:t.url,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["cover","href","artist","title"]))),128))]),_:1})):p("",!0),o.artists.length?(s(),c(_,{key:3,heading:"Artists"},{default:y(()=>[(s(!0),n(m,null,k(o.artists,t=>(s(),c(I,{key:t.url,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["cover","href","artist","title"]))),128))]),_:1})):p("",!0),o.spotifyArtists.length?(s(),c(_,{key:4,heading:"Artists (Spotify)"},{default:y(()=>[(s(!0),n(m,null,k(o.spotifyArtists,(t,A)=>(s(),c(d,{key:A,cover:t.cover,description:t.description,name:t.name,id:t.id,showFollowButton:!0},null,8,["cover","description","name","id"]))),128))]),_:1})):p("",!0)],64))])}const ft=T(rt,[["render",nt],["__scopeId","data-v-506e3f23"]]);export{ft as default};
