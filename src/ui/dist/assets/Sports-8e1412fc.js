import{F as D}from"./FullShelf-3b9ac31e.js";import{_ as k,o as i,c as m,a as o,t as _,I as A,T as b,g as C,F as v,i as w,f as S,w as x,d as F,e as y,k as N,l as V}from"./index-88f8bd28.js";const B={name:"FootballItem",methods:{redirect(){window.open(this.oref)},remove(e){e.stopPropagation(),this.$emit("remove")}},props:{result:String,date:String,competition:String,href:String,oref:String,team1:String,team2:String,progress:String}},O={class:"itemBig"},j={class:"wrapper topalign"},H={class:"wrapper"},L=["innerHTML"],J=["innerHTML"],P=["innerHTML"],U={class:"wrapper bottomalign"},W={class:"small"};function $(e,s,t,c,n,r){var h;return i(),m("div",O,[o("div",{class:"item",onClick:s[1]||(s[1]=(...p)=>r.redirect&&r.redirect(...p))},[o("div",j,[o("p",null,_(t.competition),1),o("p",{class:A([{accent:(h=t.progress)==null?void 0:h.includes("'")},"right progress"])},_(t.progress),3)]),o("div",H,[o("p",{class:"team",innerHTML:t.team1},null,8,L),o("h4",{class:"result",innerHTML:t.result},null,8,J),o("p",{class:"team",innerHTML:t.team2},null,8,P)]),o("div",U,[o("p",W,_(t.date)+", "+_(t.href),1),o("span",{class:"deleteIcon small material-icons-round",onClick:s[0]||(s[0]=(...p)=>r.remove&&r.remove(...p))},"clear")])])])}const K=k(B,[["render",$],["__scopeId","data-v-f2b16424"]]);const R={components:{TextInputWithIcon:b,FullShelf:D,FootballItem:K},name:"Sports",data(){return{sports:[],watchMatches:[],sourceToAdd:"",supportedSources:["https://onefootball.com/en/team/","https://onefootball.com/en/match/","https://onefootball.com/en/competition/","https://www.cev.eu/match-centres/","https://championsleague.cev.eu/en/match-centres/","https://www.cev.eu/calendar/","https://cev-nex.tk/#/match/","https://cevnex.tk/#/match/"]}},mounted(){this.watchMatches=JSON.parse(window.localStorage.getItem("sports.watchMatches"))||[],this.updateMatches()},computed:{volleyMatches(){return this.watchMatches.filter(e=>e.includes("cev")).map(e=>{let s=e;return e.includes("nex.tk")&&(s=e.split("/match/")[1]),{src:s,ref:e}})},notVolleyMatches(){return this.watchMatches.filter(e=>!e.includes("cev"))}},methods:{removeSource(e,s,t){this.watchMatches.splice(this.watchMatches.indexOf(e),1),this.sports[s].items.splice(t,1),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches))},removeSourceD(e){this.watchMatches.splice(this.watchMatches.indexOf(e),1),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches))},tryAddSource(){for(const e of this.supportedSources)if(this.sourceToAdd.startsWith(e)){this.addSource();return}alert("unsupported source")},addSource(){this.watchMatches.push(this.sourceToAdd),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches)),this.sourceToAdd=""},updateMatches(){if(!(this.$route.path=="/sports"||this.$route.path=="/sports/")){console.log("not update",this.$route.path);return}fetch("/api/sports",{method:"POST",body:JSON.stringify({urls:this.notVolleyMatches})}).then(e=>e.json()).then(e=>{this.sports=[];for(const s of e){const t=this.sports.findIndex(c=>c.sport==s.sport);t>=0?this.sports[t].items.push(s):this.sports.push({sport:s.sport,icon:s.sportIcon,items:[s]})}for(const s of this.sports)s.items.sort((t,c)=>{if(t.progress=t.progress.replace("Half time","45'"),c.progress=c.progress.replace("Half time","45'"),(t.progress.includes("Pens")||t.progress.includes("N/A"))&&(t.progress="Full time"),(c.progress.includes("Pens")||c.progress.includes("N/A"))&&(c.progress="Full time"),t.progress.includes("'")&&!c.progress.includes("'"))return-1;if(!t.progress.includes("'")&&c.progress.includes("'"))return 1;if(t.progress.includes("'")&&c.progress.includes("'")){const f=Number(t.progress.replace("'","").replace("+","")),I=Number(c.progress.replace("'","").replace("+",""));return f<I?-1:f==I?0:1}let n=t.date.split(" ")[0],r=c.date.split(" ")[0],h=t.progress.replace("'","").replace("Full time","24:00").replace(" ",""),p=c.progress.replace("'","").replace("Full time","24:00").replace(" ",""),d=new Date,l=new Date;l.setUTCDate(d.getUTCDate()+1);let u=new Date;u.setUTCDate(d.getUTCDate()-1);const a=f=>f.toISOString().split("T")[0];n=n.replace("Today",a(d)).split("/").reverse().join("-"),n=n.replace("Tomorrow",a(l)).split("/").reverse().join("-"),n=n.replace("Yesterday",a(u)).split("/").reverse().join("-"),r=r.replace("Today",a(d)).split("/").reverse().join("-"),r=r.replace("Tomorrow",a(l)).split("/").reverse().join("-"),r=r.replace("Yesterday",a(u)).split("/").reverse().join("-");let g=new Date(`${n}T${h}`.replace(" ","")),M=new Date(`${r}T${p}`.replace(" ",""));return g>M?-1:g==M?0:1})}),setTimeout(this.updateMatches,1e3*45)}}},T=e=>(N("data-v-eca27b32"),e=e(),V(),e),Y={class:"news"},z=T(()=>o("div",{class:"padding-20"},[o("h1",null,"Sports")],-1)),E=T(()=>o("hr",null,null,-1)),q={class:"padding-20"},G={class:"small"},Q={class:"addWrapper"},X=T(()=>o("hr",null,null,-1)),Z=["src"],ee=["onClick"];function te(e,s,t,c,n,r){const h=y("TextInputWithIcon"),p=y("football-item"),d=y("full-shelf");return i(),m("div",Y,[z,E,o("div",q,[o("p",G,"Supported urls: "+_(n.supportedSources.join("*, ")),1),o("div",Q,[C(h,{modelValue:n.sourceToAdd,"onUpdate:modelValue":s[0]||(s[0]=l=>n.sourceToAdd=l),icon:"link",onKeyup:e.enterText},null,8,["modelValue","onKeyup"]),o("span",{id:"addToPlaylist",class:"material-icons-outlined",onClick:s[1]||(s[1]=(...l)=>r.tryAddSource&&r.tryAddSource(...l))},"add_circle")]),X,(i(!0),m(v,null,w(n.sports,(l,u)=>(i(),S(d,{key:l.sport,heading:l.sport,icon:l.icon},{default:x(()=>[(i(!0),m(v,null,w(l.items,(a,g)=>(i(),S(p,{key:a.href,competition:a.competition,date:a.date,href:a.href,oref:a.oref,progress:a.progress,result:a.result,team1:a.team1,team2:a.team2,onRemove:()=>r.removeSource(a.sref,u,g)},null,8,["competition","date","href","oref","progress","result","team1","team2","onRemove"]))),128))]),_:2},1032,["heading","icon"]))),128)),r.volleyMatches.length?(i(),S(d,{key:0,heading:"Volleyball",icon:"sports_volleyball"},{default:x(()=>[(i(!0),m(v,null,w(r.volleyMatches,(l,u)=>(i(),m("div",{key:u,class:"wrapIframe"},[o("iframe",{src:`https://cev-nex.tk/#/embed?match=${l.src}`},null,8,Z),o("span",{class:"deleteIcon small material-symbols-rounded",onClick:()=>r.removeSourceD(l.ref)},"clear",8,ee)]))),128))]),_:1})):F("",!0)])])}const re=k(R,[["render",te],["__scopeId","data-v-eca27b32"]]);export{re as default};
