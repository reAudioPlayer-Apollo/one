import{F as C}from"./FullShelf-BRUgNaKT.js";import{_ as k,C as D,f as _,o as p,i as v,w as M,a as r,t as f,K as x,Y as A,N,c as m,g as F,F as S,h as y,d as V}from"./index-B46cfymT.js";const B={name:"FootballItem",components:{Card:D},methods:{redirect(){window.open(this.oref)},remove(s){s.stopPropagation(),this.$emit("remove")}},props:{result:String,date:String,competition:String,href:String,oref:String,team1:String,team2:String,progress:String}},O={class:"wrapper topalign"},j={class:"wrapper"},H=["innerHTML"],L=["innerHTML"],b=["innerHTML"],J={class:"wrapper bottomalign"},P={class:"small"};function U(s,e,t,l,c,o){const h=_("Card");return p(),v(h,{class:"itemBig","with-hover":""},{default:M(()=>{var u;return[r("div",{class:"item",onClick:e[1]||(e[1]=(...i)=>o.redirect&&o.redirect(...i))},[r("div",O,[r("p",null,f(t.competition),1),r("p",{class:x([{accent:(u=t.progress)==null?void 0:u.includes("'")},"right progress"])},f(t.progress),3)]),r("div",j,[r("p",{class:"team",innerHTML:t.team1},null,8,H),r("h4",{class:"result",innerHTML:t.result},null,8,L),r("p",{class:"team",innerHTML:t.team2},null,8,b)]),r("div",J,[r("p",P,f(t.date)+", "+f(t.href),1),r("span",{class:"deleteIcon small material-icons-round",onClick:e[0]||(e[0]=(...i)=>o.remove&&o.remove(...i))},"clear")])])]}),_:1})}const W=k(B,[["render",U],["__scopeId","data-v-51368764"]]),K={components:{TextInputWithIcon:A,FullShelf:C,FootballItem:W},name:"Sports",data(){return{sports:[],watchMatches:[],sourceToAdd:"",supportedSources:["https://onefootball.com/en/team/","https://onefootball.com/en/match/","https://onefootball.com/en/competition/","https://www.cev.eu/match-centres/","https://championsleague.cev.eu/en/match-centres/","https://www.cev.eu/calendar/","https://cev-nex.tk/#/match/","https://cevnex.tk/#/match/"]}},mounted(){this.watchMatches=JSON.parse(window.localStorage.getItem("sports.watchMatches"))||[],this.updateMatches()},computed:{volleyMatches(){return this.watchMatches.filter(s=>s.includes("cev")).map(s=>{let e=s;return s.includes("nex.tk")&&(e=s.split("/match/")[1]),{src:e,ref:s}})},notVolleyMatches(){return this.watchMatches.filter(s=>!s.includes("cev"))}},methods:{removeSource(s,e,t){this.watchMatches.splice(this.watchMatches.indexOf(s),1),this.sports[e].items.splice(t,1),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches))},removeSourceD(s){this.watchMatches.splice(this.watchMatches.indexOf(s),1),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches))},tryAddSource(){for(const s of this.supportedSources)if(this.sourceToAdd.startsWith(s)){this.addSource();return}N.addError("unsupported source")},addSource(){this.watchMatches.push(this.sourceToAdd),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches)),this.sourceToAdd=""},updateMatches(){(this.$route.path=="/sports"||this.$route.path=="/sports/")&&(fetch("/api/sports",{method:"POST",body:JSON.stringify({urls:this.notVolleyMatches})}).then(s=>s.json()).then(s=>{this.sports=[];for(const e of s){const t=this.sports.findIndex(l=>l.sport==e.sport);t>=0?this.sports[t].items.push(e):this.sports.push({sport:e.sport,icon:e.sportIcon,items:[e]})}for(const e of this.sports)e.items.sort((t,l)=>{if(t.progress=t.progress.replace("Half time","45'"),l.progress=l.progress.replace("Half time","45'"),(t.progress.includes("Pens")||t.progress.includes("N/A"))&&(t.progress="Full time"),(l.progress.includes("Pens")||l.progress.includes("N/A"))&&(l.progress="Full time"),t.progress.includes("'")&&!l.progress.includes("'"))return-1;if(!t.progress.includes("'")&&l.progress.includes("'"))return 1;if(t.progress.includes("'")&&l.progress.includes("'")){const w=Number(t.progress.replace("'","").replace("+","")),I=Number(l.progress.replace("'","").replace("+",""));return w<I?-1:w==I?0:1}let c=t.date.split(" ")[0],o=l.date.split(" ")[0],h=t.progress.replace("'","").replace("Full time","24:00").replace(" ",""),u=l.progress.replace("'","").replace("Full time","24:00").replace(" ",""),i=new Date,n=new Date;n.setUTCDate(i.getUTCDate()+1);let d=new Date;d.setUTCDate(i.getUTCDate()-1);const a=w=>w.toISOString().split("T")[0];c=c.replace("Today",a(i)).split("/").reverse().join("-"),c=c.replace("Tomorrow",a(n)).split("/").reverse().join("-"),c=c.replace("Yesterday",a(d)).split("/").reverse().join("-"),o=o.replace("Today",a(i)).split("/").reverse().join("-"),o=o.replace("Tomorrow",a(n)).split("/").reverse().join("-"),o=o.replace("Yesterday",a(d)).split("/").reverse().join("-");let g=new Date(`${c}T${h}`.replace(" ","")),T=new Date(`${o}T${u}`.replace(" ",""));return g>T?-1:g==T?0:1})}),setTimeout(this.updateMatches,1e3*45))}}},Y={class:"news"},E={class:"padding-20"},R={class:"small"},$={class:"addWrapper"},z=["src"],q=["onClick"];function G(s,e,t,l,c,o){const h=_("TextInputWithIcon"),u=_("football-item"),i=_("full-shelf");return p(),m("div",Y,[e[3]||(e[3]=r("div",{class:"padding-20"},[r("h1",null,"Sports")],-1)),e[4]||(e[4]=r("hr",null,null,-1)),r("div",E,[r("p",R," Supported urls: "+f(c.supportedSources.join("*, ")),1),r("div",$,[F(h,{modelValue:c.sourceToAdd,"onUpdate:modelValue":e[0]||(e[0]=n=>c.sourceToAdd=n),icon:"link",onKeyup:s.enterText},null,8,["modelValue","onKeyup"]),r("span",{id:"addToPlaylist",class:"material-icons-outlined",onClick:e[1]||(e[1]=(...n)=>o.tryAddSource&&o.tryAddSource(...n))},"add_circle")]),e[2]||(e[2]=r("hr",null,null,-1)),(p(!0),m(S,null,y(c.sports,(n,d)=>(p(),v(i,{key:n.sport,heading:n.sport,icon:n.icon},{default:M(()=>[(p(!0),m(S,null,y(n.items,(a,g)=>(p(),v(u,{key:a.href,competition:a.competition,date:a.date,href:a.href,oref:a.oref,progress:a.progress,result:a.result,team1:a.team1,team2:a.team2,onRemove:()=>o.removeSource(a.sref,d,g)},null,8,["competition","date","href","oref","progress","result","team1","team2","onRemove"]))),128))]),_:2},1032,["heading","icon"]))),128)),o.volleyMatches.length?(p(),v(i,{key:0,heading:"Volleyball",icon:"sports_volleyball"},{default:M(()=>[(p(!0),m(S,null,y(o.volleyMatches,(n,d)=>(p(),m("div",{key:d,class:"wrapIframe"},[r("iframe",{src:`https://cev-nex.tk/#/embed?match=${n.src}`},null,8,z),r("span",{class:"deleteIcon small material-symbols-rounded",onClick:()=>o.removeSourceD(n.ref)},"clear",8,q)]))),128))]),_:1})):V("",!0)])])}const Z=k(K,[["render",G],["__scopeId","data-v-e7921c74"]]);export{Z as default};
