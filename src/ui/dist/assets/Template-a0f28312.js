import{n as te,B as le,j as se,s as ae,A as $,q as S,D as U,E as oe,G as ie,o as u,c as g,u as l,f as w,H as ne,d as f,a as o,g as m,I as L,J as j,h as re,t as T,w as A,b as q,C as R,T as de,K as ue,N as ce,F as me,l as pe,m as ve,_ as fe}from"./index-65db2c2c.js";import{F as D}from"./FactCard-831b786a.js";import{P as ye}from"./PlaylistEntry-e002ad41.js";import{_ as xe,F as he,E as z,M as E,d as _e}from"./FixedPlaylistHeader-2e42863b.js";import{P as be}from"./PlaylistHeader-9a7963bc.js";const ge=a=>{const{search:r,artist:c,title:y,album:x,order:V,sort:e}=a;return r.length||c.length||y.length||x.length||V!="asc"||e!="index"},we=(a,r)=>{const{search:c,artist:y,title:x,album:V,sort:e}=r;return a.map(n=>{const v=c.length?n.title.toLowerCase().includes(c.toLowerCase())||n.artist.toLowerCase().includes(c.toLowerCase()):!0,p=y.length?y.includes(n.artist):!0,_=x.length?x.includes(n.title):!0,k=V.length?V.includes(n.album):!0;return{...n,show:v&&p&&_&&k,index:a.indexOf(n)}}).sort((n,v)=>{const p=n[e],_=v[e];return p<_?-1:p>_?1:0})},Ve=a=>a.map(r=>({label:r.title,value:r.title})),ke=a=>a.map(r=>({label:r.album,value:r.album})),Pe=a=>{const r=new Set;for(const c of a)for(const y of c.artist.split(", "))r.add(y);return Array.from(r).sort().map(c=>({label:c,value:c}))},F=a=>(pe("data-v-cbd7bc8e"),a=a(),ve(),a),Ce={class:"playlist p-4"},Se={key:1,class:"fill-page"},Ie=F(()=>o("h2",{class:"text-2xl text-center error"},"Playlist not found",-1)),$e=[Ie],Te={key:2,class:"wrap"},Ae={class:"track__data"},Fe={class:"upper relative"},Me={class:"track__info__details flex flex-col justify-end"},Ue={class:"trac__info__details__normal"},De={key:0,class:"flex flex-row items-center gap-2 playlist-type"},Ee={class:"material-symbols-rounded"},Be={class:"flex flew-row items-center"},He={class:"font-black text-5xl ml-4 w-full flex-1"},Ne={class:"text-muted"},Oe={class:"features flex flex-row gap-4 pt-4 pb-2 overflow-x-auto"},Le=F(()=>o("span",{class:"text-muted"},"Add a Song",-1)),je=F(()=>o("span",{class:"text-muted"},"Edit This Playlist",-1)),qe={key:0,class:"filters mt-4"},Re=F(()=>o("hr",{class:"mb-4"},null,-1)),ze={key:1,class:"items"},Ge=te({__name:"Template",props:{id:{type:String,required:!0},coverIcon:{type:String,required:!1}},emits:["rearrange"],setup(a,{emit:r}){var H,N,O;const c=a,y=le(),x=se(),V=ae(),e=$(()=>x.getPlaylistById(c.id)),n=S(((H=e.value)==null?void 0:H.songs)??[]),v=S(((N=e.value)==null?void 0:N.name.trim())??""),p=S(((O=e.value)==null?void 0:O.description.trim())??""),_=S(!0),k=S(null),G=()=>({sort:"index",order:"asc",search:"",title:[],artist:[],album:[]}),i=S(null),B=()=>{i.value={...G()}};B();const J=[{value:"title",label:"Title",icon:"title"},{value:"artist",label:"Artist",icon:"person"},{value:"album",label:"Album",icon:"album"},{value:"duration",label:"Duration",icon:"timer"},{value:"index",label:"Added",icon:"date_range"}],K=$(()=>{let d=0,t=!1;if(!e.value.songs.length)return"";for(const s of e.value.songs){t=t||s.duration<=0;const I=s.duration<=0?3*60:s.duration;d+=I}const b=d,h=Math.floor(b/60),P=Math.floor(h/60),C=t?"about ":"";return P?C+`${P} hr ${h-P*60} min`:h?C+`${h} min ${b-h*60} sec`:C+d+" sec"}),W=d=>{const t=d.moved;t&&r("rearrange",t.oldIndex,t.newIndex)};U([i,e],()=>{e.value&&M()},{deep:!0});const M=()=>{n.value=we(e.value.songs??[],i.value)};M(),U(e,()=>{var d,t;v.value=((d=e.value)==null?void 0:d.name.trim())??"",p.value=((t=e.value)==null?void 0:t.description.trim())??"",M()}),U([v,p],()=>{var t,b;if(v.value===((t=e.value)==null?void 0:t.name)&&p.value===((b=e.value)==null?void 0:b.description))return;const d={...e.value,name:v.value,description:p.value};oe(d),x.fetchPlaylists()});const Q=(d,t)=>{_.value=d},X=$(()=>e.value.type==="classic"),Y=$(()=>["smart"].includes(e.value.type)),Z=$(()=>e.value.type==="classic"),ee=()=>{V.push(`/playlist/${e.value.id}/edit`)};return(d,t)=>{var h,P,C;const b=ie("observe-visibility");return u(),g(me,null,[(h=l(e))!=null&&h.cover?(u(),w(ne,{key:0,placeholder:a.coverIcon,src:l(e).cover},null,8,["placeholder","src"])):f("",!0),o("div",Ce,[m(xe,{ref:"addSongPopup",onUpdate:t[0]||(t[0]=s=>l(x).fetchPlaylists())},null,512),l(e)?(u(),w(he,{key:0,ref:"fixedHeading",class:L({hidden:_.value}),title:l(e).name,onLoadPlaylist:t[1]||(t[1]=s=>l(y).loadPlaylist(a.id))},null,8,["class","title"])):f("",!0),l(e)?(u(),g("div",Te,[o("div",Ae,[j((u(),g("div",Fe,[m(re,{placeholder:a.coverIcon,src:l(e).cover,class:"max-w-sm rounded-xl",type:"playlist"},null,8,["placeholder","src"]),o("div",Me,[o("div",Ue,[l(e).type!="classic"?(u(),g("div",De,[o("span",Ee,T(l(e).type=="smart"?"neurology":"bolt"),1),o("span",null,T(l(e).type)+" Playlist",1)])):f("",!0),o("div",Be,[o("span",{class:"text-5xl cursor-pointer material-symbols-rounded ms-fill my-auto",onClick:t[2]||(t[2]=s=>l(y).loadPlaylist(a.id))}," play_circle "),o("h1",He,[m(z,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=s=>v.value=s)},{default:A(()=>[q(T(l(e).name),1)]),_:1},8,["modelValue"])])]),o("p",Ne,[m(z,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=s=>p.value=s),placeholder:"No description"},{default:A(()=>[q(T(l(e).description),1)]),_:1},8,["modelValue"])])]),o("div",Oe,[m(D,{"primary-text":(P=l(e).songs)==null?void 0:P.length,"secondary-text":((C=l(e).songs)==null?void 0:C.length)===1?"Song":"Songs",class:"w-full"},null,8,["primary-text","secondary-text"]),m(D,{"primary-text":l(K),class:"w-full","secondary-text":"Total Duration"},null,8,["primary-text"]),l(e).plays?(u(),w(D,{key:0,"primary-text":l(e).plays,class:"w-full","secondary-text":"Plays"},null,8,["primary-text"])):f("",!0),l(X)?(u(),w(R,{key:1,class:"p-4 w-1/2 flex flex-col items-center justify-center"},{default:A(()=>[o("span",{id:"addToPlaylist",class:"material-symbols-rounded ms-fill",onClick:t[5]||(t[5]=s=>d.$refs.addSongPopup.show())},"add_circle"),Le]),_:1})):f("",!0),l(Y)?(u(),w(R,{key:2,class:"p-4 w-1/2 flex flex-col items-center justify-center"},{default:A(()=>[o("span",{id:"addToPlaylist",class:"material-symbols-rounded ms-fill",onClick:ee},"edit"),je]),_:1})):f("",!0)]),l(e).songs?(u(),g("div",qe,[m(de,{modelValue:i.value.search,"onUpdate:modelValue":t[6]||(t[6]=s=>i.value.search=s),icon:"search",placeholder:"Search"},null,8,["modelValue"]),m(E,{modelValue:i.value.title,"onUpdate:modelValue":t[7]||(t[7]=s=>i.value.title=s),options:l(Ve)(l(e).songs),class:"multiselect",icon:"title",placeholder:"Title"},null,8,["modelValue","options"]),m(E,{modelValue:i.value.artist,"onUpdate:modelValue":t[8]||(t[8]=s=>i.value.artist=s),options:l(Pe)(l(e).songs),class:"multiselect",icon:"person",placeholder:"Artist"},null,8,["modelValue","options"]),m(E,{modelValue:i.value.album,"onUpdate:modelValue":t[9]||(t[9]=s=>i.value.album=s),options:l(ke)(l(e).songs),class:"multiselect",icon:"album",placeholder:"Album"},null,8,["modelValue","options"]),m(ue,{modelValue:i.value.sort,"onUpdate:modelValue":t[10]||(t[10]=s=>i.value.sort=s),options:J,icon:"filter_list"},null,8,["modelValue"]),o("span",{class:"cursor-pointer material-symbols-rounded ms-wght-100 text-5xl",onClick:t[11]||(t[11]=s=>i.value.order=i.value.order=="asc"?"desc":"asc")},T(i.value.order=="asc"?"arrow_drop_up":"arrow_drop_down"),1),o("span",{class:"cursor-pointer material-symbols-rounded ms-wght-300 text-3xl mr-2",onClick:B}," delete_sweep ")])):f("",!0)])])),[[b,Q]]),n.value.length?(u(),w(be,{key:0,class:"hideIfMobile mt-8","with-album":"","with-more":""})):f("",!0),Re,n.value.length?(u(),g("div",ze,[n.value.length?(u(),w(l(_e),{key:a.id,modelValue:n.value,"onUpdate:modelValue":t[13]||(t[13]=s=>n.value=s),class:L([i.value.order=="asc"?"flex-col":"flex-col-reverse","flex"]),disabled:l(ge)(i.value)||!l(Z),"item-key":"id",onChange:W},{item:A(({element:s})=>[j(m(ye,{index:l(e).songs.findIndex(I=>I.source==s.source),"playlist-id":a.id,selected:k.value==s.id,song:s,"with-album":"","with-cover":"","with-more":"",onClick:I=>k.value==s.id?k.value=-1:k.value=s.id,onUpdate:t[12]||(t[12]=I=>l(x).fetchPlaylists())},null,8,["index","playlist-id","selected","song","onClick"]),[[ce,s.show]])]),_:1},8,["modelValue","class","disabled"])):f("",!0)])):f("",!0)])])):(u(),g("div",Se,$e))])],64)}}});const Ye=fe(Ge,[["__scopeId","data-v-cbd7bc8e"]]);export{Ye as T};
