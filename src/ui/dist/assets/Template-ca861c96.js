import{i as J,B as k,q as I,s as se,D as ae,k as K,E,G as oe,H as ne,o as u,c as b,u as t,f as M,I as Q,d as w,g as v,J as W,h as ie,a as n,t as F,w as S,b as z,C as O,T as re,K as de,F as j,N as ce,m as X,n as Y,_ as Z,O as ue,P as pe,Q as me}from"./index-7c89f80c.js";import{P as ve}from"./PlaylistEntry-6bb1eba7.js";import{F as ye,_ as fe,E as G,M as B,d as _e}from"./AddNewSong.vue_vue_type_script_setup_true_lang-a434e107.js";import{P as xe}from"./PlaylistHeader-ad8fb756.js";import{F as H}from"./FactCard-2210080a.js";const he=s=>{const{search:r,artist:c,title:e,album:a,order:_,sort:y}=s;return(r==null?void 0:r.length)||(c==null?void 0:c.length)||(e==null?void 0:e.length)||(a==null?void 0:a.length)||_!="asc"||y!="index"},ge=(s,r)=>{const{search:c,artist:e,title:a,album:_,sort:y}=r;return s.map(d=>{const p=c.length?d.title.toLowerCase().includes(c.toLowerCase())||d.artist.toLowerCase().includes(c.toLowerCase()):!0,m=e.length?e.includes(d.artist):!0,P=a.length?a.includes(d.title):!0,i=_.length?_.includes(d.album):!0;return{...d,show:p&&m&&P&&i,index:s.indexOf(d)}}).sort((d,p)=>{const m=d[y],P=p[y];return m<P?-1:m>P?1:0})},be=s=>s.map(r=>({label:r.title,value:r.title})),we=s=>s.map(r=>({label:r.album,value:r.album})),Pe=s=>{const r=new Set;for(const c of s)for(const e of c.artist.split(", "))r.add(e);return Array.from(r).sort().map(c=>({label:c,value:c}))},q=s=>(X("data-v-cea2e6ef"),s=s(),Y(),s),Ve={class:"upper relative"},ke={class:"track__info__details flex flex-col justify-end"},$e={class:"trac__info__details__normal"},Ie={key:0,class:"flex flex-row items-center gap-2 playlist-type"},Ce={class:"material-symbols-rounded"},Se={class:"flex flew-row items-center"},Me={class:"font-black text-5xl ml-4 w-full flex-1"},Te={class:"text-muted"},Ae={class:"features flex flex-row gap-4 pt-4 pb-2 overflow-x-auto"},Fe=q(()=>n("span",{class:"text-muted"},"Add a song",-1)),De=q(()=>n("span",{class:"text-muted"},"Delete this playlist",-1)),Ue=q(()=>n("span",{class:"text-muted"},"Edit this playlist",-1)),Ee={key:0,class:"filters mt-4"},Ne=J({__name:"PlaylistMeta",props:{playlist:{type:Object,required:!1},coverIcon:{type:String,required:!0}},setup(s,{expose:r}){var L,R;const c=s,e=k(()=>c.playlist),a=I(!0),_=se(),y=ae(),d=K(),p=I(((L=e.value)==null?void 0:L.name.trim())??""),m=I(((R=e.value)==null?void 0:R.description.trim())??""),P=()=>({sort:"index",order:"asc",search:"",title:[],artist:[],album:[]}),i=I(null),T=()=>{i.value={...P()}};T(),r({songFilters:i}),E(()=>e.value,()=>{var f,l;p.value=((f=e.value)==null?void 0:f.name.trim())??"",m.value=((l=e.value)==null?void 0:l.description.trim())??"",T()}),E([p,m],()=>{var l,$;if(p.value===((l=e.value)==null?void 0:l.name)&&m.value===(($=e.value)==null?void 0:$.description))return;const f={...e.value,name:p.value,description:m.value};oe(f),d.fetchPlaylists(e.value.id)});const D=(f,l)=>{a.value=f},x=k(()=>e.value.type==="classic"),h=k(()=>["smart"].includes(e.value.type)),U=()=>{_.push(`/playlist/${e.value.id}/edit`)},g=[{value:"title",label:"Title",icon:"title"},{value:"artist",label:"Artist",icon:"person"},{value:"album",label:"Album",icon:"album"},{value:"duration",label:"Duration",icon:"timer"},{value:"index",label:"Added",icon:"date_range"}],A=k(()=>{let f=0,l=!1;if(!e.value.songs.length)return"N/A";for(const N of e.value.songs){l=l||N.duration<=0;const le=N.duration<=0?3*60:N.duration;f+=le}const $=f,V=Math.floor($/60),C=Math.floor(V/60),o=l?"about ":"";return C?o+`${C} hr ${V-C*60} min`:V?o+`${V} min ${$-V*60} sec`:o+f+" sec"}),te=async()=>{await ce(e.value.id),await d.fetchPlaylists(),_.push("/")};return(f,l)=>{var V,C;const $=ne("observe-visibility");return u(),b(j,null,[t(e)?(u(),M(ye,{key:0,ref:"fixedHeading",class:Q({hidden:a.value}),title:t(e).name,onLoadPlaylist:l[0]||(l[0]=o=>t(y).loadPlaylist(t(e).id))},null,8,["class","title"])):w("",!0),v(fe,{ref:"addSongPopup",onUpdate:l[1]||(l[1]=o=>t(d).fetchPlaylists())},null,512),W((u(),b("div",Ve,[v(ie,{placeholder:s.coverIcon,src:t(e).cover,class:"max-w-sm rounded-xl",type:"playlist"},null,8,["placeholder","src"]),n("div",ke,[n("div",$e,[t(e).type!="classic"?(u(),b("div",Ie,[n("span",Ce,F(t(e).type=="smart"?"neurology":"bolt"),1),n("span",null,F(t(e).type)+" Playlist",1)])):w("",!0),n("div",Se,[n("span",{class:"text-5xl cursor-pointer material-symbols-rounded ms-fill my-auto",onClick:l[2]||(l[2]=o=>t(y).loadPlaylist(t(e).id))}," play_circle "),n("h1",Me,[v(G,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=o=>p.value=o)},{default:S(()=>[z(F(t(e).name),1)]),_:1},8,["modelValue"])])]),n("p",Te,[v(G,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=o=>m.value=o),placeholder:"No description"},{default:S(()=>[z(F(t(e).description),1)]),_:1},8,["modelValue"])])]),n("div",Ae,[v(H,{"primary-text":(V=t(e).songs)==null?void 0:V.length,"secondary-text":((C=t(e).songs)==null?void 0:C.length)===1?"Song":"Songs",class:"w-full"},null,8,["primary-text","secondary-text"]),v(H,{"primary-text":t(A),class:"w-full","secondary-text":"Total Duration"},null,8,["primary-text"]),t(e).plays?(u(),M(H,{key:0,"primary-text":t(e).plays,class:"w-full","secondary-text":"Plays"},null,8,["primary-text"])):w("",!0),t(x)?(u(),M(O,{key:1,class:"p-4 w-1/2 flex flex-col items-center justify-center"},{default:S(()=>[n("span",{id:"addToPlaylist",class:"material-symbols-rounded ms-fill",onClick:l[5]||(l[5]=o=>f.$refs.addSongPopup.show())},"add_circle"),Fe]),_:1})):w("",!0),v(O,{class:"p-4 w-1/2 flex flex-col items-center justify-center"},{default:S(()=>[n("span",{id:"addToPlaylist",class:"material-symbols-rounded ms-fill",onClick:te},"delete"),De]),_:1}),t(h)?(u(),M(O,{key:2,class:"p-4 w-1/2 flex flex-col items-center justify-center"},{default:S(()=>[n("span",{id:"addToPlaylist",class:"material-symbols-rounded ms-fill",onClick:U},"edit"),Ue]),_:1})):w("",!0)]),t(e).songs?(u(),b("div",Ee,[v(re,{modelValue:i.value.search,"onUpdate:modelValue":l[6]||(l[6]=o=>i.value.search=o),icon:"search",placeholder:"Search"},null,8,["modelValue"]),v(B,{modelValue:i.value.title,"onUpdate:modelValue":l[7]||(l[7]=o=>i.value.title=o),options:t(be)(t(e).songs),class:"multiselect",icon:"title",placeholder:"Title"},null,8,["modelValue","options"]),v(B,{modelValue:i.value.artist,"onUpdate:modelValue":l[8]||(l[8]=o=>i.value.artist=o),options:t(Pe)(t(e).songs),class:"multiselect",icon:"person",placeholder:"Artist"},null,8,["modelValue","options"]),v(B,{modelValue:i.value.album,"onUpdate:modelValue":l[9]||(l[9]=o=>i.value.album=o),options:t(we)(t(e).songs),class:"multiselect",icon:"album",placeholder:"Album"},null,8,["modelValue","options"]),v(de,{modelValue:i.value.sort,"onUpdate:modelValue":l[10]||(l[10]=o=>i.value.sort=o),options:g,icon:"filter_list"},null,8,["modelValue"]),n("span",{class:"cursor-pointer material-symbols-rounded ms-wght-100 text-5xl",onClick:l[11]||(l[11]=o=>i.value.order=i.value.order=="asc"?"desc":"asc")},F(i.value.order=="asc"?"arrow_drop_up":"arrow_drop_down"),1),n("span",{class:"cursor-pointer material-symbols-rounded ms-wght-300 text-3xl mr-2",onClick:T}," delete_sweep ")])):w("",!0)])])),[[$,D]])],64)}}});const Oe=Z(Ne,[["__scopeId","data-v-cea2e6ef"]]),ee=s=>(X("data-v-874e9e58"),s=s(),Y(),s),Be={class:"playlist p-4"},He={key:0,class:"fill-page"},je=ee(()=>n("h2",{class:"text-2xl text-center error"},"Playlist not found",-1)),qe=[je],Le={key:1,class:"wrap"},Re={class:"track__data"},ze=ee(()=>n("hr",{class:"mb-4"},null,-1)),Ge={key:1,class:"items"},Je={key:2,class:"text-muted italic text-sm text-center mt-10"},Ke=J({__name:"Template",props:{id:{type:String,required:!0},coverIcon:{type:String,required:!1}},emits:["rearrange"],setup(s,{emit:r}){var D;const c=s,e=K(),a=k(()=>e.getPlaylistById(c.id)),_=I(),y=I(((D=a.value)==null?void 0:D.songs)??[]),d=I(null),p=k(()=>{var x;return((x=_.value)==null?void 0:x.songFilters)??{}});E([p,a],()=>{a.value&&m()},{deep:!0});const m=()=>{var x;y.value=ge(((x=a.value)==null?void 0:x.songs)??[],p.value)};ue(()=>{m()}),E(a,()=>{m()});const P=k(()=>a.value.type==="classic"),i=k(()=>a.value.type==="classic"),T=x=>{const h=x.moved;h&&r("rearrange",h.oldIndex,h.newIndex)};return(x,h)=>{var U;return u(),b(j,null,[(U=t(a))!=null&&U.cover?(u(),M(pe,{key:0,placeholder:s.coverIcon,src:t(a).cover},null,8,["placeholder","src"])):w("",!0),n("div",Be,[t(a)?(u(),b("div",Le,[n("div",Re,[v(Oe,{ref_key:"playlistMeta",ref:_,playlist:t(a),coverIcon:s.coverIcon},null,8,["playlist","coverIcon"]),y.value.length?(u(),b(j,{key:0},[v(xe,{class:"hideIfMobile mt-8","with-album":"","with-more":""}),ze],64)):w("",!0),y.value.length?(u(),b("div",Ge,[y.value.length?(u(),M(t(_e),{key:s.id,modelValue:y.value,"onUpdate:modelValue":h[1]||(h[1]=g=>y.value=g),class:Q([t(p).order=="asc"?"flex-col":"flex-col-reverse","flex"]),disabled:t(he)(t(p))||!t(P),"item-key":"id",onChange:T},{item:S(({element:g})=>[W(v(ve,{index:t(a).songs.findIndex(A=>A.source==g.source),"playlist-id":s.id,selected:d.value==g.id,song:g,"with-album":"","with-cover":"","with-more":"",onClick:A=>d.value==g.id?d.value=-1:d.value=g.id,onUpdate:h[0]||(h[0]=A=>t(e).fetchPlaylists())},null,8,["index","playlist-id","selected","song","onClick"]),[[me,g.show]])]),_:1},8,["modelValue","class","disabled"])):w("",!0)])):t(i)?(u(),b("p",Je," No songs. Add some! ")):w("",!0)])])):(u(),b("div",He,qe))])],64)}}});const et=Z(Ke,[["__scopeId","data-v-874e9e58"]]);export{et as T};
