import{F as w,G as T}from"./FixedPlaylistHeader.a069c8be.js";import{E as N}from"./EditSong.00a5b270.js";import{d as k}from"./vuedraggable.umd.95e7138b.js";import{S as A}from"./SpotifyPlaylistEntry.9916c8c2.js";import{A as C}from"./AddSongToPlaylist.cc2c18ea.js";import{_ as I,h as H,o as c,c as u,g as r,m as V,s as E,a as s,w as p,b as j,t as d,e as a,q,p as O,i as R}from"./index.6686ce7a.js";import"./FindSources.87d8275b.js";import"./MiniPlayer.f576897b.js";const B={components:{AddSongToPlaylist:C,FixedPlaylistHeader:w,GridHeader:T,draggable:k,SpotifyPlaylistEntry:A,EditSong:N},data(){return this.updatePlaylist(),{fixedHeaderHidden:!0,title:"N/A",artist:"N/A",album:"N/A",cover:"/assets/img/music_placeholder.png",src:"",id:-1,recommendations:[]}},methods:{getId(){return H(this.$route.params.id)},onPlaylistRearrange(o){o.moved},headerVisibilityChanged(o){this.fixedHeaderHidden=o},editSong(){this.$refs.editSongPopup.showModal=!0},addToPlaylist(){this.$refs.addSongPopup.showModal=!0},updatePlaylist(){!this.getId()||!this.$route.path.includes("/track/")||fetch(`/api/tracks/${this.getId()}`).then(async o=>{if(o.status==404){this.$router.push("/");return}const i=await o.json();console.log(i),this.title=i.title||"N/A",this.artist=i.artist||"N/A",this.cover=i.cover||"/assets/img/music_placeholder.png",this.src=i.source,this.album=i.album||"N/A",this.id=i.id,document.title=`${this.title} \u2022 ${this.artist}`;const n=await(await fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.artist} ${this.title}`})})).json();this.recommendations.push(...n)})},loadPlaylist(){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:Number(this.getId()),type:"track"})})}},watch:{$route(){this.updatePlaylist()},currentSong(){this.updateIsPlaying()}}},h=o=>(O("data-v-eeae7b5e"),o=o(),R(),o),D={class:"playlist"},U=["src"],F={class:"details"},G=h(()=>s("hr",null,null,-1)),J={class:"padding-20"},L={class:"grid"},M=h(()=>s("hr",null,null,-1)),z={class:"playlistEntries"};function K(o,i,m,n,t,l){const _=a("AddSongToPlaylist"),y=a("EditSong"),g=a("fixed-playlist-header"),f=a("h7"),v=a("grid-header"),P=a("spotify-playlist-entry"),b=a("draggable"),S=q("observe-visibility");return c(),u("div",D,[r(_,{cover:t.cover,title:t.title,artist:t.artist,ref:"addSongPopup",href:t.src,exists:""},null,8,["cover","title","artist","href"]),r(y,{onClose:l.updatePlaylist,ref:"editSongPopup",cover:t.cover,id:t.id,title:t.title,album:t.album,artist:t.artist,source:t.src},null,8,["onClose","cover","id","title","album","artist","source"]),r(g,{onLoadPlaylist:l.loadPlaylist,ref:"fixedHeading",class:V({hidden:t.fixedHeaderHidden}),title:`${t.artist} - ${t.title}`},null,8,["onLoadPlaylist","class","title"]),E((c(),u("div",{class:"padding-20 songdetails",onClick:i[0]||(i[0]=(...e)=>l.editSong&&l.editSong(...e))},[s("img",{class:"cover",src:t.cover},null,8,U),s("div",F,[r(f,null,{default:p(()=>[j("Song")]),_:1}),s("h1",null,d(t.title),1),s("h5",null,d(t.artist),1)])])),[[S,l.headerVisibilityChanged]]),G,s("div",J,[s("span",{id:"loadPlaylist",onClick:i[1]||(i[1]=(...e)=>l.loadPlaylist&&l.loadPlaylist(...e)),class:"material-icons-outlined"},"play_circle_filled"),s("span",{id:"addToPlaylist",onClick:i[2]||(i[2]=(...e)=>l.addToPlaylist&&l.addToPlaylist(...e)),class:"material-icons-outlined"},"add_circle"),s("div",L,[s("h2",null,d("Recommendations based on "+t.title),1),r(v),M,s("div",z,[r(b,{modelValue:t.recommendations,"onUpdate:modelValue":i[3]||(i[3]=e=>t.recommendations=e)},{item:p(({element:e})=>[r(P,{onRequestUpdate:l.updatePlaylist,index:t.recommendations.findIndex(x=>x.src==e.src),source:e.src,id:e.id,title:e.title,album:e.album,artist:e.artists.join(", "),preview:e.preview,cover:e.cover,favourite:e.favourite,duration:e.duration},null,8,["onRequestUpdate","index","source","id","title","album","artist","preview","cover","favourite","duration"])]),_:1},8,["modelValue"])])])])])}const it=I(B,[["render",K],["__scopeId","data-v-eeae7b5e"]]);export{it as default};
