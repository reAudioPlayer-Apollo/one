import{F as T,G as N}from"./FixedPlaylistHeader.5cb40335.js";import{E as k}from"./EditSong.0fe6a16c.js";import{d as C}from"./vuedraggable.umd.4a375cf8.js";import{S as A}from"./SpotifyPlaylistEntry.d4069bb2.js";import{A as I}from"./AddSongToPlaylist.ae7ae457.js";import{_ as H,l as c,h as V,o as u,c as p,g as l,q as E,v as j,a as s,w as h,b as q,t as d,e as a,s as O,p as R,i as B}from"./index.e4364b30.js";import"./FindSources.f9fa1aa0.js";import"./MiniPlayer.caa2b0a7.js";const D={components:{AddSongToPlaylist:I,FixedPlaylistHeader:T,GridHeader:N,draggable:C,SpotifyPlaylistEntry:A,EditSong:k},data(){return this.updatePlaylist(),{fixedHeaderHidden:!0,title:"N/A",artist:"N/A",album:"N/A",cover:c(null),src:"",id:-1,recommendations:[]}},methods:{getId(){return V(this.$route.params.id)},onPlaylistRearrange(o){o.moved},headerVisibilityChanged(o){this.fixedHeaderHidden=o},editSong(){this.$refs.editSongPopup.showModal=!0},addToPlaylist(){this.$refs.addSongPopup.showModal=!0},updatePlaylist(){!this.getId()||!this.$route.path.includes("/track/")||fetch(`/api/tracks/${this.getId()}`).then(async o=>{if(o.status==404){this.$router.push("/");return}const i=await o.json();console.log(i),this.title=i.title||"N/A",this.artist=i.artist||"N/A",this.cover=c(i.cover),this.src=i.source,this.album=i.album||"N/A",this.id=i.id,document.title=`${this.title} \u2022 ${this.artist}`;const n=await(await fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.artist} ${this.title}`})})).json();this.recommendations.push(...n)})},loadPlaylist(){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:Number(this.getId()),type:"track"})})}},watch:{$route(){this.updatePlaylist()},currentSong(){this.updateIsPlaying()}}},m=o=>(R("data-v-6e4d8199"),o=o(),B(),o),U={class:"playlist"},F=["src"],G={class:"details"},J=m(()=>s("hr",null,null,-1)),L={class:"padding-20"},M={class:"grid"},z=m(()=>s("hr",null,null,-1)),K={class:"playlistEntries"};function Q(o,i,_,n,t,r){const y=a("AddSongToPlaylist"),v=a("EditSong"),f=a("fixed-playlist-header"),g=a("h7"),P=a("grid-header"),S=a("spotify-playlist-entry"),b=a("draggable"),x=O("observe-visibility");return u(),p("div",U,[l(y,{cover:t.cover,title:t.title,artist:t.artist,ref:"addSongPopup",href:t.src,exists:""},null,8,["cover","title","artist","href"]),l(v,{onClose:r.updatePlaylist,ref:"editSongPopup",cover:t.cover,id:t.id,title:t.title,album:t.album,artist:t.artist,source:t.src},null,8,["onClose","cover","id","title","album","artist","source"]),l(f,{onLoadPlaylist:r.loadPlaylist,ref:"fixedHeading",class:E({hidden:t.fixedHeaderHidden}),title:`${t.artist} - ${t.title}`},null,8,["onLoadPlaylist","class","title"]),j((u(),p("div",{class:"padding-20 songdetails",onClick:i[0]||(i[0]=(...e)=>r.editSong&&r.editSong(...e))},[s("img",{class:"cover",src:t.cover},null,8,F),s("div",G,[l(g,null,{default:h(()=>[q("Song")]),_:1}),s("h1",null,d(t.title),1),s("h5",null,d(t.artist),1)])])),[[x,r.headerVisibilityChanged]]),J,s("div",L,[s("span",{id:"loadPlaylist",onClick:i[1]||(i[1]=(...e)=>r.loadPlaylist&&r.loadPlaylist(...e)),class:"material-icons-outlined"},"play_circle_filled"),s("span",{id:"addToPlaylist",onClick:i[2]||(i[2]=(...e)=>r.addToPlaylist&&r.addToPlaylist(...e)),class:"material-icons-outlined"},"add_circle"),s("div",M,[s("h2",null,d("Recommendations based on "+t.title),1),l(P),z,s("div",K,[l(b,{modelValue:t.recommendations,"onUpdate:modelValue":i[3]||(i[3]=e=>t.recommendations=e)},{item:h(({element:e})=>[l(S,{onRequestUpdate:r.updatePlaylist,index:t.recommendations.findIndex(w=>w.src==e.src),source:e.src,id:e.id,title:e.title,album:e.album,artist:e.artists.join(", "),preview:e.preview,cover:e.cover,favourite:e.favourite,duration:e.duration},null,8,["onRequestUpdate","index","source","id","title","album","artist","preview","cover","favourite","duration"])]),_:1},8,["modelValue"])])])])])}const st=H(D,[["render",Q],["__scopeId","data-v-6e4d8199"]]);export{st as default};
