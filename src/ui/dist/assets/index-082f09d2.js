import{_ as S,o as n,c as a,a as t,b as I,t as x,d as p,r as N,e as F,f as T,g as i,w as d,F as h,h as m,i as _,P as w,u as $,p as q,j as H,k,l as D,m as j,n as f,q as B,s as M,v as R,I as V,C as O,x as G,y as L}from"./index-47e9ffaa.js";import{P as E}from"./PlaylistCard-16c1e275.js";import{T as b}from"./TrackCompact-07eaa398.js";import{P as C}from"./PlaylistEntry-96077b1f.js";import{s as J}from"./spotify-5ecab05d.js";import"./playerInPicture-af203fdf.js";import"./EditSong.vue_vue_type_script_setup_true_lang-a9ccff6c.js";const W={name:"FlexShelf",props:{heading:String,icon:String}},z={class:"shelf"},A={class:"header"},K={key:0},Q={key:0,class:"icon material-symbols-round"},U={class:"items"};function X(e,l,r,c,s,o){return n(),a("div",z,[t("div",A,[r.heading||r.icon?(n(),a("h2",K,[I(x(r.heading),1),r.icon?(n(),a("span",Q,x(r.icon),1)):p("",!0)])):p("",!0)]),t("div",U,[N(e.$slots,"default",{},void 0,!0)])])}const y=S(W,[["render",X],["__scopeId","data-v-3f16aa97"]]),u=e=>(D("data-v-7d09d2f9"),e=e(),j(),e),Y={class:"home"},Z={class:"main"},ee={key:0,class:"playlists"},te=u(()=>t("span",{class:"material-symbols-rounded ms-fill"}," library_music ",-1)),se=u(()=>t("span",{class:"hover:underline"}," Playlists ",-1)),le={key:1,class:"breaking"},ne=u(()=>t("span",{class:"material-symbols-rounded ms-fill"}," trending_up ",-1)),oe=u(()=>t("span",{class:"hover:underline"}," Breaking Songs ",-1)),ae={key:2,class:"liked"},ie=u(()=>t("span",{class:"material-symbols-rounded ms-fill"}," favorite ",-1)),re=u(()=>t("span",{class:"hover:underline"}," Liked Songs ",-1)),ce={class:"side"},de={key:0,class:"releases"},ue=u(()=>t("span",{class:"material-symbols-rounded ms-fill"}," radar ",-1)),_e=u(()=>t("span",{class:"hover:underline"}," Out now ",-1)),pe={key:1,class:"disovery"},he=u(()=>t("span",{class:"material-symbols-rounded ms-fill"}," explore ",-1)),me=u(()=>t("span",{class:"hover:underline"}," Discover ",-1)),ye={key:2,class:"recommendations"},fe=u(()=>t("h2",{class:"flex items-center gap-2"},[t("span",{class:"material-symbols-rounded ms-fill"}," recommend "),I(" Suggested ")],-1)),ve={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],recommendations:[],data:H()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists},liked(){return k("liked").songs.slice(0,3)},breaking(){return k("breaking").songs.slice(0,3)}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const l=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.source||e.url||e.href}});window.dispatchEvent(l)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=this.playlists.map(e=>{var l;return((l=k(e.id))==null?void 0:l.songs)||[]}).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},ge=F({...ve,setup(e){return(l,r)=>{const c=T("router-link");return n(),a("div",Y,[t("div",Z,[l.playlists.length?(n(),a("div",ee,[t("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/playlists"},{default:d(()=>[te,se]),_:1})]),i(y,null,{default:d(()=>[(n(!0),a(h,null,m(l.playlists,s=>(n(),_(E,{playlist:s},null,8,["playlist"]))),256))]),_:1})])):p("",!0),l.breaking.length?(n(),a("div",le,[t("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/tracks/breaking"},{default:d(()=>[ne,oe]),_:1})]),i(w),(n(!0),a(h,null,m(l.breaking,(s,o)=>(n(),_(C,{key:o,index:o,"playlist-id":"breaking",song:s,"with-cover":""},null,8,["index","song"]))),128))])):p("",!0),l.liked.length?(n(),a("div",ae,[t("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/tracks"},{default:d(()=>[ie,re]),_:1})]),i(w),(n(!0),a(h,null,m(l.liked,(s,o)=>(n(),_(C,{key:o,index:o,"playlist-id":"liked",song:s,"with-cover":""},null,8,["index","song"]))),128))])):p("",!0)]),t("div",ce,[l.releases.length?(n(),a("div",de,[t("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/releases"},{default:d(()=>[ue,_e]),_:1})]),i(y,null,{default:d(()=>[(n(!0),a(h,null,m(l.releases,(s,o)=>(n(),_(b,{key:o,artist:s.artist,cover:s.cover,href:s.url,title:s.title,onPlay:()=>l.playRecommendation(s)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):p("",!0),l.picks.length?(n(),a("div",pe,[t("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/discover"},{default:d(()=>[he,me]),_:1})]),i(y,null,{default:d(()=>[(n(!0),a(h,null,m(l.picks,(s,o)=>(n(),_(b,{id:s.id,key:o,artist:s.artist,cover:$(q)(s.cover),href:s.href,title:s.title,onPlay:()=>l.playDiscover(s)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):p("",!0),l.recommendations.length?(n(),a("div",ye,[fe,i(y,null,{default:d(()=>[(n(!0),a(h,null,m(l.recommendations,(s,o)=>(n(),_(b,{key:o,artist:s.artist,cover:s.cover,href:s.href,title:s.title,onPlay:()=>l.playRecommendation(s)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):p("",!0)])])}}});const ke=S(ge,[["__scopeId","data-v-7d09d2f9"]]),v=e=>(D("data-v-2c465748"),e=e(),j(),e),be={class:"onboarding p-4"},Se=v(()=>t("h1",null,"So nice to meet you!",-1)),$e=v(()=>t("p",null,"Let's get you set up",-1)),Pe={class:"grid grid-cols-2 gap-4 mt-8"},xe=v(()=>t("div",{class:"flex flex-row items-center"},[t("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),t("h2",null,"Create your first playlist")],-1)),we={class:"flex flex-row justify-end w-full"},Oe={class:"flex flex-row items-center"},Ce=v(()=>t("h2",null,"Import from Spotify",-1)),Ie={class:"spotify-playlists"},Fe=F({__name:"Onboarding",setup(e){const l=f([]),r=f(!1),c=f(null);B(),M().then(o=>{r.value=o}),fetch("/api/spotify/playlists").then(o=>o.json()).then(o=>{l.value=o});const s={fields:[{name:"name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const o=c.value.toObject();await G(o.name,o.description)}}};return(o,P)=>(n(),a("div",be,[Se,$e,t("div",Pe,[i(O,{class:"p-4"},{default:d(()=>[xe,i(R,{ref_key:"createForm",ref:c,options:s.fields},null,8,["options"]),t("div",we,[i(V,{onClick:P[0]||(P[0]=g=>s.submit.action()),icon:"add",label:s.submit.label},null,8,["label"])])]),_:1}),l.value.length?(n(),_(O,{key:0,class:"p-4"},{default:d(()=>[t("div",Oe,[i($(J),{class:"spotify mr-4"}),Ce]),t("div",Ie,[(n(!0),a(h,null,m(l.value,g=>(n(),_(E,{playlist:{...g,type:"classic",plays:0,href:`https://open.spotify.com/playlist/${g.id}`},"is-spotify":""},null,8,["playlist"]))),256))])]),_:1})):p("",!0)])]))}});const He=S(Fe,[["__scopeId","data-v-2c465748"]]),Me={__name:"index",setup(e){const l=H(),r=f(!1),c=B();return L(()=>{document.body.clientWidth<768&&(r.value=!0,c.push("/collection/playlist"))}),(s,o)=>$(l).notEmpty||r.value?(n(),_(ke,{key:0})):(n(),_(He,{key:1}))}};export{Me as default};
