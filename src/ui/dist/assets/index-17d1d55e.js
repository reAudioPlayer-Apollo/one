import{_ as v,o,c as a,a as n,b as f,t as w,d as _,r as H,e as C,f as d,w as r,g as l,h as q,F as h,i as p,u as S,p as B,j as I,k as F,l as j,m as N,n as g,q as E,s as T}from"./index-63840441.js";import{g as R,c as z}from"./song-6bfd6160.js";import{C as $}from"./Card-1541fb70.js";import{T as b}from"./TrackCompact-7961f282.js";import{P as x}from"./PlaylistHeader-468304f4.js";import{P as O}from"./PlaylistEntry-fc09b93f.js";import{F as L}from"./Form-c1908040.js";import{P as M}from"./PlaylistItem-139a135e.js";import{I as V}from"./IconButton-fd8d7fa0.js";import"./ImportSpotifyAlbum.vue_vue_type_script_setup_true_lang-73cbbbdd.js";import"./Playlist-e4bf779d.js";import"./ExternalEntry-25c642db.js";import"./EditSong.vue_vue_type_script_setup_true_lang-8ac2ca3b.js";import"./playerInPicture-af203fdf.js";import"./Dropdown-685e63fc.js";const G={name:"FlexShelf",props:{heading:String,icon:String}},J={class:"shelf"},W={class:"header"},A={key:0},K={key:0,class:"icon material-symbols-round"},Q={class:"items"};function U(e,s,u,c,t,i){return o(),a("div",J,[n("div",W,[u.heading||u.icon?(o(),a("h2",A,[f(w(u.heading),1),u.icon?(o(),a("span",K,w(u.icon),1)):_("",!0)])):_("",!0)]),n("div",Q,[H(e.$slots,"default",{},void 0,!0)])])}const y=v(G,[["render",U],["__scopeId","data-v-c2d585d9"]]);const X={__name:"Playlist",props:{name:{type:String,required:!0},cover:{type:String,required:!0},href:{type:String,required:!0}},setup(e){return(s,u)=>{const c=C("router-link");return o(),d(c,{to:e.href,class:"no-underline"},{default:r(()=>[l($,{class:"home-playlist drop-shadow-md","with-hover":""},{default:r(()=>[l(q,{src:e.cover,type:"playlist"},null,8,["src"]),n("h2",null,w(e.name),1)]),_:1})]),_:1},8,["to"])}}},Y=v(X,[["__scopeId","data-v-af6eb9e9"]]);const Z=e=>(F("data-v-5586387d"),e=e(),j(),e),ee={class:"home"},te={class:"main"},se={key:0,class:"playlists"},oe={key:1,class:"liked"},ie={key:2,class:"breaking"},ne={class:"side"},ae={key:0,class:"releases"},le={key:1,class:"disovery"},re={key:2,class:"recommendations"},ce=Z(()=>n("h2",null,"Recommendations",-1)),de={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],liked:[],breaking:[],recommendations:[],data:I()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),fetch("/api/me/liked").then(e=>e.json()).then(e=>{this.liked=e.songs.slice(0,3)}),fetch("/api/me/new").then(e=>e.json()).then(e=>{this.breaking=e.songs.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const s=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.source||e.url||e.href}});window.dispatchEvent(s)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=(await Promise.all(this.playlists.map(async e=>{var s;return((s=await R(e.id))==null?void 0:s.songs)||[]}))).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},ue=Object.assign(de,{setup(e){return(s,u)=>{const c=C("router-link");return o(),a("div",ee,[n("div",te,[s.playlists.length?(o(),a("div",se,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/playlists"},{default:r(()=>[f("Playlists")]),_:1})]),l(y,null,{default:r(()=>[(o(!0),a(h,null,p(s.playlists,(t,i)=>(o(),d(Y,{key:i,cover:t.cover,href:t==null?void 0:t.href,name:t.name},null,8,["cover","href","name"]))),128))]),_:1})])):_("",!0),s.liked.length?(o(),a("div",oe,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/tracks"},{default:r(()=>[f("Liked Songs")]),_:1})]),l(x),(o(!0),a(h,null,p(s.liked,(t,i)=>(o(),d(O,{key:i,index:i,"playlist-id":-1,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0),s.breaking.length?(o(),a("div",ie,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/tracks/breaking"},{default:r(()=>[f("Breaking Songs")]),_:1})]),l(x),(o(!0),a(h,null,p(s.breaking,(t,i)=>(o(),d(O,{key:i,index:i,"playlist-id":-2,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0)]),n("div",ne,[s.releases.length?(o(),a("div",ae,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/releases"},{default:r(()=>[f("Out now")]),_:1})]),l(y,null,{default:r(()=>[(o(!0),a(h,null,p(s.releases,(t,i)=>(o(),d(b,{key:i,artist:t.artist,cover:t.cover,href:t.url,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.picks.length?(o(),a("div",le,[n("h2",null,[l(c,{class:"linkOnHover",to:"/discover"},{default:r(()=>[f("Discover")]),_:1})]),l(y,null,{default:r(()=>[(o(!0),a(h,null,p(s.picks,(t,i)=>(o(),d(b,{id:t.id,key:i,artist:t.artist,cover:S(B)(t.cover),href:t.href,title:t.title,onPlay:()=>s.playDiscover(t)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.recommendations.length?(o(),a("div",re,[ce,l(y,null,{default:r(()=>[(o(!0),a(h,null,p(s.recommendations,(t,i)=>(o(),d(b,{key:i,artist:t.artist,cover:t.cover,href:t.href,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0)])])}}}),_e=v(ue,[["__scopeId","data-v-5586387d"]]),he={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"},pe=n("path",{fill:"#111",d:"M83.996.277C37.747.277.253 37.77.253 84.019c0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l.001-.004zm38.404 120.78a5.217 5.217 0 0 1-7.18 1.73c-19.662-12.01-44.414-14.73-73.564-8.07a5.222 5.222 0 0 1-6.249-3.93 5.213 5.213 0 0 1 3.926-6.25c31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-.903-8.148-4.35a6.538 6.538 0 0 1 4.354-8.143c30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-.001zm.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219a7.835 7.835 0 0 1 5.221-9.771c29.581-8.98 78.756-7.245 109.83 11.202a7.823 7.823 0 0 1 2.74 10.733c-2.2 3.722-7.02 4.949-10.73 2.739z"},null,-1),me=[pe];function fe(e,s){return o(),a("svg",he,me)}const ye={render:fe},k=e=>(F("data-v-19a9c7d9"),e=e(),j(),e),ve={class:"onboarding p-4"},ke=k(()=>n("h1",null,"So nice to meet you!",-1)),ge=k(()=>n("p",null,"Let's get you set up",-1)),be={class:"grid grid-cols-2 gap-4 mt-8"},we=k(()=>n("div",{class:"flex flex-row items-center"},[n("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),n("h2",null,"Create your first playlist")],-1)),$e={class:"flex flex-row justify-end w-full"},Se={class:"flex flex-row items-center"},Pe=k(()=>n("h2",null,"Import from Spotify",-1)),xe={class:"spotify-playlists"},Oe=N({__name:"Onboarding",setup(e){const s=g([]),u=g(!1),c=g(null);E(),T().then(i=>{u.value=i}),fetch("/api/spotify/playlists").then(i=>i.json()).then(i=>{s.value=i});const t={fields:[{name:"name",label:"Name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",label:"Description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const i=c.value.toObject();await z(i.name,i.description)}}};return(i,P)=>(o(),a("div",ve,[ke,ge,n("div",be,[l($,{class:"p-4"},{default:r(()=>[we,l(L,{ref_key:"createForm",ref:c,options:t.fields},null,8,["options"]),n("div",$e,[l(V,{onClick:P[0]||(P[0]=m=>t.submit.action()),icon:"add",label:t.submit.label},null,8,["label"])])]),_:1}),s.value.length?(o(),d($,{key:0,class:"p-4"},{default:r(()=>[n("div",Se,[l(S(ye),{class:"spotify mr-4"}),Pe]),n("div",xe,[(o(!0),a(h,null,p(s.value,(m,D)=>(o(),d(M,{key:D,cover:m.cover,description:m.description,title:m.name,id:m.id,spotify:!0,href:`https://open.spotify.com/playlist/${m.id}`},null,8,["cover","description","title","id","href"]))),128))])]),_:1})):_("",!0)])]))}});const Ce=v(Oe,[["__scopeId","data-v-19a9c7d9"]]),Ge={__name:"index",setup(e){const s=I();return(u,c)=>S(s).notEmpty?(o(),d(_e,{key:0})):(o(),d(Ce,{key:1}))}};export{Ge as default};
