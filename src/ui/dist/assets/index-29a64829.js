import{_ as k,o as s,c as i,a as n,b as m,t as v,d as _,r as j,e as I,f as d,w as r,g as l,C as P,h as B,i as D,F as h,j as p,P as x,u as w,p as E,k as F,l as b,m as H,n as q,q as S,s as T,v as R,x as V,I as G,y as L}from"./index-e36e5ea8.js";import{T as $}from"./TrackCompact-2e2faa8c.js";import{P as C}from"./PlaylistEntry-e8ccb1dd.js";import{s as M}from"./spotify-bab087b7.js";import{P as J}from"./PlaylistItem-cfb26a1d.js";import"./EditSong.vue_vue_type_script_setup_true_lang-e9c30365.js";import"./playerInPicture-af203fdf.js";const W={name:"FlexShelf",props:{heading:String,icon:String}},z={class:"shelf"},A={class:"header"},K={key:0},Q={key:0,class:"icon material-symbols-round"},U={class:"items"};function X(e,a,u,c,t,o){return s(),i("div",z,[n("div",A,[u.heading||u.icon?(s(),i("h2",K,[m(v(u.heading),1),u.icon?(s(),i("span",Q,v(u.icon),1)):_("",!0)])):_("",!0)]),n("div",U,[j(e.$slots,"default",{},void 0,!0)])])}const f=k(W,[["render",X],["__scopeId","data-v-3f16aa97"]]);const Y={class:"title"},Z={key:0,class:"material-symbols-rounded"},ee={__name:"Playlist",props:{name:{type:String,required:!0},cover:{type:String,required:!0},href:{type:String,required:!0},type:{type:String,default:"classic"}},setup(e){return(a,u)=>{const c=I("router-link");return s(),d(c,{to:e.href,class:"no-underline"},{default:r(()=>[l(P,{class:"home-playlist drop-shadow-md","with-hover":""},{default:r(()=>[l(B,{src:e.cover,type:"playlist",name:e.name},null,8,["src","name"]),n("div",Y,[e.type!="classic"?(s(),i("span",Z,v(e.type=="smart"?"neurology":"bolt"),1)):_("",!0),n("h4",null,v(e.name),1)])]),_:1})]),_:1},8,["to"])}}},te=k(ee,[["__scopeId","data-v-da1ad591"]]),se=e=>(H("data-v-2f517464"),e=e(),q(),e),ae={class:"home"},oe={class:"main"},ne={key:0,class:"playlists"},ie={key:1,class:"liked"},le={key:2,class:"breaking"},re={class:"side"},ce={key:0,class:"releases"},de={key:1,class:"disovery"},ue={key:2,class:"recommendations"},_e=se(()=>n("h2",null,"Recommendations",-1)),he={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],recommendations:[],data:F()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists},liked(){return b("liked").songs.slice(0,3)},breaking(){return b("breaking").songs.slice(0,3)}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const a=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.source||e.url||e.href}});window.dispatchEvent(a)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=this.playlists.map(e=>{var a;return((a=b(e.id))==null?void 0:a.songs)||[]}).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},pe=D({...he,setup(e){return(a,u)=>{const c=I("router-link");return s(),i("div",ae,[n("div",oe,[a.playlists.length?(s(),i("div",ne,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/playlists"},{default:r(()=>[m("Playlists")]),_:1})]),l(f,null,{default:r(()=>[(s(!0),i(h,null,p(a.playlists,(t,o)=>(s(),d(te,{key:o,cover:t.cover,href:t==null?void 0:t.href,name:t.name,type:t.type},null,8,["cover","href","name","type"]))),128))]),_:1})])):_("",!0),a.liked.length?(s(),i("div",ie,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/tracks"},{default:r(()=>[m("Liked Songs")]),_:1})]),l(x),(s(!0),i(h,null,p(a.liked,(t,o)=>(s(),d(C,{key:o,index:o,"playlist-id":-1,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0),a.breaking.length?(s(),i("div",le,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/tracks/breaking"},{default:r(()=>[m("Breaking Songs")]),_:1})]),l(x),(s(!0),i(h,null,p(a.breaking,(t,o)=>(s(),d(C,{key:o,index:o,"playlist-id":-2,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0)]),n("div",re,[a.releases.length?(s(),i("div",ce,[n("h2",null,[l(c,{class:"linkOnHover",to:"/collection/releases"},{default:r(()=>[m("Out now")]),_:1})]),l(f,null,{default:r(()=>[(s(!0),i(h,null,p(a.releases,(t,o)=>(s(),d($,{key:o,artist:t.artist,cover:t.cover,href:t.url,title:t.title,onPlay:()=>a.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),a.picks.length?(s(),i("div",de,[n("h2",null,[l(c,{class:"linkOnHover",to:"/discover"},{default:r(()=>[m("Discover")]),_:1})]),l(f,null,{default:r(()=>[(s(!0),i(h,null,p(a.picks,(t,o)=>(s(),d($,{id:t.id,key:o,artist:t.artist,cover:w(E)(t.cover),href:t.href,title:t.title,onPlay:()=>a.playDiscover(t)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),a.recommendations.length?(s(),i("div",ue,[_e,l(f,null,{default:r(()=>[(s(!0),i(h,null,p(a.recommendations,(t,o)=>(s(),d($,{key:o,artist:t.artist,cover:t.cover,href:t.href,title:t.title,onPlay:()=>a.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0)])])}}});const ye=k(pe,[["__scopeId","data-v-2f517464"]]),g=e=>(H("data-v-c0ed4691"),e=e(),q(),e),me={class:"onboarding p-4"},fe=g(()=>n("h1",null,"So nice to meet you!",-1)),ve=g(()=>n("p",null,"Let's get you set up",-1)),ke={class:"grid grid-cols-2 gap-4 mt-8"},ge=g(()=>n("div",{class:"flex flex-row items-center"},[n("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),n("h2",null,"Create your first playlist")],-1)),be={class:"flex flex-row justify-end w-full"},Se={class:"flex flex-row items-center"},$e=g(()=>n("h2",null,"Import from Spotify",-1)),Pe={class:"spotify-playlists"},we=D({__name:"Onboarding",setup(e){const a=S([]),u=S(!1),c=S(null);T(),R().then(o=>{u.value=o}),fetch("/api/spotify/playlists").then(o=>o.json()).then(o=>{a.value=o});const t={fields:[{name:"name",label:"Name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",label:"Description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const o=c.value.toObject();await L(o.name,o.description)}}};return(o,O)=>(s(),i("div",me,[fe,ve,n("div",ke,[l(P,{class:"p-4"},{default:r(()=>[ge,l(V,{ref_key:"createForm",ref:c,options:t.fields},null,8,["options"]),n("div",be,[l(G,{onClick:O[0]||(O[0]=y=>t.submit.action()),icon:"add",label:t.submit.label},null,8,["label"])])]),_:1}),a.value.length?(s(),d(P,{key:0,class:"p-4"},{default:r(()=>[n("div",Se,[l(w(M),{class:"spotify mr-4"}),$e]),n("div",Pe,[(s(!0),i(h,null,p(a.value,(y,N)=>(s(),d(J,{key:N,cover:y.cover,description:y.description,title:y.name,id:y.id,spotify:!0,href:`https://open.spotify.com/playlist/${y.id}`},null,8,["cover","description","title","id","href"]))),128))])]),_:1})):_("",!0)])]))}});const Oe=k(we,[["__scopeId","data-v-c0ed4691"]]),Ne={__name:"index",setup(e){const a=F();return(u,c)=>w(a).notEmpty?(s(),d(ye,{key:0})):(s(),d(Oe,{key:1}))}};export{Ne as default};
