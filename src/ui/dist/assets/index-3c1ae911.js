import{i as O,o as v,c as S,a,t as C,aS as $,_ as P,q as w,G as q,d as x,bQ as J,bE as F,cb as T,B,cc as M,cd as z,g as s,w as g,b as A,C as y,u as m,F as H,j as K,f as I,T as N,ce as L,m as Q,n as R}from"./index-680fd85e.js";import{I as V}from"./IconButton-6b32d384.js";import{D}from"./Dropdown-ae451105.js";import{G as X}from"./gistClient-2f5db685.js";const Y={class:"material-symbols-rounded ms-wght-300 cursor-pointer"},Z={class:"checkbox__label"},ee={class:"checkbox__label__title"},le={class:"checkbox__label__sublabel italic"},te=O({__name:"Checkbox",props:{modelValue:{type:Boolean,required:!0},label:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},sublabel:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(i,{emit:d}){const n=i,p=d,r=l=>p("update:modelValue",l),b=()=>{n.disabled||r(!n.modelValue)};return(l,h)=>(v(),S("div",{class:$([{"opacity-50":i.disabled},"checkbox"]),onClick:b},[a("span",Y,C(i.modelValue?"check_box":"check_box_outline_blank"),1),a("div",Z,[a("div",ee,C(i.label),1),a("div",le,C(i.sublabel),1)])],2))}});const k=P(te,[["__scopeId","data-v-be9fa887"]]);const ae={key:0,class:"material-symbols-rounded"},se=["disabled","placeholder","type"],oe={__name:"PasswordInputWithIcon",props:{icon:String,placeholder:String,modelValue:String,disabled:Boolean},emits:["update:modelValue","change","submit"],setup(i,{emit:d}){const n=i,p=w(n.modelValue);q(()=>n.modelValue,f=>{p.value=f});const r=d,b=()=>{r("update:modelValue",p.value),r("change",p.value)},l=f=>{f.key==="Enter"&&r("submit",p)},h=w(!1);return(f,_)=>(v(),S("div",{class:$([{disabled:i.disabled},"text-input-with-icon rounded-3xl flex items-center px-4"])},[i.icon?(v(),S("span",ae,C(i.icon),1)):x("",!0),J(a("input",{"onUpdate:modelValue":_[0]||(_[0]=c=>p.value=c),disabled:i.disabled,placeholder:i.placeholder,type:h.value?"text":"password",onInput:b,onKeyup:l},null,40,se),[[F,p.value]]),a("span",{class:"material-symbols-rounded cursor-pointer",onClick:_[1]||(_[1]=c=>h.value=!h.value)},C(h.value?"visibility":"visibility_off"),1)],2))}},E=P(oe,[["__scopeId","data-v-5e026540"]]);const ne={name:"Theme",props:{name:String},methods:{selected(){return T.getCurrentTheme()==this.name},select(){T.setTheme(this.name),this.$emit("selected")}}},ie=["src"];function de(i,d,n,p,r,b){return v(),S("div",{onClick:d[0]||(d[0]=(...l)=>b.select&&b.select(...l)),class:"wrapper"},[a("p",{class:$(["mb-4",{selected:b.selected()}])},C(n.name),3),a("img",{src:`/assets/img/themes/${this.name}.svg`,class:$({selected:b.selected()})},null,10,ie)])}const ue=P(ne,[["render",de],["__scopeId","data-v-74855c2d"]]),u=i=>(Q("data-v-519432f4"),i=i(),R(),i),re={class:"p-[10px] preferences"},ce=u(()=>a("summary",{class:"cursor-pointer"},"How to",-1)),pe=u(()=>a("p",null,[A("1) Head over to the "),a("a",{href:"https://developer.spotify.com/dashboard/applications",target:"_blank"},"spotify developer dashboard")],-1)),me=u(()=>a("p",null,"2) Create An App",-1)),ve=u(()=>a("p",null,"3) Enter any name and any description",-1)),be=u(()=>a("p",null,"5) Copy and enter the client id and secret into the corresponding input field",-1)),he=u(()=>a("hr",{class:"my-4"},null,-1)),fe=u(()=>a("h5",null,"Client ID: ",-1)),_e=u(()=>a("h5",{class:"mt-4"},"Client Secret: ",-1)),ge=u(()=>a("h2",{class:"mt-[10px]"},"Player",-1)),ye=u(()=>a("h2",{class:"mt-[10px]"},"Theme",-1)),Ve={class:"themes"},ke=u(()=>a("h2",{class:"mt-[10px]"},"Sidebar",-1)),we=u(()=>a("h2",{class:"mt-[10px]"},"Cache Behaviour",-1)),Ce=u(()=>a("h2",{class:"mt-[10px]"},"Github",-1)),xe=u(()=>a("h5",{class:"mt-4"},"PAT: ",-1)),Se=u(()=>a("h5",{class:"mt-4"},"Gist ID: ",-1)),Ie=u(()=>a("h2",{class:"mt-[10px]"},"My Data",-1)),$e=O({__name:"index",setup(i){const d=w(!1),n=w({id:"",secret:""}),p=B(()=>d.value?Object.values(n.value).some(o=>o==="")?!1:n.value.id!==r.value.id||n.value.secret!==r.value.secret||d.value!==r.value.enabled:r.value.enabled),r=w({id:"",secret:"",enabled:!1});fetch("/api/config/spotify").then(async o=>{let e={id:"",secret:"",enabled:!1};if(o.status==200)e=await o.json();else if([204,401].includes(o.status))e={id:"restricted",secret:"restricted",enabled:!1};else throw new Error("Failed to fetch spotify config");r.value=e,r.value.enabled=![e.id,e.secret].includes("restricted"),d.value=r.value.enabled,n.value.id=e.id.replace("restricted",""),n.value.secret=e.secret.replace("restricted","")});const b=async()=>{if(!p.value)return;let o=n.value.id,e=n.value.secret;d.value||(e=o="restricted"),(await fetch("/api/config/spotify",{method:"POST",body:JSON.stringify({id:o,secret:e})})).ok&&(r.value={id:o,secret:e,enabled:d.value})},l=w(null),h=w("");M().then(o=>{l.value=o,h.value=JSON.stringify(o)});const f=B(()=>l.value?JSON.stringify(l.value)!==h.value:!1),_=async()=>{f.value&&(await L(l.value),h.value=JSON.stringify(l.value))},c=z(),G=["dynamic","light","dark"],W=()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},U=`http://${window.location.host}/api/spotify/callback`;return q(()=>{var o,e;return(e=(o=l.value)==null?void 0:o.github)==null?void 0:e.githubPat},async()=>{var o,e;(e=(o=l.value)==null?void 0:o.github)!=null&&e.githubPat&&(l.value.github.gistId||(l.value.github.gistId=await X.search(l.value.github.githubPat),console.log(l.value.github.gistId)))}),(o,e)=>(v(),S("div",re,[s(y,{"aria-description":"spotify",class:"p-4 pt-0"},{default:g(()=>[s(k,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),class:"h2 mb-2",label:"Spotify"},null,8,["modelValue"]),a("details",null,[ce,pe,me,ve,a("p",null,[A("4) Edit the settings: set the redirect url to "),a("a",{href:U},C(U))]),be]),he,fe,s(E,{modelValue:n.value.id,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.id=t),disabled:!d.value,icon:"token"},null,8,["modelValue","disabled"]),_e,s(E,{modelValue:n.value.secret,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.secret=t),disabled:!d.value,icon:"lock"},null,8,["modelValue","disabled"]),s(V,{disabled:!p.value,class:"ml-auto mt-4",icon:"save",label:"Save",onClick:b},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"player",class:"p-4 pt-0"},{default:g(()=>[ge,s(k,{modelValue:m(c).player.pictureInPicture,"onUpdate:modelValue":e[3]||(e[3]=t=>m(c).player.pictureInPicture=t),label:"Support Picture in Picture",sublabel:"this will slightly reduce performance"},null,8,["modelValue"]),s(D,{modelValue:m(c).player.type,"onUpdate:modelValue":e[4]||(e[4]=t=>m(c).player.type=t),options:[{value:"web",label:"Native player",icon:"horizontal_rule"},{value:"web/wave",label:"Wave player",icon:"graphic_eq"}],icon:"music_note"},null,8,["modelValue"])]),_:1}),s(y,{"aria-description":"theme",class:"p-4 pt-0"},{default:g(()=>[ye,s(k,{modelValue:m(c).ambient,"onUpdate:modelValue":e[5]||(e[5]=t=>m(c).ambient=t),disabled:!m(c).themeSupportsAmbient,label:"Ambient"},null,8,["modelValue","disabled"]),a("div",Ve,[(v(),S(H,null,K(G,(t,j)=>s(ue,{key:j,name:t},null,8,["name"])),64))])]),_:1}),s(y,{"aria-description":"sidebar",class:"p-4 pt-0"},{default:g(()=>[ke,s(k,{modelValue:m(c).sidebar.news,"onUpdate:modelValue":e[6]||(e[6]=t=>m(c).sidebar.news=t),label:"Show 'News' Tab"},null,8,["modelValue"]),s(k,{modelValue:m(c).sidebar.sports,"onUpdate:modelValue":e[7]||(e[7]=t=>m(c).sidebar.sports=t),label:"Show 'Sports' Tab"},null,8,["modelValue"])]),_:1}),s(y,{"aria-description":"cache behaviour",class:"p-4 pt-0"},{default:g(()=>[we,l.value?(v(),I(k,{key:0,modelValue:l.value.cache.preserve,"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.cache.preserve=t),label:"Preserve cache"},null,8,["modelValue"])):x("",!0),l.value?(v(),I(k,{key:1,modelValue:l.value.cache.preserveInSession,"onUpdate:modelValue":e[9]||(e[9]=t=>l.value.cache.preserveInSession=t),disabled:l.value.cache.preserve,label:"Preserve cache in session"},null,8,["modelValue","disabled"])):x("",!0),l.value?(v(),I(D,{key:2,modelValue:l.value.cache.strategy,"onUpdate:modelValue":e[10]||(e[10]=t=>l.value.cache.strategy=t),options:[{value:"all",label:"All Songs"},{value:"playlist",label:"Current Playlist"},{value:"currentNext",label:"Current + Next Song "},{value:"current",label:"Current Song Only"}],icon:"cached"},null,8,["modelValue"])):x("",!0),s(V,{disabled:!l.value||!f.value,class:"ml-auto mt-4",icon:"save",label:"Save",onClick:_},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"github settings",class:"p-4 pt-0"},{default:g(()=>[Ce,xe,l.value?(v(),I(N,{key:0,modelValue:l.value.github.githubPat,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.github.githubPat=t),icon:"lock"},null,8,["modelValue"])):x("",!0),Se,l.value?(v(),I(N,{key:1,modelValue:l.value.github.gistId,"onUpdate:modelValue":e[12]||(e[12]=t=>l.value.github.gistId=t),icon:"numbers"},null,8,["modelValue"])):x("",!0),s(V,{disabled:!l.value||!f.value,class:"ml-auto mt-4",icon:"save",label:"Save",onClick:_},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"my data",class:"p-4 pt-0"},{default:g(()=>[Ie,s(V,{class:"mx-auto mt-4",icon:"backup",label:"Back up database",onClick:e[13]||(e[13]=t=>o.$router.push("/export"))}),s(V,{class:"mx-auto mt-4",icon:"cloud_download",label:"Import database",onClick:e[14]||(e[14]=t=>o.$router.push("/import"))}),s(V,{class:"mx-auto mt-4",icon:"delete",label:"Clean browser settings",onClick:W}),s(V,{class:"mx-auto mt-4",icon:"folder",label:"Manage files",onClick:e[15]||(e[15]=t=>o.$router.push("/preferences/my-data"))})]),_:1})]))}});const De=P($e,[["__scopeId","data-v-519432f4"]]);export{De as default};
