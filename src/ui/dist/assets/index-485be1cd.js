import{_ as I,f as R,o as a,c,g as _,w as x,l as te,m as se,a as s,C as K,H as V,i as y,t as b,d as g,e as E,n as f,D as B,F as D,h as A,L,j as ne,B as N,q as ie,E as j,J as re,M as G,K as X,N as C,O as M,b as ce,Q as Z,A as ue,R as de}from"./index-c823397e.js";import{F as P}from"./FullShelf-b0900b58.js";import{P as _e}from"./Playlist-73a5ded5.js";import{P as ee}from"./PlaylistItem-b72ab729.js";import{p as ve}from"./playerInPicture-af203fdf.js";const pe={name:"CollectionHeader",props:{href:String}},q=v=>(te("data-v-a26d5560"),v=v(),se(),v),me={class:"wrapper"},fe=q(()=>s("div",{class:"collection"},"Playlists",-1)),he=q(()=>s("div",{class:"collection"},"Releases",-1)),ye=q(()=>s("div",{class:"collection"},"Artists",-1)),ge=q(()=>s("div",{class:"collection"},"Albums",-1));function xe(v,u,e,m,p,i){const n=R("router-link");return a(),c("div",me,[_(n,{class:"link",to:"/collection/playlists"},{default:x(()=>[fe]),_:1}),_(n,{class:"link",to:"/collection/releases"},{default:x(()=>[he]),_:1}),_(n,{class:"link",to:"/collection/artists"},{default:x(()=>[ye]),_:1}),_(n,{class:"link",to:"/collection/albums"},{default:x(()=>[ge]),_:1})])}const we=I(pe,[["render",xe],["__scopeId","data-v-a26d5560"]]),ke={components:{Card:K,Cover:V},name:"CardWithImageAndText",props:{cover:String,title:String,description:String,playlistType:{type:String,default:null},imageType:{type:String,default:"playlist"}}};const $e={class:"item"},Ce={class:"title"},be={key:0,class:"material-symbols-rounded"},Se=["innerHTML"];function Ie(v,u,e,m,p,i){const n=R("Cover"),l=R("Card");return a(),y(l,{class:"wrapper drop-shadow-md","with-hover":""},{default:x(()=>[s("div",$e,[_(n,{src:e.cover,type:e.imageType,name:e.title},null,8,["src","type","name"]),s("div",Ce,[[null,"classic"].includes(e.playlistType)?g("",!0):(a(),c("span",be,b(e.playlistType=="smart"?"neurology":"bolt"),1)),s("h4",null,b(e.title),1)]),s("p",{class:"text-muted text-xs hideIfMobile",innerHTML:e.description},null,8,Se)])]),_:1})}const le=I(ke,[["render",Ie],["__scopeId","data-v-847f5a33"]]),Te={key:0},De={class:"albums"},Ae={key:1,class:"fill-page"},Me=E({__name:"Albums",setup(v){const u=f([]),e=f(!0);return B(async()=>{const p=await(await fetch("/api/albums")).json();u.value=p.sort((i,n)=>i.name.localeCompare(n.name)),e.value=!1}),(m,p)=>e.value?(a(),c("div",Ae,[_(L)])):(a(),c("div",Te,[s("div",De,[_(P,{heading:"In your library"},{default:x(()=>[(a(!0),c(D,null,A(u.value,i=>(a(),y(le,{title:i.name,description:i.artists.join(", "),cover:i.image,onClick:n=>m.$router.push(i.href),imageType:"album"},null,8,["title","description","cover","onClick"]))),256))]),_:1})])]))}});const Re=I(Me,[["__scopeId","data-v-b6c57ca8"]]),Pe={key:1,class:"playlists"},Ee=E({__name:"Playlists",setup(v){const u=ne(),e=N(()=>u.playlists),m=f([]),p=f(!0);return B(async()=>{const n=await(await fetch("/api/spotify/playlists")).json();m.value=n,p.value=!1}),(i,n)=>p.value?(a(),y(L,{key:0})):(a(),c("div",Pe,[e.value.length?(a(),y(P,{key:0,heading:"Playlists"},{default:x(()=>[(a(!0),c(D,null,A(e.value,(l,k)=>(a(),y(_e,{key:k,cover:l.cover,href:l==null?void 0:l.href,name:l.name,type:l.type,id:l.id},null,8,["cover","href","name","type","id"]))),128))]),_:1})):g("",!0),m.value.length?(a(),y(P,{key:1,heading:"Import From Spotify"},{default:x(()=>[_(ee,{title:"Liked",description:"your liked tracks",spotify:!0,id:"liked"}),(a(!0),c(D,null,A(m.value,(l,k)=>(a(),y(ee,{key:k,cover:l.cover,description:l.description,title:l.name,id:l.id,spotify:!0,href:`https://open.spotify.com/playlist/${l.id}`},null,8,["cover","description","title","id","href"]))),128))]),_:1})):g("",!0)]))}}),Q=v=>(te("data-v-a22e8b2e"),v=v(),se(),v),Fe={key:0,class:"fill-page"},je={key:1,class:"p-4 overflow-hidden h-full"},Ne={class:"releases w-full"},Be={class:"current"},Le={key:0,class:"w-max flex flex-col gap-4"},qe={class:"flex justify-between w-full items-center"},He={class:"flex gap-4 items-center"},Oe={class:"info"},Ye={key:0},Je={key:1,class:"m-0 text-muted text-sm"},Ve=["title"],Ke={class:"actions"},Qe={key:1,class:"h-96 flex flex-col justify-center"},We=Q(()=>s("span",{class:"italic text-sm text-muted"}," Nothing to preview ",-1)),ze=[We],Ue={class:"flex items-center gap-4 w-max"},Ge={key:0,class:"flex justify-end mb-2"},Xe=Q(()=>s("span",{class:"material-symbols-rounded"}," done_all ",-1)),Ze={class:"entries overflow-y-auto flex flex-col gap-2"},et=["onClick"],tt={class:"info overflow-hidden"},st={class:"m-0 overflow-hidden"},lt={class:"m-0 overflow-hidden text-sm text-muted"},at=["title"],ot=["onClick"],nt=["onClick"],it=["onClick"],rt={key:1,class:"flex flex-col items-center"},ct=Q(()=>s("span",{class:"italic text-sm text-muted"}," No releases in this queue ",-1)),ut=[ct],Y="reap.releases.seen",J="reap.releases.remember",dt=E({__name:"Releases",setup(v){const u=f(!0),e=f("unseen"),m=o=>{const t=new Date(o),h=Math.floor((Date.now()-t.getTime())/1e3/60/60/24);return h==0?"Today":h==1?"Yesterday":h<100?`${h} days ago`:h<365?`${Math.floor(h/30)} months ago`:t.toLocaleDateString()},p=ie();j(e,o=>{const t={queue:o};p.replace({query:t})});const i=N(()=>{switch(e.value){case"unseen":return T.value.filter(o=>!$.value.includes(o.url));case"out-today":return ae.value;case"watching":return w.value;case"all":return T.value;case"seen":return $.value.map(o=>T.value.find(t=>t.url==o)).filter(o=>o)}}),n=o=>{ve(o.artist,o.title,o.url)},l=f(null),k=f(null),H=new Date,T=f([]),W=o=>{l.value=o,Z(()=>{var t;(t=k.value)==null||t.show()})},ae=N(()=>T.value.filter(o=>{const t=new Date(o.releaseDate);return H.getMonth()==t.getMonth()&&H.getDate()==t.getDate()&&H.getFullYear()==t.getFullYear()})),z=o=>{w.value.find(t=>t.url==o.url)||w.value.push(o)},U=o=>{w.value=w.value.filter(t=>t.url!=o.url)},O=o=>{var h;let t=!1;o.url===((h=d.value)==null?void 0:h.url)&&(t=!0),$.value.includes(o.url)||$.value.push(o.url),t&&Z(()=>n(d.value))},$=f([]),w=f([]),d=f(null);return B(async()=>{var t;u.value=!0;const o=await fetch("/api/releases");T.value=await o.json(),u.value=!1,$.value=((t=localStorage.getItem(Y))==null?void 0:t.split(","))??[],$.value=$.value.filter(h=>T.value.find(F=>F.url==h)),w.value=JSON.parse(localStorage.getItem(J)??"[]")}),j(i,o=>{d.value=o[0]??null}),j($,o=>{o.length?localStorage.setItem(Y,o.join(",")):localStorage.removeItem(Y)},{deep:!0}),j(w,o=>{o.length?localStorage.setItem(J,JSON.stringify(o)):localStorage.removeItem(J)},{deep:!0}),(o,t)=>{var h,F;return u.value?(a(),c("div",Fe,[_(L)])):(a(),c("div",je,[l.value?(a(),y(re,{key:0,id:(h=l.value.url)==null?void 0:h.replace("https://open.spotify.com/album/",""),ref_key:"addReleaseRef",ref:k,album:{id:(F=l.value.url)==null?void 0:F.replace("https://open.spotify.com/album/",""),title:l.value.title,artist:l.value.artists.join(", "),cover:l.value.cover,href:l.value.url,releaseDate:l.value.releaseDate},artist:l.value.artist,cover:l.value.cover,href:l.value.url,title:l.value.title},null,8,["id","album","artist","cover","href","title"])):g("",!0),s("div",Ne,[s("div",Be,[d.value?(a(),c("div",Le,[d.value?(a(),y(V,{key:0,class:"rounded-3xl",src:d.value.cover},null,8,["src"])):g("",!0),s("div",qe,[s("div",He,[s("span",{class:"preview material-symbols-rounded ms-fill text-5xl cursor-pointer",onClick:t[0]||(t[0]=r=>n(d.value))}," play_circle "),s("div",Oe,[d.value?(a(),c("h3",Ye,[_(G,{text:d.value.title},null,8,["text"])])):g("",!0),d.value?(a(),c("p",Je,[_(X,{artist:d.value.artist},null,8,["artist"])])):g("",!0),d.value?(a(),c("p",{key:2,class:"m-0 text-muted text-xs",title:d.value.releaseDate},b(m(d.value.releaseDate)),9,Ve)):g("",!0)])]),s("div",Ke,[s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:t[1]||(t[1]=C(r=>W(d.value),["stop"])),title:"Add to playlist"}," add "),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:t[2]||(t[2]=C(r=>w.value.find(S=>S.url===d.value.url)?U(d.value):z(d.value),["stop"])),title:"Pin"},b(w.value.find(r=>r.url===d.value.url)?"playlist_remove":"push_pin"),1),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:t[3]||(t[3]=C(r=>O(d.value),["stop"])),title:"Mark as seen"}," done_all ")])])])):(a(),c("div",Qe,ze))]),_(K,{class:"queue w-full p-2 h-full flex flex-col gap-2 relative"},{default:x(()=>[s("div",Ue,[s("h5",{class:M(["cursor-pointer",{selected:e.value=="unseen"}]),onClick:t[4]||(t[4]=r=>e.value="unseen")}," Unseen ",2),s("h5",{class:M(["cursor-pointer",{selected:e.value=="out-today"}]),onClick:t[5]||(t[5]=r=>e.value="out-today")}," Out Today ",2),s("h5",{class:M(["cursor-pointer",{selected:e.value=="watching"}]),onClick:t[6]||(t[6]=r=>e.value="watching")}," Pinned ",2),s("h5",{class:M(["cursor-pointer",{selected:e.value=="seen"}]),onClick:t[7]||(t[7]=r=>e.value="seen")}," Seen ",2),s("h5",{class:M(["cursor-pointer",{selected:e.value=="all"}]),onClick:t[8]||(t[8]=r=>e.value="all")}," All ",2)]),e.value==="unseen"&&i.value.length?(a(),c("div",Ge,[s("span",{class:"cursor-pointer text-sm text-muted hover:text-primary flex items-center gap-2",onClick:t[9]||(t[9]=r=>i.value.forEach(O))},[ce(" Mark all as seen "),Xe])])):g("",!0),s("div",Ze,[i.value.length?(a(!0),c(D,{key:0},A(i.value,r=>(a(),c("div",{class:"entry",onClick:S=>{d.value=r,n(r)}},[_(V,{class:"rounded-xl",src:r.cover},null,8,["src"]),s("div",tt,[s("p",st,[_(G,{text:r.title},null,8,["text"])]),s("p",lt,[_(X,{artist:r.artist},null,8,["artist"])])]),s("p",{class:"text-sm m-0 text-muted",title:r.releaseDate},b(m(r.releaseDate)),9,at),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:C(S=>W(r),["stop"]),title:"Add to playlist"}," add ",8,ot),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:C(S=>w.value.find(oe=>oe.url===r.url)?U(r):z(r),["stop"]),title:"Pin"},b(w.value.find(S=>S.url===r.url)?"playlist_remove":"push_pin"),9,nt),s("span",{class:"material-symbols-rounded cursor-pointer text-muted hover:text-primary",onClick:C(S=>O(r),["stop"]),title:"Mark as seen"}," done_all ",8,it)],8,et))),256)):g("",!0)]),i.value.length?g("",!0):(a(),c("div",rt,ut))]),_:1})])]))}}});const _t=I(dt,[["__scopeId","data-v-a22e8b2e"]]);const vt={components:{Card:K},name:"ArtistItem",methods:{follow(v){v.stopPropagation();const u=this.following?"DELETE":"POST";fetch("/api/spotify/following",{method:u,body:JSON.stringify({artistId:this.id})}).then(e=>{e.status==200&&(this.following=!this.following)})}},data(){return{following:this.initiallyFollowing}},props:{cover:String,name:String,description:String,id:String,initiallyFollowing:Boolean,showFollowButton:Boolean}},pt={class:"item"},mt=["src"],ft=["innerHTML"];function ht(v,u,e,m,p,i){const n=R("add-artist-to-playlist"),l=R("Card");return a(),y(l,{class:"wrapper","with-hover":"",onClick:u[1]||(u[1]=C(k=>v.$router.push("/artist/"+e.name),["stop"]))},{default:x(()=>[_(n,{ref:"import",artist:{id:e.id,name:e.name,href:`https://open.spotify.com/artist/${e.id}`,image:e.cover}},null,8,["artist"]),s("div",pt,[s("img",{src:e.cover},null,8,mt),s("h4",null,b(e.name),1),s("p",{innerHTML:e.description},null,8,ft),e.showFollowButton?(a(),c("button",{key:0,class:"followButton",onClick:u[0]||(u[0]=C((...k)=>i.follow&&i.follow(...k),["stop"]))},b(p.following?"unfollow":"Follow"),1)):g("",!0)])]),_:1})}const yt=I(vt,[["render",ht],["__scopeId","data-v-353b4692"]]),gt={key:0},xt={class:"artists"},wt={key:1,class:"fill-page"},kt=E({__name:"Artists",setup(v){const u=f([]),e=f([]),m=f(!0);return B(async()=>{let p=await fetch("/api/spotify/artists"),i=await p.json();u.value=i.sort((n,l)=>n.name.localeCompare(l.name)),p=await fetch("/api/artists"),i=await p.json(),e.value=i.sort((n,l)=>n.name.localeCompare(l.name)),m.value=!1}),(p,i)=>m.value?(a(),c("div",wt,[_(L)])):(a(),c("div",gt,[s("div",xt,[_(P,{heading:"In your library"},{default:x(()=>[(a(!0),c(D,null,A(e.value,n=>(a(),y(le,{title:n.name,cover:n.image,onClick:l=>p.$router.push(`/artist/${n.name}`),imageType:"artist"},null,8,["title","cover","onClick"]))),256))]),_:1}),_(P,{heading:"Following on Spotify"},{default:x(()=>[(a(!0),c(D,null,A(u.value,(n,l)=>(a(),y(yt,{id:n.id,key:l,cover:n.cover,description:n.description,name:n.name,"initially-following":"","show-follow-button":""},null,8,["id","cover","description","name"]))),128))]),_:1})])]))}});const $t=I(kt,[["__scopeId","data-v-9243eece"]]),Ct={class:"parent"},bt=E({__name:"index",setup(v){const u=ue(),e=N(()=>{switch(u.path.split("/")[2]){case"albums":return Re;case"playlists":return Ee;case"releases":return _t;case"artists":return $t}});return(m,p)=>(a(),c("div",Ct,[_(we,{class:"header"}),s("main",null,[(a(),y(de(e.value)))])]))}});const Mt=I(bt,[["__scopeId","data-v-08abc76b"]]);export{Mt as default};
