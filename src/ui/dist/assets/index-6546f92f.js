import{n as D,o as v,c as C,a as t,t as w,aA as $,_ as P,q as k,bs as J,d as x,by as j,bl as F,A as N,bY as M,bZ as z,g as s,w as _,C as y,b as O,u as r,F as G,i as H,f as I,bN as T,b_ as K,l as L,m as R}from"./index-73e4032e.js";import{I as g}from"./IconButton-8ea97c6a.js";import{D as B}from"./Dropdown-83fafee8.js";const Y={class:"material-symbols-rounded ms-wght-300 cursor-pointer"},Z={class:"checkbox__label"},Q={class:"checkbox__label__title"},X={class:"checkbox__label__sublabel italic"},ee=D({__name:"Checkbox",props:{modelValue:{type:Boolean,required:!0},label:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},sublabel:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(n,{emit:i}){const o=n,p=m=>i("update:modelValue",m),c=()=>{o.disabled||p(!o.modelValue)};return(m,l)=>(v(),C("div",{class:$([{"opacity-50":n.disabled},"checkbox"]),onClick:c},[t("span",Y,w(n.modelValue?"check_box":"check_box_outline_blank"),1),t("div",Z,[t("div",Q,w(n.label),1),t("div",X,w(n.sublabel),1)])],2))}});const V=P(ee,[["__scopeId","data-v-982c4110"]]);const le={key:0,class:"material-symbols-rounded"},ae=["disabled","placeholder","type"],te={__name:"PasswordInputWithIcon",props:{icon:String,placeholder:String,modelValue:String,disabled:Boolean},emits:["update:modelValue","change","submit"],setup(n,{emit:i}){const o=n,p=k(o.modelValue);J(()=>o.modelValue,h=>{p.value=h});const c=()=>{i("update:modelValue",p.value),i("change",p.value)},m=h=>{h.key==="Enter"&&i("submit",p)},l=k(!1);return(h,f)=>(v(),C("div",{class:$([{disabled:n.disabled},"text-input-with-icon rounded-3xl flex items-center px-4"])},[n.icon?(v(),C("span",le,w(n.icon),1)):x("",!0),j(t("input",{"onUpdate:modelValue":f[0]||(f[0]=S=>p.value=S),disabled:n.disabled,placeholder:n.placeholder,type:l.value?"text":"password",onInput:c,onKeyup:m},null,40,ae),[[F,p.value]]),t("span",{class:"material-symbols-rounded cursor-pointer",onClick:f[1]||(f[1]=S=>l.value=!l.value)},w(l.value?"visibility":"visibility_off"),1)],2))}},A=P(te,[["__scopeId","data-v-5e026540"]]);const se={name:"Theme",props:{name:String},methods:{selected(){return window.getCurrentTheme()==this.name},select(){window.setTheme(this.name),this.$emit("selected")}}},oe=["src"];function ne(n,i,o,p,c,m){return v(),C("div",{onClick:i[0]||(i[0]=(...l)=>m.select&&m.select(...l)),class:"wrapper"},[t("p",{class:$(["mb-4",{selected:m.selected()}])},w(o.name),3),t("img",{src:`/assets/img/themes/${this.name}.svg`,class:$({selected:m.selected()})},null,10,oe)])}const ie=P(se,[["render",ne],["__scopeId","data-v-5dea6f6a"]]),u=n=>(L("data-v-cf08ed53"),n=n(),R(),n),de={class:"p-[10px] preferences"},ue=u(()=>t("summary",{class:"cursor-pointer"},"How to",-1)),re=u(()=>t("p",null,[O("1) Head over to the "),t("a",{href:"https://developer.spotify.com/dashboard/applications",target:"_blank"},"spotify developer dashboard")],-1)),ce=u(()=>t("p",null,"2) Create An App",-1)),pe=u(()=>t("p",null,"3) Enter any name and any description",-1)),me=u(()=>t("p",null,"5) Copy and enter the client id and secret into the corresponding input field",-1)),be=u(()=>t("hr",{class:"my-4"},null,-1)),ve=u(()=>t("h5",null,"Client ID: ",-1)),he=u(()=>t("h5",{class:"mt-4"},"Client Secret: ",-1)),fe=u(()=>t("h2",{class:"mt-[10px]"},"Player",-1)),_e=u(()=>t("h2",{class:"mt-[10px]"},"Theme",-1)),ye={class:"themes"},ge=u(()=>t("h2",{class:"mt-[10px]"},"Sidebar",-1)),Ve=u(()=>t("h2",{class:"mt-[10px]"},"Cache Behaviour",-1)),ke=u(()=>t("h2",{class:"mt-[10px]"},"Github",-1)),we=u(()=>t("h5",{class:"mt-4"},"PAT: ",-1)),xe=u(()=>t("h5",{class:"mt-4"},"Gist ID: ",-1)),Ce=u(()=>t("h2",{class:"mt-[10px]"},"My Data",-1)),Se=D({__name:"index",setup(n){const i=k(!1),o=k({id:"",secret:""}),p=N(()=>i.value?Object.values(o.value).some(d=>d==="")?!1:o.value.id!==c.value.id||o.value.secret!==c.value.secret||i.value!==c.value.enabled:c.value.enabled),c=k({id:"",secret:"",enabled:!1});fetch("/api/config/spotify").then(async d=>{let e={id:"",secret:"",enabled:!1};if(d.status==200)e=await d.json();else if([204,401].includes(d.status))e={id:"restricted",secret:"restricted",enabled:!1};else throw new Error("Failed to fetch spotify config");c.value=e,c.value.enabled=![e.id,e.secret].includes("restricted"),i.value=c.value.enabled,o.value.id=e.id.replace("restricted",""),o.value.secret=e.secret.replace("restricted","")});const m=async()=>{if(!p.value)return;let d=o.value.id,e=o.value.secret;i.value||(e=d="restricted"),(await fetch("/api/config/spotify",{method:"POST",body:JSON.stringify({id:d,secret:e})})).ok&&(c.value={id:d,secret:e,enabled:i.value})},l=k(null),h=k("");M().then(d=>{l.value=d,h.value=JSON.stringify(d)});const f=N(()=>l.value?JSON.stringify(l.value)!==h.value:!1),S=async()=>{f.value&&(await K(l.value),h.value=JSON.stringify(l.value))},b=z(),q=["dynamic","light","dark"],E=()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},U=`http://${window.location.host}/api/spotify/callback`;return(d,e)=>(v(),C("div",de,[s(y,{"aria-description":"spotify",class:"p-4 pt-0"},{default:_(()=>[s(V,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),class:"h2 mb-2",label:"Spotify"},null,8,["modelValue"]),t("details",null,[ue,re,ce,pe,t("p",null,[O("4) Edit the settings: set the redirect url to "),t("a",{href:U},w(U))]),me]),be,ve,s(A,{modelValue:o.value.id,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.id=a),disabled:!i.value,icon:"token"},null,8,["modelValue","disabled"]),he,s(A,{modelValue:o.value.secret,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.secret=a),disabled:!i.value,icon:"lock"},null,8,["modelValue","disabled"]),s(g,{disabled:!r(p),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:m},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"player",class:"p-4 pt-0"},{default:_(()=>[fe,s(V,{modelValue:r(b).player.pictureInPicture,"onUpdate:modelValue":e[3]||(e[3]=a=>r(b).player.pictureInPicture=a),label:"Support Picture in Picture",sublabel:"this will slightly reduce performance"},null,8,["modelValue"]),s(B,{modelValue:r(b).player.type,"onUpdate:modelValue":e[4]||(e[4]=a=>r(b).player.type=a),options:[{value:"web",label:"Native player",icon:"horizontal_rule"},{value:"web/wave",label:"Wave player",icon:"graphic_eq"}],icon:"music_note"},null,8,["modelValue"])]),_:1}),s(y,{"aria-description":"theme",class:"p-4 pt-0"},{default:_(()=>[_e,s(V,{modelValue:r(b).ambient,"onUpdate:modelValue":e[5]||(e[5]=a=>r(b).ambient=a),disabled:!r(b).themeSupportsAmbient,label:"Ambient"},null,8,["modelValue","disabled"]),t("div",ye,[(v(),C(G,null,H(q,(a,W)=>s(ie,{key:W,name:a},null,8,["name"])),64))])]),_:1}),s(y,{"aria-description":"sidebar",class:"p-4 pt-0"},{default:_(()=>[ge,s(V,{modelValue:r(b).sidebar.news,"onUpdate:modelValue":e[6]||(e[6]=a=>r(b).sidebar.news=a),label:"Show 'News' Tab"},null,8,["modelValue"]),s(V,{modelValue:r(b).sidebar.sports,"onUpdate:modelValue":e[7]||(e[7]=a=>r(b).sidebar.sports=a),label:"Show 'Sports' Tab"},null,8,["modelValue"])]),_:1}),s(y,{"aria-description":"cache behaviour",class:"p-4 pt-0"},{default:_(()=>[Ve,l.value?(v(),I(V,{key:0,modelValue:l.value.cache.preserve,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.cache.preserve=a),label:"Preserve cache"},null,8,["modelValue"])):x("",!0),l.value?(v(),I(V,{key:1,modelValue:l.value.cache.preserveInSession,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.cache.preserveInSession=a),disabled:l.value.cache.preserve,label:"Preserve cache in session"},null,8,["modelValue","disabled"])):x("",!0),l.value?(v(),I(B,{key:2,modelValue:l.value.cache.strategy,"onUpdate:modelValue":e[10]||(e[10]=a=>l.value.cache.strategy=a),options:[{value:"all",label:"All Songs"},{value:"playlist",label:"Current Playlist"},{value:"currentNext",label:"Current + Next Song "},{value:"current",label:"Current Song Only"}],icon:"cached"},null,8,["modelValue"])):x("",!0),s(g,{disabled:!l.value||!r(f),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:S},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"github settings",class:"p-4 pt-0"},{default:_(()=>[ke,we,l.value?(v(),I(T,{key:0,modelValue:l.value.github.githubPat,"onUpdate:modelValue":e[11]||(e[11]=a=>l.value.github.githubPat=a),icon:"lock"},null,8,["modelValue"])):x("",!0),xe,l.value?(v(),I(T,{key:1,modelValue:l.value.github.gistId,"onUpdate:modelValue":e[12]||(e[12]=a=>l.value.github.gistId=a),icon:"numbers"},null,8,["modelValue"])):x("",!0),s(g,{disabled:!l.value||!r(f),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:S},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"my data",class:"p-4 pt-0"},{default:_(()=>[Ce,s(g,{class:"mx-auto mt-4",icon:"backup",label:"Back up database",onClick:e[13]||(e[13]=a=>d.$router.push("/export"))}),s(g,{class:"mx-auto mt-4",icon:"cloud_download",label:"Import database",onClick:e[14]||(e[14]=a=>d.$router.push("/import"))}),s(g,{class:"mx-auto mt-4",icon:"delete",label:"Clean browser settings",onClick:E}),s(g,{class:"mx-auto mt-4",icon:"folder",label:"Manage files",onClick:e[15]||(e[15]=a=>d.$router.push("/preferences/my-data"))})]),_:1})]))}});const Ne=P(Se,[["__scopeId","data-v-cf08ed53"]]);export{Ne as default};
