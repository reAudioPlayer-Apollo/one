import{_ as $,o as l,c as n,a,b as m,t as O,d as _,r as E,e as D,f as T,g as i,w as d,F as p,h,i as u,P as x,u as P,p as q,j as F,k as b,l as H,m as N,n as v,q as j,s as M,v as R,I as V,C,x as G,y as L}from"./index-2d688a36.js";import{P as B}from"./PlaylistCard-69d30faf.js";import{T as S}from"./TrackCompact-3cd1b7d2.js";import{P as I}from"./PlaylistEntry-87c53dc9.js";import{s as J}from"./spotify-928835cf.js";import"./playerInPicture-af203fdf.js";import"./EditSong.vue_vue_type_script_setup_true_lang-20543fe4.js";const W={name:"FlexShelf",props:{heading:String,icon:String}},z={class:"shelf"},A={class:"header"},K={key:0},Q={key:0,class:"icon material-symbols-round"},U={class:"items"};function X(e,s,r,c,t,o){return l(),n("div",z,[a("div",A,[r.heading||r.icon?(l(),n("h2",K,[m(O(r.heading),1),r.icon?(l(),n("span",Q,O(r.icon),1)):_("",!0)])):_("",!0)]),a("div",U,[E(e.$slots,"default",{},void 0,!0)])])}const f=$(W,[["render",X],["__scopeId","data-v-27a92662"]]),y=e=>(H("data-v-821ad28e"),e=e(),N(),e),Y={class:"home"},Z={class:"main"},ee={key:0,class:"playlists"},te={key:1,class:"breaking"},se={key:2,class:"liked"},le={class:"side"},ae={key:0,class:"releases"},oe=y(()=>a("span",{class:"material-symbols-rounded ms-fill"}," radar ",-1)),ne=y(()=>a("span",{class:"hover:underline"}," Out now ",-1)),ie={key:1,class:"disovery"},re=y(()=>a("span",{class:"material-symbols-rounded ms-fill"}," explore ",-1)),ce=y(()=>a("span",{class:"hover:underline"}," Discover ",-1)),de={key:2,class:"recommendations"},ue=y(()=>a("h2",{class:"flex items-center gap-2"},[a("span",{class:"material-symbols-rounded ms-fill"}," recommend "),m(" Suggested ")],-1)),_e={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],recommendations:[],data:F()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists},liked(){return b("liked").songs.slice(0,3)},breaking(){return b("breaking").songs.slice(0,3)}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const s=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.source||e.url||e.href}});window.dispatchEvent(s)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=this.playlists.map(e=>{var s;return((s=b(e.id))==null?void 0:s.songs)||[]}).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},pe=D({..._e,setup(e){return(s,r)=>{const c=T("router-link");return l(),n("div",Y,[a("div",Z,[s.playlists.length?(l(),n("div",ee,[a("h2",null,[i(c,{class:"linkOnHover",to:"/collection/playlists"},{default:d(()=>[m("Playlists")]),_:1})]),i(f,null,{default:d(()=>[(l(!0),n(p,null,h(s.playlists,t=>(l(),u(B,{playlist:t},null,8,["playlist"]))),256))]),_:1})])):_("",!0),s.breaking.length?(l(),n("div",te,[a("h2",null,[i(c,{class:"linkOnHover",to:"/collection/tracks/breaking"},{default:d(()=>[m(" Breaking Songs ")]),_:1})]),i(x),(l(!0),n(p,null,h(s.breaking,(t,o)=>(l(),u(I,{key:o,index:o,"playlist-id":"breaking",song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0),s.liked.length?(l(),n("div",se,[a("h2",null,[i(c,{class:"linkOnHover",to:"/collection/tracks"},{default:d(()=>[m("Liked Songs")]),_:1})]),i(x),(l(!0),n(p,null,h(s.liked,(t,o)=>(l(),u(I,{key:o,index:o,"playlist-id":"liked",song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0)]),a("div",le,[s.releases.length?(l(),n("div",ae,[a("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/releases"},{default:d(()=>[oe,ne]),_:1})]),i(f,null,{default:d(()=>[(l(!0),n(p,null,h(s.releases,(t,o)=>(l(),u(S,{key:o,artist:t.artist,cover:t.cover,href:t.url,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.picks.length?(l(),n("div",ie,[a("h2",null,[i(c,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/discover"},{default:d(()=>[re,ce]),_:1})]),i(f,null,{default:d(()=>[(l(!0),n(p,null,h(s.picks,(t,o)=>(l(),u(S,{id:t.id,key:o,artist:t.artist,cover:P(q)(t.cover),href:t.href,title:t.title,onPlay:()=>s.playDiscover(t)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.recommendations.length?(l(),n("div",de,[ue,i(f,null,{default:d(()=>[(l(!0),n(p,null,h(s.recommendations,(t,o)=>(l(),u(S,{key:o,artist:t.artist,cover:t.cover,href:t.href,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0)])])}}});const he=$(pe,[["__scopeId","data-v-821ad28e"]]),k=e=>(H("data-v-11ca0bec"),e=e(),N(),e),me={class:"onboarding p-4"},ye=k(()=>a("h1",null,"So nice to meet you!",-1)),fe=k(()=>a("p",null,"Let's get you set up",-1)),ve={class:"grid grid-cols-2 gap-4 mt-8"},ke=k(()=>a("div",{class:"flex flex-row items-center"},[a("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),a("h2",null,"Create your first playlist")],-1)),ge={class:"flex flex-row justify-end w-full"},be={class:"flex flex-row items-center"},Se=k(()=>a("h2",null,"Import from Spotify",-1)),$e={class:"spotify-playlists"},Pe=D({__name:"Onboarding",setup(e){const s=v([]),r=v(!1),c=v(null);j(),M().then(o=>{r.value=o}),fetch("/api/spotify/playlists").then(o=>o.json()).then(o=>{s.value=o});const t={fields:[{name:"name",label:"Name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",label:"Description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const o=c.value.toObject();await G(o.name,o.description)}}};return(o,w)=>(l(),n("div",me,[ye,fe,a("div",ve,[i(C,{class:"p-4"},{default:d(()=>[ke,i(R,{ref_key:"createForm",ref:c,options:t.fields},null,8,["options"]),a("div",ge,[i(V,{onClick:w[0]||(w[0]=g=>t.submit.action()),icon:"add",label:t.submit.label},null,8,["label"])])]),_:1}),s.value.length?(l(),u(C,{key:0,class:"p-4"},{default:d(()=>[a("div",be,[i(P(J),{class:"spotify mr-4"}),Se]),a("div",$e,[(l(!0),n(p,null,h(s.value,g=>(l(),u(B,{playlist:{...g,type:"classic",plays:0,href:`https://open.spotify.com/playlist/${g.id}`},"is-spotify":""},null,8,["playlist"]))),256))])]),_:1})):_("",!0)])]))}});const we=$(Pe,[["__scopeId","data-v-11ca0bec"]]),Ne={__name:"index",setup(e){const s=F(),r=v(!1),c=j();return L(()=>{document.body.clientWidth<768&&(r.value=!0,c.push("/collection/playlist"))}),(t,o)=>P(s).notEmpty||r.value?(l(),u(he,{key:0})):(l(),u(we,{key:1}))}};export{Ne as default};
