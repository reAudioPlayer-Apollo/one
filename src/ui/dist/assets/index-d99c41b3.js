import{m as D,o as v,c as k,a as l,t as y,C as I,_ as $,n as _,D as W,d as S,y as j,z,E as B,bP as A,bQ as F,g as s,w as g,b as E,u as m,F as M,i as H,f as P,bR as R,k as K,l as L}from"./index-b47f60f1.js";import{C as V}from"./Card-f847fc50.js";import{I as w,D as U}from"./Dropdown-d5739a06.js";const Q={class:"material-symbols-rounded ms-wght-300 cursor-pointer"},G={class:"checkbox__label"},X={class:"checkbox__label__title"},Y={class:"checkbox__label__sublabel italic"},Z=D({__name:"Checkbox",props:{modelValue:{type:Boolean,required:!0},label:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},sublabel:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(n,{emit:i}){const o=n,c=p=>i("update:modelValue",p),r=()=>{o.disabled||c(!o.modelValue)};return(p,t)=>(v(),k("div",{class:I([{"opacity-50":n.disabled},"checkbox"]),onClick:r},[l("span",Q,y(n.modelValue?"check_box":"check_box_outline_blank"),1),l("div",G,[l("div",X,y(n.label),1),l("div",Y,y(n.sublabel),1)])],2))}});const C=$(Z,[["__scopeId","data-v-982c4110"]]);const ee={key:0,class:"material-symbols-rounded"},le=["type","placeholder","disabled"],ae={__name:"PasswordInputWithIcon",props:{icon:String,placeholder:String,modelValue:String,disabled:Boolean},emits:["update:modelValue","change","submit"],setup(n,{emit:i}){const o=n,c=_(o.modelValue);W(()=>o.modelValue,b=>{c.value=b});const r=()=>{i("update:modelValue",c.value),i("change",c.value)},p=b=>{b.key==="Enter"&&i("submit",c)},t=_(!1);return(b,h)=>(v(),k("div",{class:I(["text-input-with-icon rounded-3xl flex items-center px-4",{disabled:n.disabled}])},[n.icon?(v(),k("span",ee,y(n.icon),1)):S("",!0),j(l("input",{type:t.value?"text":"password","onUpdate:modelValue":h[0]||(h[0]=x=>c.value=x),onInput:r,onKeyup:p,placeholder:n.placeholder,disabled:n.disabled},null,40,le),[[z,c.value]]),l("span",{class:"material-symbols-rounded cursor-pointer",onClick:h[1]||(h[1]=x=>t.value=!t.value)},y(t.value?"visibility":"visibility_off"),1)],2))}},T=$(ae,[["__scopeId","data-v-8326799a"]]);const te={name:"Theme",props:{name:String},methods:{selected(){return window.getCurrentTheme()==this.name},select(){window.setTheme(this.name),this.$emit("selected")}}},se=["src"];function oe(n,i,o,c,r,p){return v(),k("div",{onClick:i[0]||(i[0]=(...t)=>p.select&&p.select(...t)),class:"wrapper"},[l("p",{class:I(["mb-4",{selected:p.selected()}])},y(o.name),3),l("img",{src:`/assets/img/themes/${this.name}.svg`,class:I({selected:p.selected()})},null,10,se)])}const ne=$(te,[["render",oe],["__scopeId","data-v-5dea6f6a"]]),u=n=>(K("data-v-a2afed4f"),n=n(),L(),n),ie={class:"p-[10px] preferences"},de=u(()=>l("summary",{class:"cursor-pointer"},"How to",-1)),re=u(()=>l("p",null,[E("1) Head over to the "),l("a",{href:"https://developer.spotify.com/dashboard/applications",target:"_blank"},"spotify developer dashboard")],-1)),ue=u(()=>l("p",null,"2) Create An App",-1)),ce=u(()=>l("p",null,"3) Enter any name and any description",-1)),pe=u(()=>l("p",null,"5) Copy and enter the client id and secret into the corresponding input field",-1)),me=u(()=>l("hr",{class:"my-4"},null,-1)),ve=u(()=>l("h5",null,"Client ID: ",-1)),be=u(()=>l("h5",{class:"mt-4"},"Client Secret: ",-1)),fe=u(()=>l("h2",{class:"mt-[10px]"},"Player",-1)),he=u(()=>l("h2",{class:"mt-[10px]"},"Theme",-1)),_e={class:"themes"},ye=u(()=>l("h2",{class:"mt-[10px]"},"Sidebar",-1)),ge=u(()=>l("h2",{class:"mt-[10px]"},"Cache Behaviour",-1)),Ve=u(()=>l("h2",{class:"mt-[10px]"},"My Data",-1)),we=D({__name:"index",setup(n){const i=_(!1),o=_({id:"",secret:""}),c=B(()=>i.value?Object.values(o.value).some(d=>d==="")?!1:o.value.id!==r.value.id||o.value.secret!==r.value.secret||i.value!==r.value.enabled:r.value.enabled),r=_({id:"",secret:"",enabled:!1});fetch("/api/config/spotify").then(async d=>{let e={id:"",secret:"",enabled:!1};if(d.status==200)e=await d.json();else if([204,401].includes(d.status))e={id:"restricted",secret:"restricted",enabled:!1};else throw new Error("Failed to fetch spotify config");r.value=e,r.value.enabled=![e.id,e.secret].includes("restricted"),i.value=r.value.enabled,o.value.id=e.id.replace("restricted",""),o.value.secret=e.secret.replace("restricted","")});const p=async()=>{if(!c.value)return;let d=o.value.id,e=o.value.secret;i.value||(e=d="restricted"),(await fetch("/api/config/spotify",{method:"POST",body:JSON.stringify({id:d,secret:e})})).ok&&(r.value={id:d,secret:e,enabled:i.value})},t=_(null),b=_("");A().then(d=>{t.value=d,b.value=JSON.stringify(d)});const h=B(()=>t.value?JSON.stringify(t.value)!==b.value:!1),x=async()=>{h.value&&(await R(t.value),b.value=JSON.stringify(t.value))},f=F(),O=["dynamic","light","dark"],q=()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},N=`http://${window.location.host}/api/spotify/callback`;return(d,e)=>(v(),k("div",ie,[s(V,{"aria-description":"spotify",class:"p-4 pt-0"},{default:g(()=>[s(C,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),class:"h2 mb-2",label:"Spotify"},null,8,["modelValue"]),l("details",null,[de,re,ue,ce,l("p",null,[E("4) Edit the settings: set the redirect url to "),l("a",{href:N},y(N))]),pe]),me,ve,s(T,{modelValue:o.value.id,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.id=a),disabled:!i.value,icon:"token"},null,8,["modelValue","disabled"]),be,s(T,{modelValue:o.value.secret,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.secret=a),disabled:!i.value,icon:"lock"},null,8,["modelValue","disabled"]),s(w,{disabled:!m(c),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:p},null,8,["disabled"])]),_:1}),s(V,{"aria-description":"player",class:"p-4 pt-0"},{default:g(()=>[fe,s(C,{modelValue:m(f).player.pictureInPicture,"onUpdate:modelValue":e[3]||(e[3]=a=>m(f).player.pictureInPicture=a),label:"Support Picture in Picture",sublabel:"this will slightly reduce performance"},null,8,["modelValue"]),s(U,{modelValue:m(f).player.type,"onUpdate:modelValue":e[4]||(e[4]=a=>m(f).player.type=a),options:[{value:"web",label:"Native player",icon:"horizontal_rule"},{value:"web/wave",label:"Wave player",icon:"graphic_eq"}],icon:"music_note"},null,8,["modelValue"])]),_:1}),s(V,{"aria-description":"theme",class:"p-4 pt-0"},{default:g(()=>[he,l("div",_e,[(v(),k(M,null,H(O,(a,J)=>s(ne,{key:J,name:a},null,8,["name"])),64))])]),_:1}),s(V,{"aria-description":"sidebar",class:"p-4 pt-0"},{default:g(()=>[ye,s(C,{modelValue:m(f).sidebar.news,"onUpdate:modelValue":e[5]||(e[5]=a=>m(f).sidebar.news=a),label:"Show 'News' Tab"},null,8,["modelValue"]),s(C,{modelValue:m(f).sidebar.sports,"onUpdate:modelValue":e[6]||(e[6]=a=>m(f).sidebar.sports=a),label:"Show 'Sports' Tab"},null,8,["modelValue"])]),_:1}),s(V,{"aria-description":"cache behaviour",class:"p-4 pt-0"},{default:g(()=>[ge,t.value?(v(),P(C,{key:0,modelValue:t.value.cache.preserve,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.cache.preserve=a),label:"Preserve cache"},null,8,["modelValue"])):S("",!0),t.value?(v(),P(C,{key:1,modelValue:t.value.cache.preserveInSession,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.cache.preserveInSession=a),disabled:t.value.cache.preserve,label:"Preserve cache in session"},null,8,["modelValue","disabled"])):S("",!0),t.value?(v(),P(U,{key:2,modelValue:t.value.cache.strategy,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.cache.strategy=a),options:[{value:"all",label:"All Songs"},{value:"playlist",label:"Current Playlist"},{value:"currentNext",label:"Current + Next Song "},{value:"current",label:"Current Song Only"}],icon:"cached"},null,8,["modelValue"])):S("",!0),s(w,{disabled:!t.value||!m(h),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:x},null,8,["disabled"])]),_:1}),s(V,{"aria-description":"my data",class:"p-4 pt-0"},{default:g(()=>[Ve,s(w,{class:"mx-auto mt-4",icon:"backup",label:"Back up database",onClick:e[10]||(e[10]=a=>d.$router.push("/export"))}),s(w,{class:"mx-auto mt-4",icon:"cloud_download",label:"Import database",onClick:e[11]||(e[11]=a=>d.$router.push("/import"))}),s(w,{class:"mx-auto mt-4",icon:"delete",label:"Clean browser settings",onClick:q}),s(w,{class:"mx-auto mt-4",icon:"folder",label:"Manage files",onClick:e[12]||(e[12]=a=>d.$router.push("/preferences/my-data"))})]),_:1})]))}});const Ie=$(we,[["__scopeId","data-v-a2afed4f"]]);export{Ie as default};
