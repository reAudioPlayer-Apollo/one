import{m as O,o as v,c as C,a as t,t as k,D as $,_ as P,n as V,z as J,d as x,E as j,O as z,A as U,bS as F,bT as M,g as s,w as _,b as E,u as m,F as G,i as H,f as I,T as N,bU as K,k as L,l as R}from"./index-d29b8584.js";import{C as y}from"./Card-0238325c.js";import{I as g}from"./IconButton-7554b2d1.js";import{D as B}from"./Dropdown-d281954c.js";const Q={class:"material-symbols-rounded ms-wght-300 cursor-pointer"},X={class:"checkbox__label"},Y={class:"checkbox__label__title"},Z={class:"checkbox__label__sublabel italic"},ee=O({__name:"Checkbox",props:{modelValue:{type:Boolean,required:!0},label:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},sublabel:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(n,{emit:i}){const o=n,c=p=>i("update:modelValue",p),r=()=>{o.disabled||c(!o.modelValue)};return(p,l)=>(v(),C("div",{class:$([{"opacity-50":n.disabled},"checkbox"]),onClick:r},[t("span",Q,k(n.modelValue?"check_box":"check_box_outline_blank"),1),t("div",X,[t("div",Y,k(n.label),1),t("div",Z,k(n.sublabel),1)])],2))}});const w=P(ee,[["__scopeId","data-v-982c4110"]]);const le={key:0,class:"material-symbols-rounded"},ae=["type","placeholder","disabled"],te={__name:"PasswordInputWithIcon",props:{icon:String,placeholder:String,modelValue:String,disabled:Boolean},emits:["update:modelValue","change","submit"],setup(n,{emit:i}){const o=n,c=V(o.modelValue);J(()=>o.modelValue,b=>{c.value=b});const r=()=>{i("update:modelValue",c.value),i("change",c.value)},p=b=>{b.key==="Enter"&&i("submit",c)},l=V(!1);return(b,h)=>(v(),C("div",{class:$(["text-input-with-icon rounded-3xl flex items-center px-4",{disabled:n.disabled}])},[n.icon?(v(),C("span",le,k(n.icon),1)):x("",!0),j(t("input",{type:l.value?"text":"password","onUpdate:modelValue":h[0]||(h[0]=S=>c.value=S),onInput:r,onKeyup:p,placeholder:n.placeholder,disabled:n.disabled},null,40,ae),[[z,c.value]]),t("span",{class:"material-symbols-rounded cursor-pointer",onClick:h[1]||(h[1]=S=>l.value=!l.value)},k(l.value?"visibility":"visibility_off"),1)],2))}},D=P(te,[["__scopeId","data-v-8326799a"]]);const se={name:"Theme",props:{name:String},methods:{selected(){return window.getCurrentTheme()==this.name},select(){window.setTheme(this.name),this.$emit("selected")}}},oe=["src"];function ne(n,i,o,c,r,p){return v(),C("div",{onClick:i[0]||(i[0]=(...l)=>p.select&&p.select(...l)),class:"wrapper"},[t("p",{class:$(["mb-4",{selected:p.selected()}])},k(o.name),3),t("img",{src:`/assets/img/themes/${this.name}.svg`,class:$({selected:p.selected()})},null,10,oe)])}const ie=P(se,[["render",ne],["__scopeId","data-v-5dea6f6a"]]),u=n=>(L("data-v-67e3fd7d"),n=n(),R(),n),de={class:"p-[10px] preferences"},ue=u(()=>t("summary",{class:"cursor-pointer"},"How to",-1)),re=u(()=>t("p",null,[E("1) Head over to the "),t("a",{href:"https://developer.spotify.com/dashboard/applications",target:"_blank"},"spotify developer dashboard")],-1)),ce=u(()=>t("p",null,"2) Create An App",-1)),pe=u(()=>t("p",null,"3) Enter any name and any description",-1)),me=u(()=>t("p",null,"5) Copy and enter the client id and secret into the corresponding input field",-1)),ve=u(()=>t("hr",{class:"my-4"},null,-1)),be=u(()=>t("h5",null,"Client ID: ",-1)),he=u(()=>t("h5",{class:"mt-4"},"Client Secret: ",-1)),fe=u(()=>t("h2",{class:"mt-[10px]"},"Player",-1)),_e=u(()=>t("h2",{class:"mt-[10px]"},"Theme",-1)),ye={class:"themes"},ge=u(()=>t("h2",{class:"mt-[10px]"},"Sidebar",-1)),Ve=u(()=>t("h2",{class:"mt-[10px]"},"Cache Behaviour",-1)),ke=u(()=>t("h2",{class:"mt-[10px]"},"Github",-1)),we=u(()=>t("h5",{class:"mt-4"},"PAT: ",-1)),xe=u(()=>t("h5",{class:"mt-4"},"Gist ID: ",-1)),Ce=u(()=>t("h2",{class:"mt-[10px]"},"My Data",-1)),Se=O({__name:"index",setup(n){const i=V(!1),o=V({id:"",secret:""}),c=U(()=>i.value?Object.values(o.value).some(d=>d==="")?!1:o.value.id!==r.value.id||o.value.secret!==r.value.secret||i.value!==r.value.enabled:r.value.enabled),r=V({id:"",secret:"",enabled:!1});fetch("/api/config/spotify").then(async d=>{let e={id:"",secret:"",enabled:!1};if(d.status==200)e=await d.json();else if([204,401].includes(d.status))e={id:"restricted",secret:"restricted",enabled:!1};else throw new Error("Failed to fetch spotify config");r.value=e,r.value.enabled=![e.id,e.secret].includes("restricted"),i.value=r.value.enabled,o.value.id=e.id.replace("restricted",""),o.value.secret=e.secret.replace("restricted","")});const p=async()=>{if(!c.value)return;let d=o.value.id,e=o.value.secret;i.value||(e=d="restricted"),(await fetch("/api/config/spotify",{method:"POST",body:JSON.stringify({id:d,secret:e})})).ok&&(r.value={id:d,secret:e,enabled:i.value})},l=V(null),b=V("");F().then(d=>{l.value=d,b.value=JSON.stringify(d)});const h=U(()=>l.value?JSON.stringify(l.value)!==b.value:!1),S=async()=>{h.value&&(await K(l.value),b.value=JSON.stringify(l.value))},f=M(),q=["dynamic","light","dark"],A=()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},T=`http://${window.location.host}/api/spotify/callback`;return(d,e)=>(v(),C("div",de,[s(y,{"aria-description":"spotify",class:"p-4 pt-0"},{default:_(()=>[s(w,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),class:"h2 mb-2",label:"Spotify"},null,8,["modelValue"]),t("details",null,[ue,re,ce,pe,t("p",null,[E("4) Edit the settings: set the redirect url to "),t("a",{href:T},k(T))]),me]),ve,be,s(D,{modelValue:o.value.id,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.id=a),disabled:!i.value,icon:"token"},null,8,["modelValue","disabled"]),he,s(D,{modelValue:o.value.secret,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.secret=a),disabled:!i.value,icon:"lock"},null,8,["modelValue","disabled"]),s(g,{disabled:!m(c),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:p},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"player",class:"p-4 pt-0"},{default:_(()=>[fe,s(w,{modelValue:m(f).player.pictureInPicture,"onUpdate:modelValue":e[3]||(e[3]=a=>m(f).player.pictureInPicture=a),label:"Support Picture in Picture",sublabel:"this will slightly reduce performance"},null,8,["modelValue"]),s(B,{modelValue:m(f).player.type,"onUpdate:modelValue":e[4]||(e[4]=a=>m(f).player.type=a),options:[{value:"web",label:"Native player",icon:"horizontal_rule"},{value:"web/wave",label:"Wave player",icon:"graphic_eq"}],icon:"music_note"},null,8,["modelValue"])]),_:1}),s(y,{"aria-description":"theme",class:"p-4 pt-0"},{default:_(()=>[_e,t("div",ye,[(v(),C(G,null,H(q,(a,W)=>s(ie,{key:W,name:a},null,8,["name"])),64))])]),_:1}),s(y,{"aria-description":"sidebar",class:"p-4 pt-0"},{default:_(()=>[ge,s(w,{modelValue:m(f).sidebar.news,"onUpdate:modelValue":e[5]||(e[5]=a=>m(f).sidebar.news=a),label:"Show 'News' Tab"},null,8,["modelValue"]),s(w,{modelValue:m(f).sidebar.sports,"onUpdate:modelValue":e[6]||(e[6]=a=>m(f).sidebar.sports=a),label:"Show 'Sports' Tab"},null,8,["modelValue"])]),_:1}),s(y,{"aria-description":"cache behaviour",class:"p-4 pt-0"},{default:_(()=>[Ve,l.value?(v(),I(w,{key:0,modelValue:l.value.cache.preserve,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.cache.preserve=a),label:"Preserve cache"},null,8,["modelValue"])):x("",!0),l.value?(v(),I(w,{key:1,modelValue:l.value.cache.preserveInSession,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.cache.preserveInSession=a),disabled:l.value.cache.preserve,label:"Preserve cache in session"},null,8,["modelValue","disabled"])):x("",!0),l.value?(v(),I(B,{key:2,modelValue:l.value.cache.strategy,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.cache.strategy=a),options:[{value:"all",label:"All Songs"},{value:"playlist",label:"Current Playlist"},{value:"currentNext",label:"Current + Next Song "},{value:"current",label:"Current Song Only"}],icon:"cached"},null,8,["modelValue"])):x("",!0),s(g,{disabled:!l.value||!m(h),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:S},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"github settings",class:"p-4 pt-0"},{default:_(()=>[ke,we,l.value?(v(),I(N,{key:0,modelValue:l.value.github.githubPat,"onUpdate:modelValue":e[10]||(e[10]=a=>l.value.github.githubPat=a),icon:"lock"},null,8,["modelValue"])):x("",!0),xe,l.value?(v(),I(N,{key:1,modelValue:l.value.github.gistId,"onUpdate:modelValue":e[11]||(e[11]=a=>l.value.github.gistId=a),icon:"numbers"},null,8,["modelValue"])):x("",!0),s(g,{disabled:!l.value||!m(h),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:S},null,8,["disabled"])]),_:1}),s(y,{"aria-description":"my data",class:"p-4 pt-0"},{default:_(()=>[Ce,s(g,{class:"mx-auto mt-4",icon:"backup",label:"Back up database",onClick:e[12]||(e[12]=a=>d.$router.push("/export"))}),s(g,{class:"mx-auto mt-4",icon:"cloud_download",label:"Import database",onClick:e[13]||(e[13]=a=>d.$router.push("/import"))}),s(g,{class:"mx-auto mt-4",icon:"delete",label:"Clean browser settings",onClick:A}),s(g,{class:"mx-auto mt-4",icon:"folder",label:"Manage files",onClick:e[14]||(e[14]=a=>d.$router.push("/preferences/my-data"))})]),_:1})]))}});const Ne=P(Se,[["__scopeId","data-v-67e3fd7d"]]);export{Ne as default};
