import{_ as v,o,c as n,a,b as f,t as $,d as _,r as j,e as I,f as d,w as r,g as l,h as B,C as P,i as F,F as p,j as h,u as w,p as E,k as D,l as g,m as H,n as q,q as b,s as T,v as R,x as V}from"./index-7c89f80c.js";import{T as S}from"./TrackCompact-d4f01d17.js";import{P as x}from"./PlaylistHeader-ad8fb756.js";import{P as C}from"./PlaylistEntry-6bb1eba7.js";import{s as G}from"./spotify-346ffc62.js";import{F as L}from"./Form-8cf344bb.js";import{P as M}from"./PlaylistItem-d3aadcf9.js";import{I as J}from"./IconButton-a69e4be2.js";import"./ImportSpotifyAlbum.vue_vue_type_script_setup_true_lang-28b65af6.js";import"./Template-9f2fd3a5.js";import"./Playlist-5c7f0f89.js";import"./ExternalEntry-1e698e91.js";import"./EditSong.vue_vue_type_script_setup_true_lang-47d7f167.js";import"./playerInPicture-af203fdf.js";import"./Dropdown-e8239bd5.js";const W={name:"FlexShelf",props:{heading:String,icon:String}},z={class:"shelf"},A={class:"header"},K={key:0},Q={key:0,class:"icon material-symbols-round"},U={class:"items"};function X(e,s,u,c,t,i){return o(),n("div",z,[a("div",A,[u.heading||u.icon?(o(),n("h2",K,[f($(u.heading),1),u.icon?(o(),n("span",Q,$(u.icon),1)):_("",!0)])):_("",!0)]),a("div",U,[j(e.$slots,"default",{},void 0,!0)])])}const y=v(W,[["render",X],["__scopeId","data-v-c2d585d9"]]);const Y={__name:"Playlist",props:{name:{type:String,required:!0},cover:{type:String,required:!0},href:{type:String,required:!0}},setup(e){return(s,u)=>{const c=I("router-link");return o(),d(c,{to:e.href,class:"no-underline"},{default:r(()=>[l(P,{class:"home-playlist drop-shadow-md","with-hover":""},{default:r(()=>[l(B,{src:e.cover,type:"playlist"},null,8,["src"]),a("h2",null,$(e.name),1)]),_:1})]),_:1},8,["to"])}}},Z=v(Y,[["__scopeId","data-v-771b12c3"]]),ee=e=>(H("data-v-f2fa0eda"),e=e(),q(),e),te={class:"home"},se={class:"main"},oe={key:0,class:"playlists"},ie={key:1,class:"liked"},ae={key:2,class:"breaking"},ne={class:"side"},le={key:0,class:"releases"},re={key:1,class:"disovery"},ce={key:2,class:"recommendations"},de=ee(()=>a("h2",null,"Recommendations",-1)),ue={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],recommendations:[],data:D()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists},liked(){return g("liked").songs.slice(0,3)},breaking(){return g("breaking").songs.slice(0,3)}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const s=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.source||e.url||e.href}});window.dispatchEvent(s)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=this.playlists.map(async e=>{var s;return((s=g(e.id))==null?void 0:s.songs)||[]}).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},_e=F({...ue,setup(e){return(s,u)=>{const c=I("router-link");return o(),n("div",te,[a("div",se,[s.playlists.length?(o(),n("div",oe,[a("h2",null,[l(c,{class:"linkOnHover",to:"/collection/playlists"},{default:r(()=>[f("Playlists")]),_:1})]),l(y,null,{default:r(()=>[(o(!0),n(p,null,h(s.playlists,(t,i)=>(o(),d(Z,{key:i,cover:t.cover,href:t==null?void 0:t.href,name:t.name},null,8,["cover","href","name"]))),128))]),_:1})])):_("",!0),s.liked.length?(o(),n("div",ie,[a("h2",null,[l(c,{class:"linkOnHover",to:"/collection/tracks"},{default:r(()=>[f("Liked Songs")]),_:1})]),l(x),(o(!0),n(p,null,h(s.liked,(t,i)=>(o(),d(C,{key:i,index:i,"playlist-id":-1,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0),s.breaking.length?(o(),n("div",ae,[a("h2",null,[l(c,{class:"linkOnHover",to:"/collection/tracks/breaking"},{default:r(()=>[f("Breaking Songs")]),_:1})]),l(x),(o(!0),n(p,null,h(s.breaking,(t,i)=>(o(),d(C,{key:i,index:i,"playlist-id":-2,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0)]),a("div",ne,[s.releases.length?(o(),n("div",le,[a("h2",null,[l(c,{class:"linkOnHover",to:"/collection/releases"},{default:r(()=>[f("Out now")]),_:1})]),l(y,null,{default:r(()=>[(o(!0),n(p,null,h(s.releases,(t,i)=>(o(),d(S,{key:i,artist:t.artist,cover:t.cover,href:t.url,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.picks.length?(o(),n("div",re,[a("h2",null,[l(c,{class:"linkOnHover",to:"/discover"},{default:r(()=>[f("Discover")]),_:1})]),l(y,null,{default:r(()=>[(o(!0),n(p,null,h(s.picks,(t,i)=>(o(),d(S,{id:t.id,key:i,artist:t.artist,cover:w(E)(t.cover),href:t.href,title:t.title,onPlay:()=>s.playDiscover(t)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.recommendations.length?(o(),n("div",ce,[de,l(y,null,{default:r(()=>[(o(!0),n(p,null,h(s.recommendations,(t,i)=>(o(),d(S,{key:i,artist:t.artist,cover:t.cover,href:t.href,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0)])])}}});const pe=v(_e,[["__scopeId","data-v-f2fa0eda"]]),k=e=>(H("data-v-19a9c7d9"),e=e(),q(),e),he={class:"onboarding p-4"},me=k(()=>a("h1",null,"So nice to meet you!",-1)),fe=k(()=>a("p",null,"Let's get you set up",-1)),ye={class:"grid grid-cols-2 gap-4 mt-8"},ve=k(()=>a("div",{class:"flex flex-row items-center"},[a("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),a("h2",null,"Create your first playlist")],-1)),ke={class:"flex flex-row justify-end w-full"},ge={class:"flex flex-row items-center"},be=k(()=>a("h2",null,"Import from Spotify",-1)),Se={class:"spotify-playlists"},$e=F({__name:"Onboarding",setup(e){const s=b([]),u=b(!1),c=b(null);T(),R().then(i=>{u.value=i}),fetch("/api/spotify/playlists").then(i=>i.json()).then(i=>{s.value=i});const t={fields:[{name:"name",label:"Name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",label:"Description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const i=c.value.toObject();await V(i.name,i.description)}}};return(i,O)=>(o(),n("div",he,[me,fe,a("div",ye,[l(P,{class:"p-4"},{default:r(()=>[ve,l(L,{ref_key:"createForm",ref:c,options:t.fields},null,8,["options"]),a("div",ke,[l(J,{onClick:O[0]||(O[0]=m=>t.submit.action()),icon:"add",label:t.submit.label},null,8,["label"])])]),_:1}),s.value.length?(o(),d(P,{key:0,class:"p-4"},{default:r(()=>[a("div",ge,[l(w(G),{class:"spotify mr-4"}),be]),a("div",Se,[(o(!0),n(p,null,h(s.value,(m,N)=>(o(),d(M,{key:N,cover:m.cover,description:m.description,title:m.name,id:m.id,spotify:!0,href:`https://open.spotify.com/playlist/${m.id}`},null,8,["cover","description","title","id","href"]))),128))])]),_:1})):_("",!0)])]))}});const Pe=v($e,[["__scopeId","data-v-19a9c7d9"]]),Ve={__name:"index",setup(e){const s=D();return(u,c)=>w(s).notEmpty?(o(),d(pe,{key:0})):(o(),d(Pe,{key:1}))}};export{Ve as default};
