import{_ as g,o as a,c as n,a as o,b as y,t as k,d as _,r as B,e as O,u as E,f as F,g as d,w as c,h as i,C as x,i as T,j as M,k as b,F as p,l as h,P as I,p as R,m as H,n as $,q,s as N,v as P,x as V,y as G,z as L,I as J,A as z}from"./index-48f244c4.js";import{T as w}from"./TrackCompact-d8558c2f.js";import{P as D}from"./PlaylistEntry-2cba4ecd.js";import{s as A}from"./spotify-4d2466f9.js";import{P as W}from"./PlaylistItem-76c895a1.js";import"./EditSong.vue_vue_type_script_setup_true_lang-57f6a962.js";import"./playerInPicture-af203fdf.js";const K={name:"FlexShelf",props:{heading:String,icon:String}},Q={class:"shelf"},U={class:"header"},X={key:0},Y={key:0,class:"icon material-symbols-round"},Z={class:"items"};function ee(e,s,u,r,t,l){return a(),n("div",Q,[o("div",U,[u.heading||u.icon?(a(),n("h2",X,[y(k(u.heading),1),u.icon?(a(),n("span",Y,k(u.icon),1)):_("",!0)])):_("",!0)]),o("div",Z,[B(e.$slots,"default",{},void 0,!0)])])}const v=g(K,[["render",ee],["__scopeId","data-v-3f16aa97"]]),te={class:"relative"},se={class:"title"},ae={key:0,class:"material-symbols-rounded"},oe=O({__name:"Playlist",props:{name:{type:String,required:!0},cover:{type:String,required:!0},href:{type:String,required:!0},id:{type:String,required:!0},type:{type:String,default:"classic"}},setup(e){const s=E();return(u,r)=>{const t=F("router-link");return a(),d(t,{to:e.href,class:"no-underline"},{default:c(()=>[i(x,{class:"home-playlist drop-shadow-md","with-hover":""},{default:c(()=>[o("div",te,[i(T,{src:e.cover,type:"playlist",name:e.name},null,8,["src","name"]),o("span",{class:"material-symbols-rounded ms-fill play",onClick:r[0]||(r[0]=M(l=>b(s).loadPlaylist(e.id),["stop","prevent"]))}," play_circle ")]),o("div",se,[e.type!="classic"?(a(),n("span",ae,k(e.type=="smart"?"neurology":"bolt"),1)):_("",!0),o("h4",null,k(e.name),1)])]),_:1})]),_:1},8,["to"])}}});const le=g(oe,[["__scopeId","data-v-26593b44"]]),f=e=>(q("data-v-e67f7cde"),e=e(),N(),e),ne={class:"home"},ie={class:"main"},re={key:0,class:"playlists"},ce={key:1,class:"liked"},de={key:2,class:"breaking"},ue={class:"side"},_e={key:0,class:"releases"},pe=f(()=>o("span",{class:"material-symbols-rounded ms-fill"}," radar ",-1)),he=f(()=>o("span",{class:"hover:underline"}," Out now ",-1)),me={key:1,class:"disovery"},ye=f(()=>o("span",{class:"material-symbols-rounded ms-fill"}," explore ",-1)),fe=f(()=>o("span",{class:"hover:underline"}," Discover ",-1)),ve={key:2,class:"recommendations"},ke=f(()=>o("h2",{class:"flex items-center gap-2"},[o("span",{class:"material-symbols-rounded ms-fill"}," recommend "),y(" Suggested ")],-1)),ge={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],recommendations:[],data:H()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists},liked(){return $("liked").songs.slice(0,3)},breaking(){return $("breaking").songs.slice(0,3)}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const s=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.source||e.url||e.href}});window.dispatchEvent(s)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=this.playlists.map(e=>{var s;return((s=$(e.id))==null?void 0:s.songs)||[]}).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},be=O({...ge,setup(e){return(s,u)=>{const r=F("router-link");return a(),n("div",ne,[o("div",ie,[s.playlists.length?(a(),n("div",re,[o("h2",null,[i(r,{class:"linkOnHover",to:"/collection/playlists"},{default:c(()=>[y("Playlists")]),_:1})]),i(v,null,{default:c(()=>[(a(!0),n(p,null,h(s.playlists,(t,l)=>(a(),d(le,{key:l,cover:t.cover,href:t==null?void 0:t.href,name:t.name,type:t.type,id:t.id},null,8,["cover","href","name","type","id"]))),128))]),_:1})])):_("",!0),s.liked.length?(a(),n("div",ce,[o("h2",null,[i(r,{class:"linkOnHover",to:"/collection/tracks"},{default:c(()=>[y("Liked Songs")]),_:1})]),i(I),(a(!0),n(p,null,h(s.liked,(t,l)=>(a(),d(D,{key:l,index:l,"playlist-id":-1,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0),s.breaking.length?(a(),n("div",de,[o("h2",null,[i(r,{class:"linkOnHover",to:"/collection/tracks/breaking"},{default:c(()=>[y("Breaking Songs")]),_:1})]),i(I),(a(!0),n(p,null,h(s.breaking,(t,l)=>(a(),d(D,{key:l,index:l,"playlist-id":-2,song:t,"with-cover":""},null,8,["index","song"]))),128))])):_("",!0)]),o("div",ue,[s.releases.length?(a(),n("div",_e,[o("h2",null,[i(r,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/releases"},{default:c(()=>[pe,he]),_:1})]),i(v,null,{default:c(()=>[(a(!0),n(p,null,h(s.releases,(t,l)=>(a(),d(w,{key:l,artist:t.artist,cover:t.cover,href:t.url,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.picks.length?(a(),n("div",me,[o("h2",null,[i(r,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/discover"},{default:c(()=>[ye,fe]),_:1})]),i(v,null,{default:c(()=>[(a(!0),n(p,null,h(s.picks,(t,l)=>(a(),d(w,{id:t.id,key:l,artist:t.artist,cover:b(R)(t.cover),href:t.href,title:t.title,onPlay:()=>s.playDiscover(t)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0),s.recommendations.length?(a(),n("div",ve,[ke,i(v,null,{default:c(()=>[(a(!0),n(p,null,h(s.recommendations,(t,l)=>(a(),d(w,{key:l,artist:t.artist,cover:t.cover,href:t.href,title:t.title,onPlay:()=>s.playRecommendation(t)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):_("",!0)])])}}});const Se=g(be,[["__scopeId","data-v-e67f7cde"]]),S=e=>(q("data-v-c0ed4691"),e=e(),N(),e),$e={class:"onboarding p-4"},Pe=S(()=>o("h1",null,"So nice to meet you!",-1)),we=S(()=>o("p",null,"Let's get you set up",-1)),xe={class:"grid grid-cols-2 gap-4 mt-8"},Oe=S(()=>o("div",{class:"flex flex-row items-center"},[o("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),o("h2",null,"Create your first playlist")],-1)),Ce={class:"flex flex-row justify-end w-full"},Ie={class:"flex flex-row items-center"},De=S(()=>o("h2",null,"Import from Spotify",-1)),Fe={class:"spotify-playlists"},He=O({__name:"Onboarding",setup(e){const s=P([]),u=P(!1),r=P(null);V(),G().then(l=>{u.value=l}),fetch("/api/spotify/playlists").then(l=>l.json()).then(l=>{s.value=l});const t={fields:[{name:"name",label:"Name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",label:"Description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const l=r.value.toObject();await z(l.name,l.description)}}};return(l,C)=>(a(),n("div",$e,[Pe,we,o("div",xe,[i(x,{class:"p-4"},{default:c(()=>[Oe,i(L,{ref_key:"createForm",ref:r,options:t.fields},null,8,["options"]),o("div",Ce,[i(J,{onClick:C[0]||(C[0]=m=>t.submit.action()),icon:"add",label:t.submit.label},null,8,["label"])])]),_:1}),s.value.length?(a(),d(x,{key:0,class:"p-4"},{default:c(()=>[o("div",Ie,[i(b(A),{class:"spotify mr-4"}),De]),o("div",Fe,[(a(!0),n(p,null,h(s.value,(m,j)=>(a(),d(W,{key:j,cover:m.cover,description:m.description,title:m.name,id:m.id,spotify:!0,href:`https://open.spotify.com/playlist/${m.id}`},null,8,["cover","description","title","id","href"]))),128))])]),_:1})):_("",!0)])]))}});const qe=g(He,[["__scopeId","data-v-c0ed4691"]]),Ve={__name:"index",setup(e){const s=H();return(u,r)=>b(s).notEmpty?(a(),d(Se,{key:0})):(a(),d(qe,{key:1}))}};export{Ve as default};
