import{n as D,o as v,c as x,a,t as k,aA as $,_ as P,q as w,bs as O,d as C,by as J,bl as j,A as N,bY as F,bZ as M,g as s,w as _,C as g,b as q,u as r,F as z,i as H,f as I,bN as T,b_ as K,l as L,m as R}from"./index-8780d14b.js";import{I as y}from"./IconButton-404b97fe.js";import{D as B}from"./Dropdown-2e8aed9d.js";import{G as Y}from"./gistClient-4b0db3fb.js";const Z={class:"material-symbols-rounded ms-wght-300 cursor-pointer"},Q={class:"checkbox__label"},X={class:"checkbox__label__title"},ee={class:"checkbox__label__sublabel italic"},le=D({__name:"Checkbox",props:{modelValue:{type:Boolean,required:!0},label:{type:String,required:!1,default:""},disabled:{type:Boolean,required:!1,default:!1},sublabel:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(i,{emit:d}){const n=i,p=m=>d("update:modelValue",m),c=()=>{n.disabled||p(!n.modelValue)};return(m,l)=>(v(),x("div",{class:$([{"opacity-50":i.disabled},"checkbox"]),onClick:c},[a("span",Z,k(i.modelValue?"check_box":"check_box_outline_blank"),1),a("div",Q,[a("div",X,k(i.label),1),a("div",ee,k(i.sublabel),1)])],2))}});const V=P(le,[["__scopeId","data-v-982c4110"]]);const te={key:0,class:"material-symbols-rounded"},ae=["disabled","placeholder","type"],se={__name:"PasswordInputWithIcon",props:{icon:String,placeholder:String,modelValue:String,disabled:Boolean},emits:["update:modelValue","change","submit"],setup(i,{emit:d}){const n=i,p=w(n.modelValue);O(()=>n.modelValue,h=>{p.value=h});const c=()=>{d("update:modelValue",p.value),d("change",p.value)},m=h=>{h.key==="Enter"&&d("submit",p)},l=w(!1);return(h,f)=>(v(),x("div",{class:$([{disabled:i.disabled},"text-input-with-icon rounded-3xl flex items-center px-4"])},[i.icon?(v(),x("span",te,k(i.icon),1)):C("",!0),J(a("input",{"onUpdate:modelValue":f[0]||(f[0]=S=>p.value=S),disabled:i.disabled,placeholder:i.placeholder,type:l.value?"text":"password",onInput:c,onKeyup:m},null,40,ae),[[j,p.value]]),a("span",{class:"material-symbols-rounded cursor-pointer",onClick:f[1]||(f[1]=S=>l.value=!l.value)},k(l.value?"visibility":"visibility_off"),1)],2))}},A=P(se,[["__scopeId","data-v-5e026540"]]);const oe={name:"Theme",props:{name:String},methods:{selected(){return window.getCurrentTheme()==this.name},select(){window.setTheme(this.name),this.$emit("selected")}}},ne=["src"];function ie(i,d,n,p,c,m){return v(),x("div",{onClick:d[0]||(d[0]=(...l)=>m.select&&m.select(...l)),class:"wrapper"},[a("p",{class:$(["mb-4",{selected:m.selected()}])},k(n.name),3),a("img",{src:`/assets/img/themes/${this.name}.svg`,class:$({selected:m.selected()})},null,10,ne)])}const de=P(oe,[["render",ie],["__scopeId","data-v-5dea6f6a"]]),u=i=>(L("data-v-519432f4"),i=i(),R(),i),ue={class:"p-[10px] preferences"},re=u(()=>a("summary",{class:"cursor-pointer"},"How to",-1)),ce=u(()=>a("p",null,[q("1) Head over to the "),a("a",{href:"https://developer.spotify.com/dashboard/applications",target:"_blank"},"spotify developer dashboard")],-1)),pe=u(()=>a("p",null,"2) Create An App",-1)),me=u(()=>a("p",null,"3) Enter any name and any description",-1)),be=u(()=>a("p",null,"5) Copy and enter the client id and secret into the corresponding input field",-1)),ve=u(()=>a("hr",{class:"my-4"},null,-1)),he=u(()=>a("h5",null,"Client ID: ",-1)),fe=u(()=>a("h5",{class:"mt-4"},"Client Secret: ",-1)),_e=u(()=>a("h2",{class:"mt-[10px]"},"Player",-1)),ge=u(()=>a("h2",{class:"mt-[10px]"},"Theme",-1)),ye={class:"themes"},Ve=u(()=>a("h2",{class:"mt-[10px]"},"Sidebar",-1)),we=u(()=>a("h2",{class:"mt-[10px]"},"Cache Behaviour",-1)),ke=u(()=>a("h2",{class:"mt-[10px]"},"Github",-1)),Ce=u(()=>a("h5",{class:"mt-4"},"PAT: ",-1)),xe=u(()=>a("h5",{class:"mt-4"},"Gist ID: ",-1)),Se=u(()=>a("h2",{class:"mt-[10px]"},"My Data",-1)),Ie=D({__name:"index",setup(i){const d=w(!1),n=w({id:"",secret:""}),p=N(()=>d.value?Object.values(n.value).some(o=>o==="")?!1:n.value.id!==c.value.id||n.value.secret!==c.value.secret||d.value!==c.value.enabled:c.value.enabled),c=w({id:"",secret:"",enabled:!1});fetch("/api/config/spotify").then(async o=>{let e={id:"",secret:"",enabled:!1};if(o.status==200)e=await o.json();else if([204,401].includes(o.status))e={id:"restricted",secret:"restricted",enabled:!1};else throw new Error("Failed to fetch spotify config");c.value=e,c.value.enabled=![e.id,e.secret].includes("restricted"),d.value=c.value.enabled,n.value.id=e.id.replace("restricted",""),n.value.secret=e.secret.replace("restricted","")});const m=async()=>{if(!p.value)return;let o=n.value.id,e=n.value.secret;d.value||(e=o="restricted"),(await fetch("/api/config/spotify",{method:"POST",body:JSON.stringify({id:o,secret:e})})).ok&&(c.value={id:o,secret:e,enabled:d.value})},l=w(null),h=w("");F().then(o=>{l.value=o,h.value=JSON.stringify(o)});const f=N(()=>l.value?JSON.stringify(l.value)!==h.value:!1),S=async()=>{f.value&&(await K(l.value),h.value=JSON.stringify(l.value))},b=M(),E=["dynamic","light","dark"],W=()=>{localStorage.clear(),sessionStorage.clear(),window.location.reload()},U=`http://${window.location.host}/api/spotify/callback`;return O(()=>{var o,e;return(e=(o=l.value)==null?void 0:o.github)==null?void 0:e.githubPat},async()=>{var o,e;(e=(o=l.value)==null?void 0:o.github)!=null&&e.githubPat&&(l.value.github.gistId||(l.value.github.gistId=await Y.search(l.value.github.githubPat),console.log(l.value.github.gistId)))}),(o,e)=>(v(),x("div",ue,[s(g,{"aria-description":"spotify",class:"p-4 pt-0"},{default:_(()=>[s(V,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),class:"h2 mb-2",label:"Spotify"},null,8,["modelValue"]),a("details",null,[re,ce,pe,me,a("p",null,[q("4) Edit the settings: set the redirect url to "),a("a",{href:U},k(U))]),be]),ve,he,s(A,{modelValue:n.value.id,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.id=t),disabled:!d.value,icon:"token"},null,8,["modelValue","disabled"]),fe,s(A,{modelValue:n.value.secret,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.secret=t),disabled:!d.value,icon:"lock"},null,8,["modelValue","disabled"]),s(y,{disabled:!r(p),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:m},null,8,["disabled"])]),_:1}),s(g,{"aria-description":"player",class:"p-4 pt-0"},{default:_(()=>[_e,s(V,{modelValue:r(b).player.pictureInPicture,"onUpdate:modelValue":e[3]||(e[3]=t=>r(b).player.pictureInPicture=t),label:"Support Picture in Picture",sublabel:"this will slightly reduce performance"},null,8,["modelValue"]),s(B,{modelValue:r(b).player.type,"onUpdate:modelValue":e[4]||(e[4]=t=>r(b).player.type=t),options:[{value:"web",label:"Native player",icon:"horizontal_rule"},{value:"web/wave",label:"Wave player",icon:"graphic_eq"}],icon:"music_note"},null,8,["modelValue"])]),_:1}),s(g,{"aria-description":"theme",class:"p-4 pt-0"},{default:_(()=>[ge,s(V,{modelValue:r(b).ambient,"onUpdate:modelValue":e[5]||(e[5]=t=>r(b).ambient=t),disabled:!r(b).themeSupportsAmbient,label:"Ambient"},null,8,["modelValue","disabled"]),a("div",ye,[(v(),x(z,null,H(E,(t,G)=>s(de,{key:G,name:t},null,8,["name"])),64))])]),_:1}),s(g,{"aria-description":"sidebar",class:"p-4 pt-0"},{default:_(()=>[Ve,s(V,{modelValue:r(b).sidebar.news,"onUpdate:modelValue":e[6]||(e[6]=t=>r(b).sidebar.news=t),label:"Show 'News' Tab"},null,8,["modelValue"]),s(V,{modelValue:r(b).sidebar.sports,"onUpdate:modelValue":e[7]||(e[7]=t=>r(b).sidebar.sports=t),label:"Show 'Sports' Tab"},null,8,["modelValue"])]),_:1}),s(g,{"aria-description":"cache behaviour",class:"p-4 pt-0"},{default:_(()=>[we,l.value?(v(),I(V,{key:0,modelValue:l.value.cache.preserve,"onUpdate:modelValue":e[8]||(e[8]=t=>l.value.cache.preserve=t),label:"Preserve cache"},null,8,["modelValue"])):C("",!0),l.value?(v(),I(V,{key:1,modelValue:l.value.cache.preserveInSession,"onUpdate:modelValue":e[9]||(e[9]=t=>l.value.cache.preserveInSession=t),disabled:l.value.cache.preserve,label:"Preserve cache in session"},null,8,["modelValue","disabled"])):C("",!0),l.value?(v(),I(B,{key:2,modelValue:l.value.cache.strategy,"onUpdate:modelValue":e[10]||(e[10]=t=>l.value.cache.strategy=t),options:[{value:"all",label:"All Songs"},{value:"playlist",label:"Current Playlist"},{value:"currentNext",label:"Current + Next Song "},{value:"current",label:"Current Song Only"}],icon:"cached"},null,8,["modelValue"])):C("",!0),s(y,{disabled:!l.value||!r(f),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:S},null,8,["disabled"])]),_:1}),s(g,{"aria-description":"github settings",class:"p-4 pt-0"},{default:_(()=>[ke,Ce,l.value?(v(),I(T,{key:0,modelValue:l.value.github.githubPat,"onUpdate:modelValue":e[11]||(e[11]=t=>l.value.github.githubPat=t),icon:"lock"},null,8,["modelValue"])):C("",!0),xe,l.value?(v(),I(T,{key:1,modelValue:l.value.github.gistId,"onUpdate:modelValue":e[12]||(e[12]=t=>l.value.github.gistId=t),icon:"numbers"},null,8,["modelValue"])):C("",!0),s(y,{disabled:!l.value||!r(f),class:"ml-auto mt-4",icon:"save",label:"Save",onClick:S},null,8,["disabled"])]),_:1}),s(g,{"aria-description":"my data",class:"p-4 pt-0"},{default:_(()=>[Se,s(y,{class:"mx-auto mt-4",icon:"backup",label:"Back up database",onClick:e[13]||(e[13]=t=>o.$router.push("/export"))}),s(y,{class:"mx-auto mt-4",icon:"cloud_download",label:"Import database",onClick:e[14]||(e[14]=t=>o.$router.push("/import"))}),s(y,{class:"mx-auto mt-4",icon:"delete",label:"Clean browser settings",onClick:W}),s(y,{class:"mx-auto mt-4",icon:"folder",label:"Manage files",onClick:e[15]||(e[15]=t=>o.$router.push("/preferences/my-data"))})]),_:1})]))}});const Be=P(Ie,[["__scopeId","data-v-519432f4"]]);export{Be as default};
