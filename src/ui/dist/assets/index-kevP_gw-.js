import{_ as b,o as n,c as o,a as t,b as x,t as S,d as m,r as F,e as C,f as I,g as r,w as c,F as f,h as y,i as p,P as w,u as P,p as T,j as D,N as B,k,l as v,m as H,n as E,q as j,I as R,C as $,s as q,v as M}from"./index-5KRJtp2M.js";import{P as N}from"./PlaylistCard-C-epNR2a.js";import{T as g}from"./TrackCompact-h2qjL4jH.js";import{P as O}from"./PlaylistEntry-ZPwHtLZH.js";import{s as V}from"./spotify-Zp-GUgB6.js";import"./playerInPicture-Dfp9IAsf.js";import"./EditSong.vue_vue_type_script_setup_true_lang-DaXDymvP.js";const G={name:"FlexShelf",props:{heading:String,icon:String}},L={class:"shelf"},J={class:"header"},W={key:0},z={key:0,class:"icon material-symbols-round"},A={class:"items"};function K(l,e,i,d,s,a){return n(),o("div",L,[t("div",J,[i.heading||i.icon?(n(),o("h2",W,[x(S(i.heading),1),i.icon?(n(),o("span",z,S(i.icon),1)):m("",!0)])):m("",!0)]),t("div",A,[F(l.$slots,"default",{},void 0,!0)])])}const h=b(G,[["render",K],["__scopeId","data-v-27a92662"]]),Q={class:"home"},U={class:"main"},X={key:0,class:"playlists"},Y={key:1,class:"breaking"},Z={key:2,class:"liked"},ee={class:"side"},te={key:0,class:"releases"},se={key:1,class:"disovery"},le={key:2,class:"recommendations"},ne={name:"Home",data(){const l=new Date;return{greeting:l.getHours()<12?"Good morning":l.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],recommendations:[],data:D()}},mounted(){fetch("/api/releases").then(l=>l.json()).then(l=>{this.releases=l.slice(0,3);const e=l.filter(i=>new Date(i.releaseDate).toDateString()===new Date().toDateString());e.length&&B.addInfo("New releases",`There are ${e.length} new releases today`,5e3,void 0,"/collection/releases")}),this.pick()},computed:{playlists(){return this.data.playlists},liked(){return k("liked").songs.slice(0,3)},breaking(){return k("breaking").songs.slice(0,3)}},methods:{playDiscover(l){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:l.id,type:"track"})})},playRecommendation(l){const e=new CustomEvent("player.play",{detail:{artist:l.artist,title:l.title,source:l.source||l.url||l.href}});window.dispatchEvent(e)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=this.playlists.map(l=>{var e;return((e=k(l.id))==null?void 0:e.songs)||[]}).flat(),!(this.songs.length<3)){for(let l=0;l<3;l++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(l=>l.json()).then(l=>{this.recommendations=l.slice(0,3)})}}}},ie=C({...ne,setup(l){return(e,i)=>{const d=I("router-link");return n(),o("div",Q,[t("div",U,[e.playlists.length?(n(),o("div",X,[t("h2",null,[r(d,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/playlists"},{default:c(()=>i[0]||(i[0]=[t("span",{class:"material-symbols-rounded ms-fill"}," library_music ",-1),t("span",{class:"hover:underline"}," Playlists ",-1)])),_:1})]),r(h,null,{default:c(()=>[(n(!0),o(f,null,y(e.playlists,s=>(n(),p(N,{playlist:s},null,8,["playlist"]))),256))]),_:1})])):m("",!0),e.breaking.length?(n(),o("div",Y,[t("h2",null,[r(d,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/tracks/breaking"},{default:c(()=>i[1]||(i[1]=[t("span",{class:"material-symbols-rounded ms-fill"}," trending_up ",-1),t("span",{class:"hover:underline"}," Breaking Songs ",-1)])),_:1})]),r(w),(n(!0),o(f,null,y(e.breaking,(s,a)=>(n(),p(O,{key:a,index:a,"playlist-id":"breaking",song:s,"with-cover":""},null,8,["index","song"]))),128))])):m("",!0),e.liked.length?(n(),o("div",Z,[t("h2",null,[r(d,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/tracks"},{default:c(()=>i[2]||(i[2]=[t("span",{class:"material-symbols-rounded ms-fill"}," favorite ",-1),t("span",{class:"hover:underline"}," Liked Songs ",-1)])),_:1})]),r(w),(n(!0),o(f,null,y(e.liked,(s,a)=>(n(),p(O,{key:a,index:a,"playlist-id":"liked",song:s,"with-cover":""},null,8,["index","song"]))),128))])):m("",!0)]),t("div",ee,[e.releases.length?(n(),o("div",te,[t("h2",null,[r(d,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/collection/releases"},{default:c(()=>i[3]||(i[3]=[t("span",{class:"material-symbols-rounded ms-fill"}," radar ",-1),t("span",{class:"hover:underline"}," Out now ",-1)])),_:1})]),r(h,null,{default:c(()=>[(n(!0),o(f,null,y(e.releases,(s,a)=>(n(),p(g,{key:a,artist:s.artist,cover:s.cover,href:s.url,title:s.title,onPlay:()=>e.playRecommendation(s)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):m("",!0),e.picks.length?(n(),o("div",se,[t("h2",null,[r(d,{class:"linkOnHover flex items-center gap-2 !no-underline",to:"/discover"},{default:c(()=>i[4]||(i[4]=[t("span",{class:"material-symbols-rounded ms-fill"}," explore ",-1),t("span",{class:"hover:underline"}," Discover ",-1)])),_:1})]),r(h,null,{default:c(()=>[(n(!0),o(f,null,y(e.picks,(s,a)=>(n(),p(g,{id:s.id,key:a,artist:s.artist,cover:P(T)(s.cover),href:s.href,title:s.title,onPlay:()=>e.playDiscover(s)},null,8,["id","artist","cover","href","title","onPlay"]))),128))]),_:1})])):m("",!0),e.recommendations.length?(n(),o("div",le,[i[5]||(i[5]=t("h2",{class:"flex items-center gap-2"},[t("span",{class:"material-symbols-rounded ms-fill"}," recommend "),x(" Suggested ")],-1)),r(h,null,{default:c(()=>[(n(!0),o(f,null,y(e.recommendations,(s,a)=>(n(),p(g,{key:a,artist:s.artist,cover:s.cover,href:s.href,title:s.title,onPlay:()=>e.playRecommendation(s)},null,8,["artist","cover","href","title","onPlay"]))),128))]),_:1})])):m("",!0)])])}}}),ae=b(ie,[["__scopeId","data-v-b9b4d097"]]),oe={class:"onboarding p-4"},re={class:"grid grid-cols-2 gap-4 mt-8"},de={class:"flex flex-row justify-end w-full"},ce={class:"flex flex-row items-center"},ue={class:"spotify-playlists"},pe=C({__name:"Onboarding",setup(l){const e=v([]),i=v(!1),d=v(null);H(),E().then(a=>{i.value=a}),fetch("/api/spotify/playlists").then(a=>a.json()).then(a=>{e.value=a});const s={fields:[{name:"name",placeholder:"Playlist name",icon:"title",type:"text",required:!0},{name:"description",placeholder:"Playlist description",icon:"description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const a=d.value.toObject();await q(a.name,a.description)}}};return(a,u)=>(n(),o("div",oe,[u[3]||(u[3]=t("h1",null,"So nice to meet you!",-1)),u[4]||(u[4]=t("p",null,"Let's get you set up",-1)),t("div",re,[r($,{class:"p-4"},{default:c(()=>[u[1]||(u[1]=t("div",{class:"flex flex-row items-center"},[t("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),t("h2",null,"Create your first playlist")],-1)),r(j,{ref_key:"createForm",ref:d,options:s.fields},null,8,["options"]),t("div",de,[r(R,{onClick:u[0]||(u[0]=_=>s.submit.action()),icon:"add",label:s.submit.label},null,8,["label"])])]),_:1}),e.value.length?(n(),p($,{key:0,class:"p-4"},{default:c(()=>[t("div",ce,[r(P(V),{class:"spotify mr-4"}),u[2]||(u[2]=t("h2",null,"Import from Spotify",-1))]),t("div",ue,[(n(!0),o(f,null,y(e.value,_=>(n(),p(N,{playlist:{..._,type:"classic",plays:0,href:`https://open.spotify.com/playlist/${_.id}`},"is-spotify":""},null,8,["playlist"]))),256))])]),_:1})):m("",!0)])]))}}),me=b(pe,[["__scopeId","data-v-2c465748"]]),be={__name:"index",setup(l){const e=D(),i=v(!1),d=H();return M(()=>{document.body.clientWidth<768&&(i.value=!0,d.push("/collection/playlist"))}),(s,a)=>P(e).notEmpty||i.value?(n(),p(ae,{key:0})):(n(),p(me,{key:1}))}};export{be as default};
