import{_ as v,o as s,c as i,a as n,b as y,t as m,d as u,r as I,e as P,f as _,w as d,u as g,p as H,g as c,F as h,h as p,i as B,j as w,k as D,l as j,m as C,n as q,q as x,s as E,v as N}from"./index.137aa168.js";import{g as T}from"./song.a7128768.js";import{T as k}from"./TrackCompact.b2cb5016.js";import{S as b,L as S}from"./LightPlaylistEntry.93cedd94.js";import"./ImportSpotifyAlbum.vue_vue_type_script_setup_true_lang.cc773221.js";import"./TrackInfo.18c3fb8a.js";import"./MiniPlayer.75ead41c.js";import"./ImportSpotifySong.vue_vue_type_script_setup_true_lang.7e7f61ec.js";import"./SongCtx.901d6e16.js";import"./EditSong.vue_vue_type_script_setup_true_lang.fdb29323.js";const F={name:"FlexShelf",props:{heading:String,icon:String}},L={class:"shelf"},R={class:"header"},V={key:0},G={key:0,class:"icon material-symbols-round"},A={class:"items"};function J(t,o,r,l,e,a){return s(),i("div",L,[n("div",R,[r.heading||r.icon?(s(),i("h2",V,[y(m(r.heading),1),r.icon?(s(),i("span",G,m(r.icon),1)):u("",!0)])):u("",!0)]),n("div",A,[I(t.$slots,"default",{},void 0,!0)])])}const f=v(F,[["render",J],["__scopeId","data-v-b884f5aa"]]);const M={class:"home-playlist drop-shadow-md"},z=["src"],K={__name:"Playlist",props:{name:{type:String,required:!0},cover:{type:String,required:!0},href:{type:String,required:!0}},setup(t){return(o,r)=>{const l=P("router-link");return s(),_(l,{to:t.href,class:"no-underline"},{default:d(()=>[n("div",M,[n("img",{src:g(H)(t.cover)},null,8,z),n("h2",null,m(t.name),1)])]),_:1},8,["to"])}}},Q=v(K,[["__scopeId","data-v-62cb83fd"]]);const U=t=>(D("data-v-62bc3636"),t=t(),j(),t),W={class:"home"},X={class:"main"},Y={key:0,class:"playlists"},Z={key:1,class:"liked"},ee={key:2,class:"breaking"},te={class:"side"},se={key:0,class:"releases"},oe={key:1,class:"disovery"},ie={key:2,class:"recommendations"},ae=U(()=>n("h2",null,"Recommendations",-1)),ne={name:"Home",data(){const t=new Date;return{greeting:t.getHours()<12?"Good morning":t.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],liked:[],breaking:[],recommendations:[],data:w()}},mounted(){fetch("/api/releases").then(t=>t.json()).then(t=>{this.releases=t.slice(0,3)}),fetch("/api/me/liked").then(t=>t.json()).then(t=>{this.liked=t.songs.slice(0,3)}),fetch("/api/me/new").then(t=>t.json()).then(t=>{this.breaking=t.songs.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists}},methods:{playDiscover(t){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:t.id,type:"track"})})},playRecommendation(t){const o=new CustomEvent("player.play",{detail:{artist:t.artist,title:t.title,source:t.src||t.url}});window.dispatchEvent(o)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}this.songs=(await Promise.all(this.playlists.map(async t=>(await T(t.id)).songs))).flat();for(let t=0;t<3;t++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(t=>t.json()).then(t=>{this.recommendations=t.slice(0,3)})}}},re=Object.assign(ne,{setup(t){return(o,r)=>{const l=P("router-link");return s(),i("div",W,[n("div",X,[o.playlists.length?(s(),i("div",Y,[n("h2",null,[c(l,{to:"/collection/playlists",class:"linkOnHover"},{default:d(()=>[y("Playlists")]),_:1})]),c(f,null,{default:d(()=>[(s(!0),i(h,null,p(o.playlists,(e,a)=>(s(),_(Q,{key:a,name:e.name,cover:e.cover,href:e==null?void 0:e.href},null,8,["name","cover","href"]))),128))]),_:1})])):u("",!0),o.liked.length?(s(),i("div",Z,[n("h2",null,[c(l,{to:"/collection/tracks",class:"linkOnHover"},{default:d(()=>[y("Liked Songs")]),_:1})]),c(b),(s(!0),i(h,null,p(o.liked,(e,a)=>(s(),_(S,{key:a,index:a,loadAt:{type:"collection"},source:e.source,id:e.id,title:e.title,playing:e.playing,album:e.album,artist:e.artist,cover:e.cover,favourite:e.favourite,duration:e.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])):u("",!0),o.breaking.length?(s(),i("div",ee,[n("h2",null,[c(l,{to:"/collection/tracks/breaking",class:"linkOnHover"},{default:d(()=>[y("Breaking Songs")]),_:1})]),c(b),(s(!0),i(h,null,p(o.breaking,(e,a)=>(s(),_(S,{key:a,index:a,loadAt:{type:"collection/breaking"},source:e.source,id:e.id,title:e.title,playing:e.playing,album:e.album,artist:e.artist,cover:e.cover,favourite:e.favourite,duration:e.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])):u("",!0)]),n("div",te,[o.releases.length?(s(),i("div",se,[n("h2",null,[c(l,{to:"/collection/releases",class:"linkOnHover"},{default:d(()=>[y("Out now")]),_:1})]),c(f,null,{default:d(()=>[(s(!0),i(h,null,p(o.releases,(e,a)=>(s(),_(k,{onPlay:()=>o.playRecommendation(e),key:a,artist:e.artist,title:e.title,cover:e.cover,href:e.url},null,8,["onPlay","artist","title","cover","href"]))),128))]),_:1})])):u("",!0),o.picks.length?(s(),i("div",oe,[n("h2",null,[c(l,{to:"/discover",class:"linkOnHover"},{default:d(()=>[y("Discover")]),_:1})]),c(f,null,{default:d(()=>[(s(!0),i(h,null,p(o.picks,(e,a)=>(s(),_(k,{onPlay:()=>o.playDiscover(e),key:a,artist:e.artist,title:e.title,cover:g(B)(e.cover),id:e.id,href:e.href},null,8,["onPlay","artist","title","cover","id","href"]))),128))]),_:1})])):u("",!0),o.recommendations.length?(s(),i("div",ie,[ae,c(f,null,{default:d(()=>[(s(!0),i(h,null,p(o.recommendations,(e,a)=>(s(),_(k,{onPlay:()=>o.playRecommendation(e),key:a,artist:e.artist,title:e.title,cover:e.cover,href:e.src},null,8,["onPlay","artist","title","cover","href"]))),128))]),_:1})])):u("",!0)])])}}}),le=v(re,[["__scopeId","data-v-62bc3636"]]),ce={key:1},de=C({__name:"IconButton",props:{icon:{type:String,required:!1},label:{type:String,required:!1}},setup(t){return(o,r)=>(s(),i("button",{onClick:r[0]||(r[0]=l=>o.$emit("click")),class:"flex items-center justify-center h-12 p-4 mt-4 bg-fg text-bg rounded-full"},[t.icon?(s(),i("span",{key:0,class:q(["material-symbols-rounded",{"mr-2":t.label}])},m(t.icon),3)):u("",!0),t.label?(s(),i("span",ce,m(t.label),1)):u("",!0)]))}});const $=v(de,[["__scopeId","data-v-f9261b94"]]),ue={class:"onboarding p-4"},_e=n("h1",null,"So nice to meet you!",-1),he=n("p",null,"Let's get you set up",-1),pe=C({__name:"Onboarding",setup(t){const o=x(!1),r=E();N().then(e=>{o.value=e});const l=e=>{r.push(e)};return(e,a)=>(s(),i("div",ue,[_e,he,c($,{icon:"add",label:"create your first playlist",onClick:a[0]||(a[0]=O=>l("/playlist/create"))}),c($,{icon:"import_export",label:"import from Spotify",onClick:a[1]||(a[1]=O=>l("/collection/playlists"))})]))}}),we={__name:"index",setup(t){const o=w();return(r,l)=>g(o).notEmpty?(s(),_(le,{key:0})):(s(),_(pe,{key:1}))}};export{we as default};
