import{_ as m,o as s,c as n,a as i,b as y,t as v,d as u,r as C,e as I,f as _,w as c,u as k,p as H,g as r,F as h,h as p,i as N,j,k as F,l as q,m as B,n as E,q as $,s as L,v as T}from"./index.2f8d843b.js";import{g as z,F as R,c as M}from"./song.6b14bab3.js";import{T as S}from"./TrackCompact.ad09b126.js";import{S as P,L as x}from"./LightPlaylistEntry.e2df864e.js";import{P as V}from"./PlaylistItem.24977291.js";import"./ImportSpotifyAlbum.vue_vue_type_script_setup_true_lang.213269ec.js";import"./TrackInfo.41ba012d.js";import"./MiniPlayer.1ad55081.js";import"./ImportSpotifySong.vue_vue_type_script_setup_true_lang.23799e1a.js";import"./SongCtx.7489cf6d.js";import"./EditSong.vue_vue_type_script_setup_true_lang.3ba4fbd9.js";const G={name:"FlexShelf",props:{heading:String,icon:String}},A={class:"shelf"},J={class:"header"},W={key:0},K={key:0,class:"icon material-symbols-round"},Q={class:"items"};function U(e,o,d,l,t,a){return s(),n("div",A,[i("div",J,[d.heading||d.icon?(s(),n("h2",W,[y(v(d.heading),1),d.icon?(s(),n("span",K,v(d.icon),1)):u("",!0)])):u("",!0)]),i("div",Q,[C(e.$slots,"default",{},void 0,!0)])])}const g=m(G,[["render",U],["__scopeId","data-v-b884f5aa"]]);const X={class:"home-playlist drop-shadow-md"},Y=["src"],Z={__name:"Playlist",props:{name:{type:String,required:!0},cover:{type:String,required:!0},href:{type:String,required:!0}},setup(e){return(o,d)=>{const l=I("router-link");return s(),_(l,{to:e.href,class:"no-underline"},{default:c(()=>[i("div",X,[i("img",{src:k(H)(e.cover)},null,8,Y),i("h2",null,v(e.name),1)])]),_:1},8,["to"])}}},ee=m(Z,[["__scopeId","data-v-62cb83fd"]]);const te=e=>(F("data-v-a91b852a"),e=e(),q(),e),se={class:"home"},oe={class:"main"},ae={key:0,class:"playlists"},ie={key:1,class:"liked"},ne={key:2,class:"breaking"},re={class:"side"},le={key:0,class:"releases"},ce={key:1,class:"disovery"},de={key:2,class:"recommendations"},ue=te(()=>i("h2",null,"Recommendations",-1)),_e={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],picks:[],songs:[],liked:[],breaking:[],recommendations:[],data:j()}},mounted(){fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),fetch("/api/me/liked").then(e=>e.json()).then(e=>{this.liked=e.songs.slice(0,3)}),fetch("/api/me/new").then(e=>e.json()).then(e=>{this.breaking=e.songs.slice(0,3)}),this.pick()},computed:{playlists(){return this.data.playlists}},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const o=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.src||e.url}});window.dispatchEvent(o)},async pick(){if(!this.data.playlists.length){setTimeout(()=>this.pick(),2e3);return}if(this.songs=(await Promise.all(this.playlists.map(async e=>{var o;return((o=await z(e.id))==null?void 0:o.songs)||[]}))).flat(),!(this.songs.length<3)){for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}}},he=Object.assign(_e,{setup(e){return(o,d)=>{const l=I("router-link");return s(),n("div",se,[i("div",oe,[o.playlists.length?(s(),n("div",ae,[i("h2",null,[r(l,{to:"/collection/playlists",class:"linkOnHover"},{default:c(()=>[y("Playlists")]),_:1})]),r(g,null,{default:c(()=>[(s(!0),n(h,null,p(o.playlists,(t,a)=>(s(),_(ee,{key:a,name:t.name,cover:t.cover,href:t==null?void 0:t.href},null,8,["name","cover","href"]))),128))]),_:1})])):u("",!0),o.liked.length?(s(),n("div",ie,[i("h2",null,[r(l,{to:"/collection/tracks",class:"linkOnHover"},{default:c(()=>[y("Liked Songs")]),_:1})]),r(P),(s(!0),n(h,null,p(o.liked,(t,a)=>(s(),_(x,{key:a,index:a,loadAt:{type:"collection"},source:t.source,id:t.id,title:t.title,playing:t.playing,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])):u("",!0),o.breaking.length?(s(),n("div",ne,[i("h2",null,[r(l,{to:"/collection/tracks/breaking",class:"linkOnHover"},{default:c(()=>[y("Breaking Songs")]),_:1})]),r(P),(s(!0),n(h,null,p(o.breaking,(t,a)=>(s(),_(x,{key:a,index:a,loadAt:{type:"collection/breaking"},source:t.source,id:t.id,title:t.title,playing:t.playing,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])):u("",!0)]),i("div",re,[o.releases.length?(s(),n("div",le,[i("h2",null,[r(l,{to:"/collection/releases",class:"linkOnHover"},{default:c(()=>[y("Out now")]),_:1})]),r(g,null,{default:c(()=>[(s(!0),n(h,null,p(o.releases,(t,a)=>(s(),_(S,{onPlay:()=>o.playRecommendation(t),key:a,artist:t.artist,title:t.title,cover:t.cover,href:t.url},null,8,["onPlay","artist","title","cover","href"]))),128))]),_:1})])):u("",!0),o.picks.length?(s(),n("div",ce,[i("h2",null,[r(l,{to:"/discover",class:"linkOnHover"},{default:c(()=>[y("Discover")]),_:1})]),r(g,null,{default:c(()=>[(s(!0),n(h,null,p(o.picks,(t,a)=>(s(),_(S,{onPlay:()=>o.playDiscover(t),key:a,artist:t.artist,title:t.title,cover:k(N)(t.cover),id:t.id,href:t.href},null,8,["onPlay","artist","title","cover","id","href"]))),128))]),_:1})])):u("",!0),o.recommendations.length?(s(),n("div",de,[ue,r(g,null,{default:c(()=>[(s(!0),n(h,null,p(o.recommendations,(t,a)=>(s(),_(S,{onPlay:()=>o.playRecommendation(t),key:a,artist:t.artist,title:t.title,cover:t.cover,href:t.src},null,8,["onPlay","artist","title","cover","href"]))),128))]),_:1})])):u("",!0)])])}}}),pe=m(he,[["__scopeId","data-v-a91b852a"]]);const fe={},ye={class:"card"};function me(e,o){return s(),n("div",ye,[C(e.$slots,"default",{},void 0,!0)])}const O=m(fe,[["render",me],["__scopeId","data-v-7c2599c8"]]),ve={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 168 168"},ge=i("path",{fill:"#111",d:"M83.996.277C37.747.277.253 37.77.253 84.019c0 46.251 37.494 83.741 83.743 83.741 46.254 0 83.744-37.49 83.744-83.741 0-46.246-37.49-83.738-83.745-83.738l.001-.004zm38.404 120.78a5.217 5.217 0 0 1-7.18 1.73c-19.662-12.01-44.414-14.73-73.564-8.07a5.222 5.222 0 0 1-6.249-3.93 5.213 5.213 0 0 1 3.926-6.25c31.9-7.291 59.263-4.15 81.337 9.34 2.46 1.51 3.24 4.72 1.73 7.18zm10.25-22.805c-1.89 3.075-5.91 4.045-8.98 2.155-22.51-13.839-56.823-17.846-83.448-9.764-3.453 1.043-7.1-.903-8.148-4.35a6.538 6.538 0 0 1 4.354-8.143c30.413-9.228 68.222-4.758 94.072 11.127 3.07 1.89 4.04 5.91 2.15 8.976v-.001zm.88-23.744c-26.99-16.031-71.52-17.505-97.289-9.684-4.138 1.255-8.514-1.081-9.768-5.219a7.835 7.835 0 0 1 5.221-9.771c29.581-8.98 78.756-7.245 109.83 11.202a7.823 7.823 0 0 1 2.74 10.733c-2.2 3.722-7.02 4.949-10.73 2.739z"},null,-1),ke=[ge];function be(e,o){return s(),n("svg",ve,ke)}const $e={render:be},Se={class:"flex items-center justify-center h-12 p-4 mt-4 bg-fg text-bg rounded-full"},we={key:1},Pe=B({__name:"IconButton",props:{icon:{type:String,required:!1},label:{type:String,required:!1}},setup(e){return(o,d)=>(s(),n("button",Se,[e.icon?(s(),n("span",{key:0,class:E(["material-symbols-rounded",{"mr-2":e.label}])},v(e.icon),3)):u("",!0),e.label?(s(),n("span",we,v(e.label),1)):u("",!0)]))}});const xe=m(Pe,[["__scopeId","data-v-2ecdf016"]]),b=e=>(F("data-v-1bf80023"),e=e(),q(),e),Oe={class:"onboarding p-4"},Ce=b(()=>i("h1",null,"So nice to meet you!",-1)),Ie=b(()=>i("p",null,"Let's get you set up",-1)),je={class:"grid grid-cols-2 gap-4 mt-8"},Fe=b(()=>i("div",{class:"flex flex-row items-center"},[i("span",{class:"material-symbols-rounded ms-wght-700 text-4xl mr-4"},"add"),i("h2",null,"Create your first playlist")],-1)),qe={class:"flex flex-row justify-end w-full"},Be={class:"flex flex-row items-center"},De=b(()=>i("h2",null,"Import from Spotify",-1)),He={class:"spotify-playlists"},Ne=B({__name:"Onboarding",setup(e){const o=$([]),d=$(!1),l=$(null);L(),T().then(a=>{d.value=a}),fetch("/api/spotify/playlists").then(a=>a.json()).then(a=>{o.value=a});const t={fields:[{name:"name",label:"Name",placeholder:"Playlist name",type:"text",required:!0},{name:"description",label:"Description",placeholder:"Playlist description",type:"text",required:!1}],submit:{label:"Create",action:async()=>{const a=l.value.toObject();await M(a.name,a.description)}}};return(a,w)=>(s(),n("div",Oe,[Ce,Ie,i("div",je,[r(O,null,{default:c(()=>[Fe,r(R,{ref_key:"createForm",ref:l,options:t.fields},null,8,["options"]),i("div",qe,[r(xe,{onClick:w[0]||(w[0]=f=>t.submit.action()),icon:"add",label:t.submit.label},null,8,["label"])])]),_:1}),r(O,null,{default:c(()=>[i("div",Be,[r(k($e),{class:"spotify mr-4"}),De]),i("div",He,[(s(!0),n(h,null,p(o.value,(f,D)=>(s(),_(V,{key:D,cover:f.cover,description:f.description,title:f.name,id:f.id,spotify:!0,href:`https://open.spotify.com/playlist/${f.id}`},null,8,["cover","description","title","id","href"]))),128))])]),_:1})])]))}});const Ee=m(Ne,[["__scopeId","data-v-1bf80023"]]),Qe={__name:"index",setup(e){const o=j();return(d,l)=>k(o).notEmpty?(s(),_(pe,{key:0})):(s(),_(Ee,{key:1}))}};export{Qe as default};
