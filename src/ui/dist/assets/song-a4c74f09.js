import{j as I,v as M,m as g,n as w,o as l,f as y,w as E,a as o,t as T,L as F,c as r,r as A,d as m,x as b,e as J,k as O,l as U,_ as C,F as P,i as L,u as k,g as H,T as V,h as z,y as W,z as G,A as K,p as Q,B as R,C as X}from"./index-b47f60f1.js";import{I as x,D as Y}from"./Dropdown-d5739a06.js";const f=I(),Z=async e=>{await fetch(`/api/playlists/${e.id}`,{method:"POST",body:JSON.stringify({name:e.name,description:e.description,cover:e.cover})}),await f.fetchPlaylists()},Se=async e=>{const t=await fetch(`/api/playlists/${e}`);if(t.status===404)return null;const c=await t.json();for(const n of c.songs)n.href=`/track/${M(n.id)}`;return c},Pe=async e=>{await fetch(`/api/playlists/${e}`,{method:"DELETE"}),await f.fetchPlaylists()},q=async()=>{const t=await(await fetch("/api/playlists/new")).json();return await f.fetchPlaylists(),t},Ve=async(e,t="",c="")=>{const n=await q();return await Z({id:n,name:e,description:t,cover:c}),n},xe=async(e,t)=>{await fetch(`/api/playlists/${e}/tracks`,{method:"DELETE",body:JSON.stringify({songId:t})}),await f.fetchPlaylists()},ee=e=>(O("data-v-7e86e799"),e=e(),U(),e),ae={class:"wrapper"},te={class:"header bg-secondary rounded-t-2xl p-3"},se={class:"title font-black"},le=ee(()=>o("span",{class:"title material-icons-round"}," close ",-1)),ne=[le],oe={key:1},ce={key:2,class:"p-4 pt-0"},re={key:0,class:"confirm"},de=g({__name:"Template",props:{name:{type:String,required:!0},submit:{type:Object,required:!0},secondary:{type:Object,required:!1,default:null}},emits:["submit","close","secondary"],setup(e,{expose:t,emit:c}){const n=e,u=w(!1),i=w(!1),a=w(""),s=()=>i.value=!1,h=()=>{u.value=!1,i.value=!0},S=()=>{u.value=!0,i.value=!0},D=async(p,d)=>{S();const _=await window.fetch(p,d);return h(),_.ok?_:(a.value=await _.text(),null)},v=()=>{s(),c("close")},N=()=>{c("submit"),v()},j=()=>{c("secondary"),v()};return t({show:h,hide:s,load:S,fetch:D}),(p,d)=>{const _=J("vue-final-modal");return l(),y(_,{modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=B=>i.value=B),classes:"modal-container","content-class":"modal-content",onClick:d[1]||(d[1]=b(()=>{},["stop"])),onContextmenu:d[2]||(d[2]=b(()=>{},["stop"])),onDrag:d[3]||(d[3]=b(()=>{},["stop"]))},{default:E(()=>[o("div",ae,[o("div",te,[o("h3",se,T(e.name),1),o("button",{class:"modal-close",onClick:v},ne)]),u.value?(l(),y(F,{key:0})):a.value?(l(),r("div",oe)):(l(),r("div",ce,[A(p.$slots,"default",{},void 0,!0),n.submit||n.secondary?(l(),r("div",re,[n.secondary?(l(),y(x,{key:0,icon:n.secondary.icon,label:n.secondary.label,type:n.secondary.type,onClick:j},null,8,["icon","label","type"])):m("",!0),n.submit?(l(),y(x,{key:1,icon:n.submit.icon,label:n.submit.label,type:n.submit.type,onClick:N},null,8,["icon","label","type"])):m("",!0)])):m("",!0)]))])]),_:3},8,["modelValue"])}}});const Te=C(de,[["__scopeId","data-v-7e86e799"]]),ie={class:"form"},ue={class:"content"},ye=["onClick"],me=["accept","onChange"],he=["onUpdate:modelValue","type","onChange"],_e=g({__name:"Form",props:{options:{type:Array,required:!0}},setup(e,{expose:t}){const c=e;return t({toObject:()=>{const u={};return c.options.forEach(i=>{u[i.name]=i.value}),u}}),(u,i)=>(l(),r("div",ie,[(l(!0),r(P,null,L(e.options,a=>(l(),r("div",{key:a.name,class:"option"},[o("h4",null,T(k(K)(a.name)),1),o("div",ue,[a.type=="upload"?(l(),r(P,{key:0},[o("span",{class:"material-symbols-rounded icon-button",onClick:()=>{var s,h;return(h=(s=u.$refs["upload-"+a.name])==null?void 0:s[0])==null?void 0:h.click()}}," file_upload ",8,ye),o("input",{ref_for:!0,ref:"upload-"+a.name,accept:a.accept,style:{display:"none"},type:"file",onChange:s=>a==null?void 0:a.onUpload(s.target.files[0])},null,40,me),H(V,{ref_for:!0,ref:"cover",modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,class:"addSong cover",type:"text",onChange:s=>a==null?void 0:a.onChange(a.value)},null,8,["modelValue","onUpdate:modelValue","icon","onChange"]),a.imagePreview?(l(),y(z,{key:0,src:k(Q)(a.value),class:"imagePreview",onClick:s=>k(R)(a.value)},null,8,["src","onClick"])):m("",!0)],64)):a.type=="dropdown"?(l(),y(Y,{key:1,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,options:a.options},null,8,["modelValue","onUpdate:modelValue","icon","options"])):a.type=="text"?(l(),y(V,{key:2,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,placeholder:a.placeholder,required:a.required,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,8,["modelValue","onUpdate:modelValue","icon","placeholder","required","type","onChange"])):W((l(),r("input",{key:3,"onUpdate:modelValue":s=>a.value=s,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,40,he)),[[G,a.value]])])]))),128))]))}});const Oe=C(_e,[["__scopeId","data-v-e4744ea3"]]),$=e=>(O("data-v-20f4a059"),e=e(),U(),e),fe=$(()=>o("div",{class:"index text-right"},"#",-1)),ve=$(()=>o("div",{class:"artist-title"}," title ",-1)),pe={key:0,class:"album"},we={key:1,class:"duration"},be=$(()=>o("span",{class:"material-symbols-rounded"},"schedule",-1)),ke=[be],ge=g({__name:"PlaylistHeader",props:{index:{type:Number,required:!0},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},withoutDuration:{type:Boolean,required:!1,default:!1}},setup(e){return(t,c)=>(l(),r("div",{class:X([{withAlbum:e.withAlbum,withMore:e.withMore},"playlist-header"])},[fe,ve,e.withAlbum?(l(),r("div",pe," album ")):m("",!0),e.withoutDuration?m("",!0):(l(),r("div",we,ke))],2))}});const Ue=C(ge,[["__scopeId","data-v-20f4a059"]]),qe=async e=>{await fetch(`/api/tracks/${e.id}`,{method:"PUT",body:JSON.stringify({source:e.source,title:e.title,artist:e.artist,album:e.album,cover:e.cover})})},De=async e=>await(await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:e})})).json(),Ne=async(e,t)=>{e==="new"&&(e=await q()),typeof e=="string"&&console.error("playlistId cannot be a string",e),await fetch(`/api/playlists/${e}/tracks`,{method:"POST",body:JSON.stringify({source:t.source,title:t.title,artist:t.artist,album:t.album,cover:t.cover})})},je=async(e,t=!0)=>{await fetch(`/api/tracks/${e}`,{method:"PUT",body:JSON.stringify({favourite:t})})},Be=async e=>{window.open(`/api/tracks/${e}/download`)};export{Oe as F,Ue as P,Te as T,Ne as a,De as b,Ve as c,Be as d,Z as e,je as f,Se as g,Pe as h,q as i,xe as r,qe as u};
