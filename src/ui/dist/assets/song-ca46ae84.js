import{j as D,v as E,m as V,n as w,o,f as y,w as I,a as i,t as P,L as q,c as u,r as B,d as h,x as g,e as F,k as J,l as M,_ as T,F as C,i as L,u as b,g as A,T as S,h as W,y as z,z as H,A as R,p as G,B as K,C as Q}from"./index-fd3eb342.js";import{I as $,D as X}from"./Dropdown-0ed13857.js";const p=D(),Y=async e=>{await fetch(`/api/playlists/${e.id}`,{method:"POST",body:JSON.stringify({name:e.name,description:e.description,cover:e.cover})}),await p.fetchPlaylists()},_e=async e=>{const t=await fetch(`/api/playlists/${e}`);if(t.status===404)return null;const l=await t.json();for(const n of l.songs)n.href=`/track/${E(n.id)}`;return l},we=async e=>{await fetch(`/api/playlists/${e}`,{method:"DELETE"}),await p.fetchPlaylists()},O=async()=>{const t=await(await fetch("/api/playlists/new")).json();return await p.fetchPlaylists(),t},ge=async(e,t="",l="")=>{const n=await O();return await Y({id:n,name:e,description:t,cover:l}),n},be=async(e,t)=>{await fetch(`/api/playlists/${e}/tracks`,{method:"DELETE",body:JSON.stringify({songId:t})}),await p.fetchPlaylists()},Z=e=>(J("data-v-7e86e799"),e=e(),M(),e),ee={class:"wrapper"},ae={class:"header bg-secondary rounded-t-2xl p-3"},te={class:"title font-black"},se=Z(()=>i("span",{class:"title material-icons-round"}," close ",-1)),ne=[se],oe={key:1},le={key:2,class:"p-4 pt-0"},ce={key:0,class:"confirm"},re=V({__name:"Template",props:{name:{type:String,required:!0},submit:{type:Object,required:!0},secondary:{type:Object,required:!1,default:null}},emits:["submit","close","secondary"],setup(e,{expose:t,emit:l}){const n=e,d=w(!1),r=w(!1),a=w(""),s=()=>r.value=!1,m=()=>{d.value=!1,r.value=!0},k=()=>{d.value=!0,r.value=!0},j=async(_,c)=>{k();const f=await window.fetch(_,c);return m(),f.ok?f:(a.value=await f.text(),null)},v=()=>{s(),l("close")},x=()=>{l("submit"),v()},U=()=>{l("secondary"),v()};return t({show:m,hide:s,load:k,fetch:j}),(_,c)=>{const f=F("vue-final-modal");return o(),y(f,{modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=N=>r.value=N),classes:"modal-container","content-class":"modal-content",onClick:c[1]||(c[1]=g(()=>{},["stop"])),onContextmenu:c[2]||(c[2]=g(()=>{},["stop"])),onDrag:c[3]||(c[3]=g(()=>{},["stop"]))},{default:I(()=>[i("div",ee,[i("div",ae,[i("h3",te,P(e.name),1),i("button",{class:"modal-close",onClick:v},ne)]),d.value?(o(),y(q,{key:0})):a.value?(o(),u("div",oe)):(o(),u("div",le,[B(_.$slots,"default",{},void 0,!0),n.submit||n.secondary?(o(),u("div",ce,[n.secondary?(o(),y($,{key:0,icon:n.secondary.icon,label:n.secondary.label,type:n.secondary.type,onClick:U},null,8,["icon","label","type"])):h("",!0),n.submit?(o(),y($,{key:1,icon:n.submit.icon,label:n.submit.label,type:n.submit.type,onClick:x},null,8,["icon","label","type"])):h("",!0)])):h("",!0)]))])]),_:3},8,["modelValue"])}}});const ke=T(re,[["__scopeId","data-v-7e86e799"]]),ie={class:"form"},de={class:"content"},ue=["onClick"],ye=["accept","onChange"],me=["onUpdate:modelValue","type","onChange"],fe=V({__name:"Form",props:{options:{type:Array,required:!0}},setup(e,{expose:t}){const l=e;return t({toObject:()=>{const d={};return l.options.forEach(r=>{d[r.name]=r.value}),d}}),(d,r)=>(o(),u("div",ie,[(o(!0),u(C,null,L(e.options,a=>(o(),u("div",{key:a.name,class:"option"},[i("h4",null,P(b(R)(a.name)),1),i("div",de,[a.type=="upload"?(o(),u(C,{key:0},[i("span",{class:"material-symbols-rounded icon-button",onClick:()=>{var s,m;return(m=(s=d.$refs["upload-"+a.name])==null?void 0:s[0])==null?void 0:m.click()}}," file_upload ",8,ue),i("input",{ref_for:!0,ref:"upload-"+a.name,accept:a.accept,style:{display:"none"},type:"file",onChange:s=>a==null?void 0:a.onUpload(s.target.files[0])},null,40,ye),A(S,{ref_for:!0,ref:"cover",modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,class:"addSong cover",type:"text",onChange:s=>a==null?void 0:a.onChange(a.value)},null,8,["modelValue","onUpdate:modelValue","icon","onChange"]),a.imagePreview?(o(),y(W,{key:0,src:b(G)(a.value),class:"imagePreview",onClick:s=>b(K)(a.value)},null,8,["src","onClick"])):h("",!0)],64)):a.type=="dropdown"?(o(),y(X,{key:1,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,options:a.options},null,8,["modelValue","onUpdate:modelValue","icon","options"])):a.type=="text"?(o(),y(S,{key:2,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,placeholder:a.placeholder,required:a.required,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,8,["modelValue","onUpdate:modelValue","icon","placeholder","required","type","onChange"])):z((o(),u("input",{key:3,"onUpdate:modelValue":s=>a.value=s,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,40,me)),[[H,a.value]])])]))),128))]))}});const Ce=T(fe,[["__scopeId","data-v-e4744ea3"]]),Se=async e=>{await fetch(`/api/tracks/${e.id}`,{method:"PUT",body:JSON.stringify({source:e.source,title:e.title,artist:e.artist,album:e.album,cover:e.cover})})},$e=async e=>await(await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:e})})).json(),Ve=async(e,t)=>{e==="new"&&(e=await O()),typeof e=="string"&&console.error("playlistId cannot be a string",e),await fetch(`/api/playlists/${e}/tracks`,{method:"POST",body:JSON.stringify({source:t.source,title:t.title,artist:t.artist,album:t.album,cover:t.cover})})},Pe=async(e,t=!0)=>{await fetch(`/api/tracks/${e}`,{method:"PUT",body:JSON.stringify({favourite:t})})},Te=async e=>{window.open(`/api/tracks/${e}/download`)},he=async e=>await(await fetch(`/api/tracks/${e}`)).json(),Oe=async e=>{const t=Q(e);return await he(t)},je=async(e,t=!1)=>await(await fetch("/api/spotify/meta",{method:"POST",body:JSON.stringify({id:e,forceFetch:t})})).json(),xe=async e=>await(await fetch(`/api/spotify/recommendations/${e}`)).json();export{Ce as F,ke as T,Ve as a,$e as b,ge as c,Te as d,Y as e,Pe as f,_e as g,we as h,O as i,Oe as j,je as k,xe as l,be as r,Se as u};
