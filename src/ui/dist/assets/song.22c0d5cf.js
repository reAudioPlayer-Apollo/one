import{B as b,C as y,o as l,f,w as U,a as o,t as m,L as I,c,r as D,d as w,F as h,q as k,e as O,k as S,l as V,_ as C,A as q,u as p,h as x,x as $,z as F,D as j,E as B,G as M,j as P}from"./index.6f3ae9d0.js";const L=a=>(S("data-v-2231ceda"),a=a(),V(),a),A={class:"wrapper"},E={class:"header"},J=L(()=>o("span",{class:"material-icons-round"}," close ",-1)),z=[J],G={key:0,class:"confirm"},H=b({__name:"Template",props:{name:{type:String,required:!0},submitName:{type:String,required:!0}},emits:["submit","close"],setup(a,{expose:n,emit:u}){const i=y(!1),s=y(!1),r=()=>s.value=!1,e=()=>{i.value=!1,s.value=!0},t=()=>{i.value=!0,s.value=!0},d=()=>{r(),u("close")},_=()=>{u("submit"),d()};return n({show:e,hide:r,load:t}),(g,v)=>{const T=O("vue-final-modal");return l(),f(T,{onContextmenu:v[0]||(v[0]=k(()=>{},["stop"])),modelValue:s.value,"onUpdate:modelValue":v[1]||(v[1]=N=>s.value=N),classes:"modal-container","content-class":"modal-content"},{default:U(()=>[o("div",A,[o("div",E,[o("h3",null,m(a.name),1),o("button",{class:"modal-close",onClick:d},z)]),i.value?(l(),f(I,{key:0})):(l(),c(h,{key:1},[D(g.$slots,"default",{},void 0,!0),a.submitName?(l(),c("div",G,[o("button",{onClick:_,class:"negative"},m(a.submitName),1)])):w("",!0)],64))])]),_:3},8,["modelValue"])}}});const ie=C(H,[["__scopeId","data-v-2231ceda"]]),K={class:"dropdown"},Q={class:"material-symbols-rounded"},R={key:0,class:"dropdown__options"},W=["onClick"],X=b({__name:"Dropdown",props:{modelValue:{type:String,required:!0},options:{type:Array,required:!0}},emits:["update:modelValue"],setup(a,{emit:n}){const u=a,i=y(u.modelValue),s=y(!1),r=t=>{i.value=t,n("update:modelValue",t),s.value=!1},e=q(()=>{const t=u.options.find(d=>d.value==i.value);return t?t.label:""});return window.onclick=()=>s.value=!1,(t,d)=>(l(),c("div",K,[o("div",{class:"dropdown__selected",onClick:d[0]||(d[0]=k(_=>s.value=!s.value,["stop"]))},[o("span",null,m(p(e)),1),o("i",Q,m(s.value?"expand_less":"expand_more"),1)]),s.value?(l(),c("div",R,[(l(!0),c(h,null,x(a.options,_=>(l(),c("div",{key:_.value,class:"dropdown__option",onClick:k(g=>r(_.value),["stop"])},m(_.label),9,W))),128))])):w("",!0)]))}});const Y=C(X,[["__scopeId","data-v-c21c2d2a"]]),Z=a=>(S("data-v-244a126d"),a=a(),V(),a),ee={class:"form"},ae={class:"content"},te=["onClick"],se=Z(()=>o("span",{class:"material-symbols-rounded"},"file_upload",-1)),le=[se],oe=["accept","onChange"],ne=["onUpdate:modelValue","onChange"],ce=["onClick","src"],de=["onUpdate:modelValue","type","onChange"],re=b({__name:"Form",props:{options:{type:Array,required:!0}},setup(a,{expose:n}){const u=a;return n({toObject:()=>{const s={};return u.options.forEach(r=>{s[r.name]=r.value}),s}}),(s,r)=>(l(),c("div",ee,[(l(!0),c(h,null,x(a.options,e=>(l(),c("div",{key:e.name,class:"option"},[o("h4",null,m(p(B)(e.name)),1),o("div",ae,[e.type=="upload"?(l(),c(h,{key:0},[o("button",{onClick:()=>{var t,d;return(d=(t=s.$refs["upload-"+e.name])==null?void 0:t[0])==null?void 0:d.click()},class:"icon-button"},le,8,te),o("input",{type:"file",ref_for:!0,ref:"upload-"+e.name,style:{display:"none"},accept:e.accept,onChange:t=>e==null?void 0:e.onUpload(t.target.files[0])},null,40,oe),$(o("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t=>e.value=t,ref_for:!0,ref:"cover",onChange:t=>e==null?void 0:e.onChange(e.value)},null,40,ne),[[F,e.value]]),e.imagePreview?(l(),c("img",{key:0,onClick:t=>p(M)(e.value),class:"imagePreview",src:p(P)(e.value)},null,8,ce)):w("",!0)],64)):e.type=="dropdown"?(l(),f(Y,{key:1,modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,options:e.options},null,8,["modelValue","onUpdate:modelValue","options"])):$((l(),c("input",{key:2,"onUpdate:modelValue":t=>e.value=t,type:e.type,onChange:t=>e==null?void 0:e.onChange(e.value)},null,40,de)),[[j,e.value]])])]))),128))]))}});const _e=C(re,[["__scopeId","data-v-244a126d"]]),me=async a=>{console.log("updateSong",a),await fetch(`/api/tracks/${a.id}`,{method:"PUT",body:JSON.stringify({source:a.src,title:a.title,artist:a.artist,album:a.album,cover:a.cover})})},ve=async a=>await(await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:a})})).json(),pe=async(a,n)=>{console.log("addSong",n),await fetch(`/api/playlists/${a}/tracks`,{method:"POST",body:JSON.stringify({source:n.src,title:n.title,artist:n.artist,album:n.album,cover:n.cover})})};export{_e as F,ie as T,pe as a,ve as f,me as u};
