import{j,v as B,m as b,n as k,o as n,f as y,w as I,a as o,t as P,L as M,c as r,r as E,d as m,x as p,e as F,k as V,l as x,_ as w,F as C,i as A,u as v,g as J,T as $,h as L,y as H,z,A as W,p as G,B as K,C as Q}from"./index.f0322bf5.js";import{I as S,D as R}from"./Dropdown.fbebf60e.js";const _=j(),X=async e=>{await fetch(`/api/playlists/${e.id}`,{method:"POST",body:JSON.stringify({name:e.name,description:e.description,cover:e.cover})}),await _.fetchPlaylists()},ke=async e=>{const t=await fetch(`/api/playlists/${e}`);if(t.status===404)return null;const c=await t.json();for(const l of c.songs)l.href=`/track/${B(l.id)}`;return c},Ce=async e=>{await fetch(`/api/playlists/${e}`,{method:"DELETE"}),await _.fetchPlaylists()},T=async()=>{const t=await(await fetch("/api/playlists/new")).json();return await _.fetchPlaylists(),t},$e=async(e,t="",c="")=>{const l=await T();return await X({id:l,name:e,description:t,cover:c}),l},Se=async(e,t)=>{await fetch(`/api/playlists/${e}/tracks`,{method:"DELETE",body:JSON.stringify({songId:t})}),await _.fetchPlaylists()},Y=e=>(V("data-v-8f8e6b44"),e=e(),x(),e),Z={class:"wrapper"},ee={class:"header bg-secondary rounded-t-2xl p-3"},ae={class:"title font-black"},te=Y(()=>o("span",{class:"title material-icons-round"}," close ",-1)),se=[te],le={key:1,class:"p-4 pt-0"},ne={key:0,class:"confirm"},oe=b({__name:"Template",props:{name:{type:String,required:!0},submit:{type:Object,required:!0},secondary:{type:Object,required:!1,default:null}},emits:["submit","close","secondary"],setup(e,{expose:t,emit:c}){const l=e,i=k(!1),d=k(!1),a=()=>d.value=!1,s=()=>{i.value=!1,d.value=!0},h=()=>{i.value=!0,d.value=!0},f=()=>{a(),c("close")},O=()=>{c("submit"),f()},U=()=>{c("secondary"),f()};return t({show:s,hide:a,load:h}),(q,u)=>{const D=F("vue-final-modal");return n(),y(D,{modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=N=>d.value=N),classes:"modal-container","content-class":"modal-content",onClick:u[1]||(u[1]=p(()=>{},["stop"])),onContextmenu:u[2]||(u[2]=p(()=>{},["stop"])),onDrag:u[3]||(u[3]=p(()=>{},["stop"]))},{default:I(()=>[o("div",Z,[o("div",ee,[o("h3",ae,P(e.name),1),o("button",{class:"modal-close",onClick:f},se)]),i.value?(n(),y(M,{key:0})):(n(),r("div",le,[E(q.$slots,"default",{},void 0,!0),l.submit||l.secondary?(n(),r("div",ne,[l.secondary?(n(),y(S,{key:0,icon:l.secondary.icon,label:l.secondary.label,type:l.secondary.type,onClick:U},null,8,["icon","label","type"])):m("",!0),l.submit?(n(),y(S,{key:1,icon:l.submit.icon,label:l.submit.label,type:l.submit.type,onClick:O},null,8,["icon","label","type"])):m("",!0)])):m("",!0)]))])]),_:3},8,["modelValue"])}}});const Pe=w(oe,[["__scopeId","data-v-8f8e6b44"]]),ce={class:"form"},re={class:"content"},de=["onClick"],ie=["accept","onChange"],ue=["onUpdate:modelValue","type","onChange"],ye=b({__name:"Form",props:{options:{type:Array,required:!0}},setup(e,{expose:t}){const c=e;return t({toObject:()=>{const i={};return c.options.forEach(d=>{i[d.name]=d.value}),i}}),(i,d)=>(n(),r("div",ce,[(n(!0),r(C,null,A(e.options,a=>(n(),r("div",{key:a.name,class:"option"},[o("h4",null,P(v(W)(a.name)),1),o("div",re,[a.type=="upload"?(n(),r(C,{key:0},[o("span",{class:"material-symbols-rounded icon-button",onClick:()=>{var s,h;return(h=(s=i.$refs["upload-"+a.name])==null?void 0:s[0])==null?void 0:h.click()}}," file_upload ",8,de),o("input",{ref_for:!0,ref:"upload-"+a.name,accept:a.accept,style:{display:"none"},type:"file",onChange:s=>a==null?void 0:a.onUpload(s.target.files[0])},null,40,ie),J($,{ref_for:!0,ref:"cover",modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,class:"addSong cover",type:"text",onChange:s=>a==null?void 0:a.onChange(a.value)},null,8,["modelValue","onUpdate:modelValue","icon","onChange"]),a.imagePreview?(n(),y(L,{key:0,src:v(G)(a.value),class:"imagePreview",onClick:s=>v(K)(a.value)},null,8,["src","onClick"])):m("",!0)],64)):a.type=="dropdown"?(n(),y(R,{key:1,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,options:a.options},null,8,["modelValue","onUpdate:modelValue","icon","options"])):a.type=="text"?(n(),y($,{key:2,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,placeholder:a.placeholder,required:a.required,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,8,["modelValue","onUpdate:modelValue","icon","placeholder","required","type","onChange"])):H((n(),r("input",{key:3,"onUpdate:modelValue":s=>a.value=s,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,40,ue)),[[z,a.value]])])]))),128))]))}});const Ve=w(ye,[["__scopeId","data-v-e7fa149a"]]),g=e=>(V("data-v-538de663"),e=e(),x(),e),me=g(()=>o("div",{class:"index text-right"},"#",-1)),he=g(()=>o("div",{class:"artist-title"}," title ",-1)),_e={key:0,class:"album"},fe={key:1,class:"duration"},pe=g(()=>o("span",{class:"material-symbols-rounded"},"schedule",-1)),ve=[pe],be=b({__name:"PlaylistHeader",props:{index:{type:Number,required:!0},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},withoutDuration:{type:Boolean,required:!1,default:!1}},setup(e){return(t,c)=>(n(),r("div",{class:Q([{withAlbum:e.withAlbum,withMore:e.withMore},"playlist-header"])},[me,he,e.withAlbum?(n(),r("div",_e," album ")):m("",!0),e.withoutDuration?m("",!0):(n(),r("div",fe,ve))],2))}});const xe=w(be,[["__scopeId","data-v-538de663"]]),Te=async e=>{await fetch(`/api/tracks/${e.id}`,{method:"PUT",body:JSON.stringify({source:e.source,title:e.title,artist:e.artist,album:e.album,cover:e.cover})})},Oe=async e=>await(await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:e})})).json(),Ue=async(e,t)=>{e==="new"&&(e=await T()),typeof e=="string"&&console.error("playlistId cannot be a string",e),await fetch(`/api/playlists/${e}/tracks`,{method:"POST",body:JSON.stringify({source:t.source,title:t.title,artist:t.artist,album:t.album,cover:t.cover})})},qe=async(e,t=!0)=>{await fetch(`/api/tracks/${e}`,{method:"PUT",body:JSON.stringify({favourite:t})})},De=async e=>{window.open(`/api/tracks/${e}/download`)};export{Ve as F,xe as P,Pe as T,Ue as a,Oe as b,$e as c,De as d,X as e,qe as f,ke as g,Ce as h,T as i,Se as r,Te as u};
