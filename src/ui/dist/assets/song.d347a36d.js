import{j,v as B,m as b,n as k,o,f as y,w as I,a as n,t as P,L as M,c as r,r as E,d as m,x as p,e as F,k as V,l as x,_ as w,F as C,i as A,u as v,g as J,T as $,y as L,z as H,A as z,p as W,B as G,C as K}from"./index.287edd0f.js";import{I as S,D as Q}from"./Dropdown.1957d047.js";const _=j(),R=async e=>{await fetch(`/api/playlists/${e.id}`,{method:"POST",body:JSON.stringify({name:e.name,description:e.description,cover:e.cover})}),await _.fetchPlaylists()},ke=async e=>{const t=await fetch(`/api/playlists/${e}`);if(t.status===404)return null;const c=await t.json();for(const l of c.songs)l.href=`/track/${B(l.id)}`;return c},Ce=async e=>{await fetch(`/api/playlists/${e}`,{method:"DELETE"}),await _.fetchPlaylists()},T=async()=>{const t=await(await fetch("/api/playlists/new")).json();return await _.fetchPlaylists(),t},$e=async(e,t="",c="")=>{const l=await T();return await R({id:l,name:e,description:t,cover:c}),l},Se=async(e,t)=>{await fetch(`/api/playlists/${e}/tracks`,{method:"DELETE",body:JSON.stringify({songId:t})}),await _.fetchPlaylists()},X=e=>(V("data-v-013d6503"),e=e(),x(),e),Y={class:"wrapper"},Z={class:"header bg-secondary rounded-t-2xl p-3"},ee={class:"font-black"},ae=X(()=>n("span",{class:"material-icons-round"}," close ",-1)),te=[ae],se={key:1,class:"p-4 pt-0"},le={key:0,class:"confirm"},oe=b({__name:"Template",props:{name:{type:String,required:!0},submit:{type:Object,required:!0},secondary:{type:Object,required:!1,default:null}},emits:["submit","close","secondary"],setup(e,{expose:t,emit:c}){const l=e,i=k(!1),d=k(!1),a=()=>d.value=!1,s=()=>{i.value=!1,d.value=!0},h=()=>{i.value=!0,d.value=!0},f=()=>{a(),c("close")},O=()=>{c("submit"),f()},U=()=>{c("secondary"),f()};return t({show:s,hide:a,load:h}),(q,u)=>{const D=F("vue-final-modal");return o(),y(D,{modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=N=>d.value=N),classes:"modal-container","content-class":"modal-content",onClick:u[1]||(u[1]=p(()=>{},["stop"])),onContextmenu:u[2]||(u[2]=p(()=>{},["stop"])),onDrag:u[3]||(u[3]=p(()=>{},["stop"]))},{default:I(()=>[n("div",Y,[n("div",Z,[n("h3",ee,P(e.name),1),n("button",{class:"modal-close",onClick:f},te)]),i.value?(o(),y(M,{key:0})):(o(),r("div",se,[E(q.$slots,"default",{},void 0,!0),l.submit||l.secondary?(o(),r("div",le,[l.secondary?(o(),y(S,{key:0,icon:l.secondary.icon,label:l.secondary.label,type:l.secondary.type,onClick:U},null,8,["icon","label","type"])):m("",!0),l.submit?(o(),y(S,{key:1,icon:l.submit.icon,label:l.submit.label,type:l.submit.type,onClick:O},null,8,["icon","label","type"])):m("",!0)])):m("",!0)]))])]),_:3},8,["modelValue"])}}});const Pe=w(oe,[["__scopeId","data-v-013d6503"]]),ne={class:"form"},ce={class:"content"},re=["onClick"],de=["accept","onChange"],ie=["src","onClick"],ue=["onUpdate:modelValue","type","onChange"],ye=b({__name:"Form",props:{options:{type:Array,required:!0}},setup(e,{expose:t}){const c=e;return t({toObject:()=>{const i={};return c.options.forEach(d=>{i[d.name]=d.value}),i}}),(i,d)=>(o(),r("div",ne,[(o(!0),r(C,null,A(e.options,a=>(o(),r("div",{key:a.name,class:"option"},[n("h4",null,P(v(z)(a.name)),1),n("div",ce,[a.type=="upload"?(o(),r(C,{key:0},[n("span",{class:"material-symbols-rounded icon-button",onClick:()=>{var s,h;return(h=(s=i.$refs["upload-"+a.name])==null?void 0:s[0])==null?void 0:h.click()}}," file_upload ",8,re),n("input",{ref_for:!0,ref:"upload-"+a.name,accept:a.accept,style:{display:"none"},type:"file",onChange:s=>a==null?void 0:a.onUpload(s.target.files[0])},null,40,de),J($,{ref_for:!0,ref:"cover",modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,class:"addSong cover",type:"text",onChange:s=>a==null?void 0:a.onChange(a.value)},null,8,["modelValue","onUpdate:modelValue","icon","onChange"]),a.imagePreview?(o(),r("img",{key:0,src:v(W)(a.value),class:"imagePreview",onClick:s=>v(G)(a.value)},null,8,ie)):m("",!0)],64)):a.type=="dropdown"?(o(),y(Q,{key:1,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,options:a.options},null,8,["modelValue","onUpdate:modelValue","options"])):a.type=="text"?(o(),y($,{key:2,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,icon:a.icon,placeholder:a.placeholder,required:a.required,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,8,["modelValue","onUpdate:modelValue","icon","placeholder","required","type","onChange"])):L((o(),r("input",{key:3,"onUpdate:modelValue":s=>a.value=s,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,40,ue)),[[H,a.value]])])]))),128))]))}});const Ve=w(ye,[["__scopeId","data-v-48b46741"]]),g=e=>(V("data-v-9bdc19b2"),e=e(),x(),e),me=g(()=>n("div",{class:"index text-right"},"#",-1)),he=g(()=>n("div",{class:"artist-title"}," title ",-1)),_e={key:0,class:"album"},fe={key:1,class:"duration"},pe=g(()=>n("span",{class:"material-symbols-rounded"},"schedule",-1)),ve=[pe],be=b({__name:"PlaylistHeader",props:{index:{type:Number,required:!0},withAlbum:{type:Boolean,required:!1,default:!1},withMore:{type:Boolean,required:!1,default:!1},withoutDuration:{type:Boolean,required:!1,default:!1}},setup(e){return(t,c)=>(o(),r("div",{class:K([{withAlbum:e.withAlbum,withMore:e.withMore},"playlist-header"])},[me,he,e.withAlbum?(o(),r("div",_e," album ")):m("",!0),e.withoutDuration?m("",!0):(o(),r("div",fe,ve))],2))}});const xe=w(be,[["__scopeId","data-v-9bdc19b2"]]),Te=async e=>{await fetch(`/api/tracks/${e.id}`,{method:"PUT",body:JSON.stringify({source:e.source,title:e.title,artist:e.artist,album:e.album,cover:e.cover})})},Oe=async e=>await(await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:e})})).json(),Ue=async(e,t)=>{e==="new"&&(e=await T()),typeof e=="string"&&console.error("playlistId cannot be a string",e),await fetch(`/api/playlists/${e}/tracks`,{method:"POST",body:JSON.stringify({source:t.source,title:t.title,artist:t.artist,album:t.album,cover:t.cover})})},qe=async(e,t=!0)=>{await fetch(`/api/tracks/${e}`,{method:"PUT",body:JSON.stringify({favourite:t})})},De=async e=>{window.open(`/api/tracks/${e}/download`)};export{Ve as F,xe as P,Pe as T,Ue as a,Oe as b,$e as c,De as d,R as e,qe as f,ke as g,Ce as h,T as i,Se as r,Te as u};
