import{j as U,v as E,m as C,n as v,o as l,f as k,w as j,a as u,t as p,L as q,c as d,r as F,x as M,d as f,F as w,y as S,e as J,k as N,l as P,_ as $,z as V,A as L,u as h,i as x,B as I,C as T,D as A,E as z,G as H,H as G,p as R}from"./index.433ad326.js";const g=U(),W=async e=>{await fetch(`/api/playlists/${e.id}`,{method:"POST",body:JSON.stringify({name:e.name,description:e.description,cover:e.cover})}),await g.fetchPlaylists()},we=async e=>{const t=await fetch(`/api/playlists/${e}`);if(t.status===404)return null;const c=await t.json();for(const r of c.songs)r.href=`/track/${E(r.id)}`;return c},ge=async e=>{await fetch(`/api/playlists/${e}`,{method:"DELETE"}),await g.fetchPlaylists()},D=async()=>{const t=await(await fetch("/api/playlists/new")).json();return await g.fetchPlaylists(),t},be=async(e,t="",c="")=>{const r=await D();return await W({id:r,name:e,description:t,cover:c}),r},ke=async(e,t)=>{await fetch(`/api/playlists/${e}/tracks`,{method:"DELETE",body:JSON.stringify({songId:t})}),await g.fetchPlaylists()},K=e=>(N("data-v-22ff1c46"),e=e(),P(),e),Q={class:"wrapper"},X={class:"header"},Y=K(()=>u("span",{class:"material-icons-round"}," close ",-1)),Z=[Y],ee={key:0,class:"confirm"},ae=C({__name:"Template",props:{name:{type:String,required:!0},submitName:{type:String,required:!0},secondaryName:{type:String,required:!1,default:null},secondaryType:{type:String,required:!1,default:null}},emits:["submit","close","secondary"],setup(e,{expose:t,emit:c}){const r=v(!1),o=v(!1),m=()=>o.value=!1,a=()=>{r.value=!1,o.value=!0},s=()=>{r.value=!0,o.value=!0},n=()=>{m(),c("close")},i=()=>{c("submit"),n()},y=()=>{c("secondary"),n()};return t({show:a,hide:m,load:s}),(b,_)=>{const O=J("vue-final-modal");return l(),k(O,{onContextmenu:_[0]||(_[0]=S(()=>{},["stop"])),modelValue:o.value,"onUpdate:modelValue":_[1]||(_[1]=B=>o.value=B),classes:"modal-container","content-class":"modal-content"},{default:j(()=>[u("div",Q,[u("div",X,[u("h3",null,p(e.name),1),u("button",{class:"modal-close",onClick:n},Z)]),r.value?(l(),k(q,{key:0})):(l(),d(w,{key:1},[F(b.$slots,"default",{},void 0,!0),e.submitName||e.secondaryName?(l(),d("div",ee,[e.secondaryName?(l(),d("button",{key:0,class:M(["secondary",e.secondaryType]),onClick:y},p(e.secondaryName),3)):f("",!0),e.submitName?(l(),d("button",{key:1,onClick:i,class:"negative"},p(e.submitName),1)):f("",!0)])):f("",!0)],64))])]),_:3},8,["modelValue"])}}});const Se=$(ae,[["__scopeId","data-v-22ff1c46"]]),te={class:"dropdown"},se={class:"material-symbols-rounded"},oe=["onClick"],ne=C({__name:"Dropdown",props:{modelValue:{type:String,required:!0},options:{type:Array,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const c=e,r=v(c.modelValue),o=v(!1);V(c,n=>{r.value=n.modelValue},{deep:!0});const m=n=>{r.value=n,t("update:modelValue",n),o.value=!1},a=L(()=>{const n=c.options.find(i=>i.value==r.value);return n?n.label:""}),s=v(null);return V(o,n=>{I(()=>{if(n){const i=s.value.getBoundingClientRect();window.innerHeight-i.top>i.height?(s.value.style.top="100%",s.value.style.bottom="auto"):(s.value.style.top="auto",s.value.style.bottom="100%")}})}),window.onclick=()=>o.value=!1,(n,i)=>(l(),d("div",te,[u("div",{class:"dropdown__selected",onClick:i[0]||(i[0]=S(y=>o.value=!o.value,["stop"]))},[u("span",null,p(h(a)),1),u("i",se,p(o.value?"expand_less":"expand_more"),1)]),o.value?(l(),d("div",{key:0,ref_key:"trueDropdown",ref:s,class:"dropdown__options"},[(l(!0),d(w,null,x(e.options,y=>(l(),d("div",{key:y.value,class:"dropdown__option",onClick:S(b=>m(y.value),["stop"])},p(y.label),9,oe))),128))],512)):f("",!0)]))}});const le=$(ne,[["__scopeId","data-v-8b5da36c"]]),ce=e=>(N("data-v-af698de3"),e=e(),P(),e),re={class:"form"},de={class:"content"},ue=["onClick"],ie=ce(()=>u("span",{class:"material-symbols-rounded"},"file_upload",-1)),me=[ie],ye=["accept","onChange"],pe=["onUpdate:modelValue","onChange"],ve=["onClick","src"],fe=["onUpdate:modelValue","type","onChange"],_e=C({__name:"Form",props:{options:{type:Array,required:!0}},setup(e,{expose:t}){const c=e;return t({toObject:()=>{const o={};return c.options.forEach(m=>{o[m.name]=m.value}),o}}),(o,m)=>(l(),d("div",re,[(l(!0),d(w,null,x(e.options,a=>(l(),d("div",{key:a.name,class:"option"},[u("h4",null,p(h(H)(a.name)),1),u("div",de,[a.type=="upload"?(l(),d(w,{key:0},[u("button",{onClick:()=>{var s,n;return(n=(s=o.$refs["upload-"+a.name])==null?void 0:s[0])==null?void 0:n.click()},class:"icon-button"},me,8,ue),u("input",{type:"file",ref_for:!0,ref:"upload-"+a.name,style:{display:"none"},accept:a.accept,onChange:s=>a==null?void 0:a.onUpload(s.target.files[0])},null,40,ye),T(u("input",{type:"text",class:"addSong cover","onUpdate:modelValue":s=>a.value=s,ref_for:!0,ref:"cover",onChange:s=>a==null?void 0:a.onChange(a.value)},null,40,pe),[[A,a.value]]),a.imagePreview?(l(),d("img",{key:0,onClick:s=>h(G)(a.value),class:"imagePreview",src:h(R)(a.value)},null,8,ve)):f("",!0)],64)):a.type=="dropdown"?(l(),k(le,{key:1,modelValue:a.value,"onUpdate:modelValue":s=>a.value=s,options:a.options},null,8,["modelValue","onUpdate:modelValue","options"])):T((l(),d("input",{key:2,"onUpdate:modelValue":s=>a.value=s,type:a.type,onChange:s=>a.onChange?a==null?void 0:a.onChange(a.value):null},null,40,fe)),[[z,a.value]])])]))),128))]))}});const Ce=$(_e,[["__scopeId","data-v-af698de3"]]),$e=async e=>{await fetch(`/api/tracks/${e.id}`,{method:"PUT",body:JSON.stringify({source:e.src,title:e.title,artist:e.artist,album:e.album,cover:e.cover})})},Ve=async e=>await(await fetch("/api/browse/track",{method:"POST",body:JSON.stringify({url:e})})).json(),Te=async(e,t)=>{e==="new"&&(e=await D()),typeof e=="string"&&console.error("playlistId cannot be a string",e),await fetch(`/api/playlists/${e}/tracks`,{method:"POST",body:JSON.stringify({source:t.src||t.source,title:t.title,artist:t.artist,album:t.album,cover:t.cover})})},Ne=async(e,t=!0)=>{await fetch(`/api/tracks/${e}`,{method:"PUT",body:JSON.stringify({favourite:t})})},Pe=async e=>{window.open(`/api/tracks/${e}/download`)};export{Ce as F,Se as T,Te as a,Ve as b,be as c,Pe as d,W as e,Ne as f,we as g,ge as h,D as i,ke as r,$e as u};
