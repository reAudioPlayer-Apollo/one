import{_ as f,o as r,c,a as l,k as m,n as p,g as h,F as v,i as b,f as S,d as x,t as y,e as u,p as k,h as w}from"./index.2e38b25c.js";import{L as P}from"./LightPlaylistEntry.411cf247.js";import{S as B}from"./SpotifyPlaylistHeader.9637d5ea.js";import"./EditSong.81400b39.js";import"./FindSources.08f78238.js";const N={components:{LightPlaylistEntry:P,SpotifyPlaylistHeader:B},name:"BigPlayer",methods:{toggleMaximise(){this.maximised=!this.maximised,this.$emit("maximise",this.maximised)},fetchPlaylist(){fetch("/api/me/player/current-playlist").then(s=>s.json()).then(s=>this.playlist=s)},updateData(s){var o,n,a,e;if(console.log(s),s.path=="player.song"){if(this.cover=((o=s==null?void 0:s.data)==null?void 0:o.cover)||"/assets/img/music_placeholder.png",this.currentSongName=((n=s==null?void 0:s.data)==null?void 0:n.title)||"",this.$refs.playlistScroll.scrollTop)return;const i=(e=document.getElementById(`bplayer-entry-${(a=s==null?void 0:s.data)==null?void 0:a.id}`))==null?void 0:e.offsetTop;!i&&i!=0&&window.setTimeout(()=>this.updateData(s),1e3),i>=354&&(this.$refs.playlistScroll.scrollTop=i-354);return}if(s.path=="player.playState"){this.playing=(s==null?void 0:s.data)||!1;return}}},data(){const s=()=>{console.log("attempting reconnect");let o=new WebSocket("ws://localhost:1234/ws");o.onclose=()=>{console.log("ws closed"),setTimeout(s,1e3)},o.onopen=()=>{console.log("ws connected")},o.onmessage=n=>{const a=JSON.parse(n.data);this.updateData(a)}};return s(),this.fetchPlaylist(),{cover:"/assets/img/music_placeholder.png",playlist:[],currentSongName:"",maximised:!1,noPlaylist:!1,playing:!1,animate:!1}}},C=s=>(k("data-v-41ae3b71"),s=s(),w(),s),D={class:"bigPlayer"},I={class:"upNow"},T=["src"],E=C(()=>l("div",{class:"block",style:{"animation-delay":"0s"}},null,-1)),L={key:0,class:"playlistOverflow"},M={class:"playlist",ref:"playlistScroll"},V={class:"settings"};function q(s,o,n,a,e,i){const d=u("spotify-playlist-header"),g=u("light-playlist-entry");return r(),c("div",D,[l("div",I,[l("img",{src:e.cover,class:m({playing:e.playing,animate:e.animate})},null,10,T),l("div",{class:m(["blocks",{playing:e.playing,animate:e.animate}])},[E,l("div",{class:"block",style:p({"animation-delay":".25s"})},null,4),l("div",{class:"block",style:p({"animation-delay":".5s"})},null,4)],2)]),e.noPlaylist?x("",!0):(r(),c("div",L,[l("div",M,[h(d),(r(!0),c(v,null,b(e.playlist.songs,t=>(r(),S(g,{key:t.source,onDownload:s.download,onRequestUpdate:s.updatePlaylist,index:e.playlist.songs.findIndex(_=>_.source==t.source),source:t.source,playing:t.title==e.currentSongName,id:t.id,title:t.title,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["onDownload","onRequestUpdate","index","source","playing","id","title","album","artist","cover","favourite","duration"]))),128))],512)])),l("div",V,[l("span",{onClick:o[0]||(o[0]=(...t)=>i.toggleMaximise&&i.toggleMaximise(...t)),class:"iconButton material-symbols-rounded"},y(e.maximised?"fullscreen_exit":"fullscreen"),1),l("span",{onClick:o[1]||(o[1]=()=>e.noPlaylist=!e.noPlaylist),class:"iconButton material-symbols-rounded",style:p({transform:`rotate(${e.noPlaylist?0:180}deg)`})},"menu_open",4),l("span",{onClick:o[2]||(o[2]=()=>e.animate=!e.animate),class:"iconButton material-symbols-rounded"},y(e.animate?"motion_photos_off":"animation"),1)])])}const H=f(N,[["render",q],["__scopeId","data-v-41ae3b71"]]);export{H as default};
