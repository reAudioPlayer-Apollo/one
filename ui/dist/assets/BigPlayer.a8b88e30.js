import{L as f}from"./LightPlaylistEntry.c9cc08c9.js";import{S as h}from"./SpotifyPlaylistHeader.a965f8fa.js";import{_ as v,o as n,c as a,a as i,j as m,n as r,g as x,F as b,i as P,f as k,d as S,t as y,p as w,h as B,e as u}from"./index.e069deca.js";import"./EditSong.25607b7f.js";import"./FindSources.3431fd91.js";const N={components:{LightPlaylistEntry:f,SpotifyPlaylistHeader:h},name:"BigPlayer",methods:{toggleMaximise(){this.maximised=!this.maximised,this.$emit("maximise",this.maximised)},fetchPlaylist(){fetch("/api/me/player/current-playlist").then(s=>s.json()).then(s=>this.playlist=s)},updateData(s){var o,l;if(s.path=="player.song"){this.cover=((o=s==null?void 0:s.data)==null?void 0:o.cover)||"/assets/img/music_placeholder.png",this.currentSongName=((l=s==null?void 0:s.data)==null?void 0:l.title)||"";return}if(s.path=="player.playState"){this.playing=(s==null?void 0:s.data)||!1;return}}},data(){const s=()=>{console.log("attempting reconnect");let o=new WebSocket("ws://localhost:1234/ws");o.onclose=()=>{console.log("ws closed"),setTimeout(s,1e3)},o.onopen=()=>{console.log("ws connected")},o.onmessage=l=>{const c=JSON.parse(l.data);this.updateData(c)}};return s(),this.fetchPlaylist(),{cover:"/assets/img/music_placeholder.png",playlist:[],currentSongName:"",maximised:!1,noPlaylist:!1,playing:!1,animate:!1}}},C=s=>(w("data-v-759b99fd"),s=s(),B(),s),D={class:"bigPlayer"},I={class:"upNow"},L=["src"],M=C(()=>i("div",{class:"block",style:{"animation-delay":"0s"}},null,-1)),V={key:0,class:"playlistOverflow"},q={class:"playlist"},z={class:"settings"};function E(s,o,l,c,e,p){const d=u("spotify-playlist-header"),g=u("light-playlist-entry");return n(),a("div",D,[i("div",I,[i("img",{src:e.cover,class:m({playing:e.playing,animate:e.animate})},null,10,L),i("div",{class:m(["blocks",{playing:e.playing,animate:e.animate}])},[M,i("div",{class:"block",style:r({"animation-delay":".25s"})},null,4),i("div",{class:"block",style:r({"animation-delay":".5s"})},null,4)],2)]),e.noPlaylist?S("",!0):(n(),a("div",V,[i("div",q,[x(d),(n(!0),a(b,null,P(e.playlist.songs,t=>(n(),k(g,{key:t.source,onDownload:s.download,onRequestUpdate:s.updatePlaylist,index:e.playlist.songs.findIndex(_=>_.source==t.source),source:t.source,playing:t.title==e.currentSongName,id:t.id,title:t.title,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["onDownload","onRequestUpdate","index","source","playing","id","title","album","artist","cover","favourite","duration"]))),128))])])),i("div",z,[i("span",{onClick:o[0]||(o[0]=(...t)=>p.toggleMaximise&&p.toggleMaximise(...t)),class:"iconButton material-symbols-rounded"},y(e.maximised?"fullscreen_exit":"fullscreen"),1),i("span",{onClick:o[1]||(o[1]=()=>e.noPlaylist=!e.noPlaylist),class:"iconButton material-symbols-rounded",style:r({transform:`rotate(${e.noPlaylist?0:180}deg)`})},"menu_open",4),i("span",{onClick:o[2]||(o[2]=()=>e.animate=!e.animate),class:"iconButton material-symbols-rounded"},y(e.animate?"motion_photos_off":"animation"),1)])])}var J=v(N,[["render",E],["__scopeId","data-v-759b99fd"]]);export{J as default};
