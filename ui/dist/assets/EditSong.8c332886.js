import{_ as C,b as m,d as A,w as u,o as v,c as f,r as T,e as l,f as d,g as h,t as g,i as x,j as V,F as N,h as E,a as o,l as p,p as M,k as F}from"./index.ea90892d.js";import{F as B}from"./FindSources.08493556.js";const I={name:"SongCtx",props:{liked:Boolean,isAutoPlaylist:Boolean},data(){return fetch("/api/playlists").then(e=>e.json()).then(e=>{this.playlists.length=0,this.playlists.push(...e)}),{playlists:[]}},methods:{hide(){this.$refs.contextmenu.hide()},show(e){const t=this.$refs.box.getBoundingClientRect(),r={top:t.height+t.top+window.scrollY,left:t.width+t.left+window.scrollX};this.$refs.contextmenu.show(r),e==null||e.stopPropagation()},like(){this.$emit("like")},remove(){this.$emit("remove")},addto(e){if(e==="new"){fetch("/api/playlist/create").then(t=>t.text()).then(t=>{this.$emit("addto",Number(t.replace("/playlist/","")))});return}this.$emit("addto",e)},download(){this.$emit("download")},update(){this.$emit("update")}}},U={ref:"box"},D=h("Remove from this playlist"),P=h("Add to new playlist"),O=h("Update Metadata"),R=h("Download");function J(e,t,r,w,n,i){const c=m("v-contextmenu-item"),_=m("v-contextmenu-divider"),s=m("v-contextmenu-submenu"),k=m("v-contextmenu"),b=A("contextmenu");return u((v(),f("div",U,[T(e.$slots,"default"),l(k,{ref:"contextmenu"},{default:d(()=>[l(c,{onClick:i.like},{default:d(()=>[h(g((r.liked?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1},8,["onClick"]),r.isAutoPlaylist?V("",!0):(v(),x(c,{key:0,onClick:i.remove},{default:d(()=>[D]),_:1},8,["onClick"])),l(s,{title:"Add to playlist"},{default:d(()=>[l(c,{onClick:t[0]||(t[0]=()=>i.addto("new"))},{default:d(()=>[P]),_:1}),l(_),(v(!0),f(N,null,E(n.playlists,(y,S)=>(v(),x(c,{key:S,onClick:()=>i.addto(S)},{default:d(()=>[h(g(y),1)]),_:2},1032,["onClick"]))),128))]),_:1}),l(_),l(c,{onClick:i.update},{default:d(()=>[O]),_:1},8,["onClick"]),l(_),l(c,{onClick:i.download},{default:d(()=>[R]),_:1},8,["onClick"])]),_:1},512)])),[[b,void 0,"contextmenu"]])}var rt=C(I,[["render",J]]);const L={name:"EditSong",components:{FindSources:B},props:{cover:String,album:String,artist:String,source:String,title:String,id:Number},data(){return{showModal:!1,dCover:this.cover,dAlbum:this.album,dArtist:this.artist,dTitle:this.title,dSource:this.source}},methods:{opencontextmenu(e){this.$refs.findSourcesEdit.show(e)},hideFindSourcesCtx(){this.$refs.findSourcesEdit.hide()},add(){this.showModal=!1,console.log("fetch"),fetch("/api/updateSong",{method:"POST",body:JSON.stringify({id:this.id,source:this.dSource,title:this.dTitle,artist:this.dArtist,album:this.dAlbum,cover:this.dCover})}).then(e=>{console.log(e),this.$emit("close")})},loadMetadata(){fetch("/api/metadata",{method:"POST",body:JSON.stringify({url:this.$refs.source.value})}).then(e=>e.json()).then(e=>{console.log(e),this.dTitle=e.title,this.dAlbum=e.album,this.dArtist=e.artists.join(", "),this.dCover=e.cover,this.dSource=e.src})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")}},watch:{id(){this.dCover=this.cover,this.dAlbum=this.album,this.dArtist=this.artist,this.dTitle=this.title,this.dSource=this.source}}},a=e=>(M("data-v-4d2c93c4"),e=e(),F(),e),X={class:"wrapper"},Y={class:"header"},q=a(()=>o("h3",null,"Edit song",-1)),z=a(()=>o("span",{class:"material-icons-round"}," close ",-1)),G=[z],H=a(()=>o("h4",null,"Source",-1)),K={class:"content"},Q=a(()=>o("h4",null,"Title",-1)),W={class:"content"},Z=a(()=>o("h4",null,"Album",-1)),j={class:"content"},$=a(()=>o("h4",null,"Artist",-1)),tt={class:"content"},et=a(()=>o("h4",null,"Cover",-1)),ot={class:"content"},st=["src"],nt={class:"confirm"};function it(e,t,r,w,n,i){const c=m("FindSources"),_=m("vue-final-modal");return v(),f("div",null,[l(_,{onClick:i.hideFindSourcesCtx,modelValue:n.showModal,"onUpdate:modelValue":t[9]||(t[9]=s=>n.showModal=s),classes:"modal-container","content-class":"modal-content"},{default:d(()=>[o("div",X,[o("div",Y,[q,o("button",{class:"modal-close",onClick:t[0]||(t[0]=s=>n.showModal=!1)},G)]),H,l(c,{ref:"findSourcesEdit",title:r.title,artist:r.artist},{default:d(()=>[o("div",K,[u(o("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.dSource=s),type:"text",ref:"source"},null,512),[[p,n.dSource]]),o("span",{class:"material-icons-round more",ref:"sourceMore",onClick:t[2]||(t[2]=(...s)=>i.opencontextmenu&&i.opencontextmenu(...s))},"more_vert",512)])]),_:1},8,["title","artist"]),Q,o("div",W,[u(o("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.dTitle=s),type:"text"},null,512),[[p,n.dTitle]])]),Z,o("div",j,[u(o("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.dAlbum=s),type:"text",ref:"album"},null,512),[[p,n.dAlbum]])]),$,o("div",tt,[u(o("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>n.dArtist=s),type:"text"},null,512),[[p,n.dArtist]])]),et,o("div",ot,[u(o("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t[6]||(t[6]=s=>n.dCover=s),ref:"cover"},null,512),[[p,n.dCover]]),o("img",{onClick:t[7]||(t[7]=(...s)=>i.openInNewTab&&i.openInNewTab(...s)),class:"addSong cover",src:r.cover?r.cover:"/assets/img/music_placeholder.png"},null,8,st)]),o("div",nt,[o("button",{onClick:t[8]||(t[8]=(...s)=>i.add&&i.add(...s)),class:"negative"},"Save")])])]),_:1},8,["onClick","modelValue"])])}var ct=C(L,[["render",it],["__scopeId","data-v-4d2c93c4"]]);export{ct as E,rt as S};
