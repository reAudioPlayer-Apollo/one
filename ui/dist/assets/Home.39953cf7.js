import{_ as g,o,c as u,a as c,t as x,r as b,b as a,d as P,w as I,e as h,f as d,g as $,H as N,F as v,h as w,i as p,j as k}from"./index.55672d70.js";import{N as D}from"./NewsItemBig.23da7e12.js";import{I as B}from"./ReleaseItem.3e5b539f.js";import{S as H}from"./Shelf.c13401f0.js";import"./AddAlbumToPlaylist.5e10a062.js";import"./MiniPlayer.a11e5a2d.js";import"./FindSources.798542de.js";const j={name:"FullShelfSmallerGrid",props:{heading:String}},G={class:"shelf"},T={class:"header"},F={class:"items"};function E(e,s,i,l,r,n){return o(),u("div",G,[c("div",T,[c("h2",null,x(i.heading),1)]),c("div",F,[b(e.$slots,"default",{},void 0,!0)])])}var O=g(j,[["render",E],["__scopeId","data-v-13232997"]]);const V={name:"PlaylistCtx",props:{name:String,id:String,href:String},methods:{hide(){this.$refs.contextmenu.hide()},show(e){const s=this.$refs.box.getBoundingClientRect(),i={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};this.$refs.contextmenu.show(i),e==null||e.stopPropagation()},openTab(){window.open(`/#${this.href}`)},play(){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:this.id,type:"playlist"})})},deletePlaylist(){fetch(`/api/playlists/${Number(this.id)}`,{method:"DELETE"})}}},W={ref:"box"},L=$("Play"),R=$("Open in new tab"),J=$("Delete playlist");function X(e,s,i,l,r,n){const _=a("v-contextmenu-item"),m=a("v-contextmenu-divider"),y=a("v-contextmenu"),f=P("contextmenu");return I((o(),u("div",W,[b(e.$slots,"default"),h(y,{ref:"contextmenu"},{default:d(()=>[h(_,{onClick:n.play},{default:d(()=>[L]),_:1},8,["onClick"]),h(_,{onClick:n.openTab},{default:d(()=>[R]),_:1},8,["onClick"]),h(m),h(_,{onClick:n.deletePlaylist},{default:d(()=>[J]),_:1},8,["onClick"])]),_:1},512)])),[[f,void 0,"contextmenu"]])}var Y=g(V,[["render",X]]);const q={name:"PlaylistItemWide",methods:{redirect(){this.$router.push(this.href)}},props:{title:String,href:String,cover:String,id:Number},components:{PlaylistCtx:Y}},z={class:"itemBig"},A=["src"],K={class:"wrapper"};function M(e,s,i,l,r,n){const _=a("PlaylistCtx");return o(),u("div",z,[h(_,{href:i.href,id:i.id,name:i.title},{default:d(()=>[c("div",{class:"item",onClick:s[0]||(s[0]=(...m)=>n.redirect&&n.redirect(...m))},[c("img",{src:i.cover},null,8,A),c("div",K,[c("h4",null,x(i.title),1)])])]),_:1},8,["href","id","name"])])}var Q=g(q,[["render",M],["__scopeId","data-v-6a5489c5"]]);const U=new N("reapOne.playlist",22),Z={components:{Shelf:H,ReleaseItem:B,PlaylistItemWide:Q,FullShelfSmallerGrid:O,NewsItemBig:D},name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],playlists:[],news:[]}},mounted(){fetch("/api/config").then(e=>{e.status==400&&this.$router.push("/welcome")}),fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases.length=0,this.releases.push(...e)}),window.localStorage.getItem("sidebar.showNewsTab")=="true"&&fetch("/api/news/articles").then(e=>e.json()).then(e=>{this.news.length=0,this.news.push(...e)}),fetch("/api/playlists").then(e=>e.json()).then(async e=>{var s,i;for(let l=0;l<e.length;l++){const n=await(await fetch(`/api/playlists/${l}`)).json();this.playlists.push({name:n.name,description:n.description,cover:((i=(s=n.songs)==null?void 0:s[0])==null?void 0:i.cover)||"/assets/img/music_placeholder.png",href:`/playlist/${U.encode(l)}`})}})}},ee={class:"home"};function te(e,s,i,l,r,n){const _=a("playlist-item-wide"),m=a("full-shelf-smaller-grid"),y=a("release-item"),f=a("shelf"),C=a("news-item-big");return o(),u("div",ee,[c("h1",null,x(r.greeting),1),h(m,null,{default:d(()=>[(o(!0),u(v,null,w(r.playlists,(t,S)=>(o(),p(_,{key:S,href:t.href,cover:t.cover,title:t.name,spotify:!1,id:S},null,8,["href","cover","title","id"]))),128))]),_:1}),r.releases.length?(o(),p(f,{key:0,heading:"New releases for you",href:"/collection/releases"},{default:d(()=>[(o(!0),u(v,null,w(r.releases,t=>(o(),p(y,{key:t.url,releaseDate:t.releaseDate,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["releaseDate","cover","href","artist","title"]))),128))]),_:1})):k("",!0),r.news.length?(o(),p(f,{key:1,heading:"Something to read while you're listening",href:"/news"},{default:d(()=>[(o(!0),u(v,null,w(r.news,t=>(o(),p(C,{key:t.url,title:t.title,image:t.image,summary:t.summary,href:t.link,updated:t.updated,source:t.source},null,8,["title","image","summary","href","updated","source"]))),128))]),_:1})):k("",!0)])}var ce=g(Z,[["render",te],["__scopeId","data-v-b5c7baf4"]]);export{ce as default};
