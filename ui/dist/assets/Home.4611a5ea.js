import{_ as g,o,c as u,a as c,t as x,r as k,b as l,d as P,w as N,e as h,f as d,g as S,H as I,F as v,h as w,i as p,j as b}from"./index.5df3df57.js";import{N as D}from"./NewsItemBig.b94f0665.js";import{I as B}from"./ReleaseItem.eeebb325.js";import{S as H}from"./Shelf.c0b81a83.js";import"./AddAlbumToPlaylist.1b27dc2d.js";import"./MiniPlayer.7dfaa6f5.js";import"./FindSources.c20c49b7.js";const T={name:"FullShelfSmallerGrid",props:{heading:String}},j={class:"shelf"},G={class:"header"},O={class:"items"};function F(e,s,i,a,r,n){return o(),u("div",j,[c("div",G,[c("h2",null,x(i.heading),1)]),c("div",O,[k(e.$slots,"default",{},void 0,!0)])])}var E=g(T,[["render",F],["__scopeId","data-v-7f87ce78"]]);const V={name:"PlaylistCtx",props:{name:String,id:String,href:String},methods:{hide(){this.$refs.contextmenu.hide()},show(e){const s=this.$refs.box.getBoundingClientRect(),i={top:s.height+s.top+window.scrollY,left:s.width+s.left+window.scrollX};this.$refs.contextmenu.show(i),e==null||e.stopPropagation()},openTab(){window.open(`/#${this.href}`)},play(){fetch("/api/loadPlaylist",{method:"POST",body:JSON.stringify({id:this.id,type:"playlist"})})},deletePlaylist(){fetch(`/api/playlist/${Number(this.id)}`,{method:"DELETE"})}}},W={ref:"box"},J=S("Play"),L=S("Open in new tab"),R=S("Delete playlist");function X(e,s,i,a,r,n){const _=l("v-contextmenu-item"),m=l("v-contextmenu-divider"),y=l("v-contextmenu"),f=P("contextmenu");return N((o(),u("div",W,[k(e.$slots,"default"),h(y,{ref:"contextmenu"},{default:d(()=>[h(_,{onClick:n.play},{default:d(()=>[J]),_:1},8,["onClick"]),h(_,{onClick:n.openTab},{default:d(()=>[L]),_:1},8,["onClick"]),h(m),h(_,{onClick:n.deletePlaylist},{default:d(()=>[R]),_:1},8,["onClick"])]),_:1},512)])),[[f,void 0,"contextmenu"]])}var Y=g(V,[["render",X]]);const q={name:"PlaylistItemWide",methods:{redirect(){this.$router.push(this.href)}},props:{title:String,href:String,cover:String,id:Number},components:{PlaylistCtx:Y}},z={class:"itemBig"},A=["src"],K={class:"wrapper"};function M(e,s,i,a,r,n){const _=l("PlaylistCtx");return o(),u("div",z,[h(_,{href:i.href,id:i.id,name:i.title},{default:d(()=>[c("div",{class:"item",onClick:s[0]||(s[0]=(...m)=>n.redirect&&n.redirect(...m))},[c("img",{src:i.cover},null,8,A),c("div",K,[c("h4",null,x(i.title),1)])])]),_:1},8,["href","id","name"])])}var Q=g(q,[["render",M],["__scopeId","data-v-26b1323b"]]);const U=new I("reapOne.playlist",22),Z={components:{Shelf:H,ReleaseItem:B,PlaylistItemWide:Q,FullShelfSmallerGrid:E,NewsItemBig:D},name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],playlists:[],news:[]}},mounted(){fetch("/api/config/ready").then(e=>{e.status==400&&this.$router.push("/welcome")}),fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases.length=0,this.releases.push(...e)}),window.localStorage.getItem("sidebar.showNewsTab")=="true"&&fetch("/api/news").then(e=>e.json()).then(e=>{this.news.length=0,this.news.push(...e)}),fetch("/api/playlists").then(e=>e.json()).then(async e=>{var s,i;for(let a=0;a<e.length;a++){const n=await(await fetch("/api/playlist",{method:"POST",body:JSON.stringify({id:a})})).json();this.playlists.push({name:n.name,description:n.description,cover:((i=(s=n.songs)==null?void 0:s[0])==null?void 0:i.cover)||"/assets/img/music_placeholder.png",href:`/playlist/${U.encode(a)}`})}})}},ee={class:"home"};function te(e,s,i,a,r,n){const _=l("playlist-item-wide"),m=l("full-shelf-smaller-grid"),y=l("release-item"),f=l("shelf"),C=l("news-item-big");return o(),u("div",ee,[c("h1",null,x(r.greeting),1),h(m,null,{default:d(()=>[(o(!0),u(v,null,w(r.playlists,(t,$)=>(o(),p(_,{key:$,href:t.href,cover:t.cover,title:t.name,spotify:!1,id:$},null,8,["href","cover","title","id"]))),128))]),_:1}),r.releases.length?(o(),p(f,{key:0,heading:"New releases for you",href:"/collection/releases"},{default:d(()=>[(o(!0),u(v,null,w(r.releases,t=>(o(),p(y,{key:t.url,releaseDate:t.releaseDate,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["releaseDate","cover","href","artist","title"]))),128))]),_:1})):b("",!0),r.news.length?(o(),p(f,{key:1,heading:"Something to read while you're listening",href:"/news"},{default:d(()=>[(o(!0),u(v,null,w(r.news,t=>(o(),p(C,{key:t.url,title:t.title,image:t.image,summary:t.summary,href:t.link,updated:t.updated,source:t.source},null,8,["title","image","summary","href","updated","source"]))),128))]),_:1})):b("",!0)])}var ce=g(Z,[["render",te],["__scopeId","data-v-6388e5d0"]]);export{ce as default};
