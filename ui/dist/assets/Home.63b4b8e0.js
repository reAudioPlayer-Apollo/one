import{_ as y,o as i,c as r,a as o,b as _,t as m,d as h,r as I,H as b,e as w,f as u,n as C,w as d,g as c,M as g,p as H,h as O,F as f,i as v}from"./index.e069deca.js";import{A as M}from"./AddAlbumToPlaylist.fd97a4b6.js";import{A as j}from"./AddSongToPlaylist.056ee651.js";import{S}from"./SpotifyPlaylistHeader.a965f8fa.js";import{L as $}from"./LightPlaylistEntry.c9cc08c9.js";import"./MiniPlayer.6caea4b2.js";import"./FindSources.3431fd91.js";import"./EditSong.25607b7f.js";const T={name:"FlexShelf",props:{heading:String,icon:String}},A={class:"shelf"},F={class:"header"},N={key:0},R={key:0,class:"icon material-symbols-round"},B={class:"items"};function D(e,s,l,n,t,a){return i(),r("div",A,[o("div",F,[l.heading||l.icon?(i(),r("h2",N,[_(m(l.heading),1),l.icon?(i(),r("span",R,m(l.icon),1)):h("",!0)])):h("",!0)]),o("div",B,[I(e.$slots,"default",{},void 0,!0)])])}var p=y(T,[["render",D],["__scopeId","data-v-7480fd7a"]]);const E={name:"FlexShelf",props:{name:String,cover:String,href:String},methods:{redirect(){this.$router.push(this.href)}}},L=["src"];function V(e,s,l,n,t,a){return i(),r("div",{onClick:s[0]||(s[0]=(...P)=>a.redirect&&a.redirect(...P)),class:"home-playlist"},[o("img",{src:l.cover},null,8,L),o("h2",null,m(l.name),1)])}var G=y(E,[["render",V],["__scopeId","data-v-6654a080"]]);const q=e=>(H("data-v-4d1f5ab8"),e=e(),O(),e),J={class:"home-track-compact-wrapper"},x=q(()=>o("div",{class:"play"},[o("span",{class:"material-symbols-rounded"},"play_arrow")],-1)),z=[x],K={class:"info"},Q={class:"title"},U=["href"],W={class:"artist"},X=new b("reapOne.track",22),Y={name:"FlexShelf",props:{title:String,artist:String,cover:String,id:Number,href:String},methods:{play(e){e.stopPropagation(),this.$emit("play")},openModal(){var e;console.log(this.href),this.href||this.$router.push(this.trackHref),(e=this.href)!=null&&e.includes("spotify")?this.$refs.addRelease.showModal=!0:this.$refs.addSong.showModal=!0}},computed:{trackId(){return X.encode(this.id)},trackHref(){return`/track/${this.trackId}`}}},Z=Object.assign(Y,{setup(e){return(s,l)=>{const n=w("router-link");return i(),r("div",J,[e.href?(i(),u(M,{key:0,id:e.href.replace("https://open.spotify.com/album/",""),cover:e.cover,title:e.title,artist:e.artist,href:e.href,ref:"addRelease"},null,8,["id","cover","title","artist","href"])):h("",!0),e.href?(i(),u(j,{key:1,href:e.href,cover:e.cover,title:e.title,artist:e.artist,preview:s.preview,ref:"addSong"},null,8,["href","cover","title","artist","preview"])):h("",!0),o("div",{class:"home-track-compact",onClick:l[1]||(l[1]=(...t)=>s.openModal&&s.openModal(...t))},[o("div",{onClick:l[0]||(l[0]=(...t)=>s.play&&s.play(...t)),class:"cover",style:C({backgroundImage:`url(${e.cover})`})},z,4),o("div",K,[o("span",Q,[e.href?(i(),r("a",{key:1,href:e.href,class:"linkOnHover"},[c(g,{text:e.title},null,8,["text"])],8,U)):(i(),u(n,{key:0,class:"linkOnHover",to:s.trackHref},{default:d(()=>[c(g,{text:e.title},null,8,["text"])]),_:1},8,["to"]))]),c(n,{class:"linkOnHover",to:`/search/artist:${e.artist}`},{default:d(()=>[o("span",W,m(e.artist),1)]),_:1},8,["to"])])])])}}});var k=y(Z,[["__scopeId","data-v-4d1f5ab8"]]);const ee=e=>(H("data-v-8751849e"),e=e(),O(),e),te={class:"home"},se={class:"main"},ie={key:0,class:"playlists"},ae=_("Playlists"),re={key:1,class:"liked"},oe=_("Liked Songs"),le={key:2,class:"breaking"},ne=_("Breaking Songs"),ce={class:"side"},de={key:0,class:"releases"},he=_("Out now"),ue={key:1,class:"disovery"},fe=_("Discover"),ve={key:2,class:"recommendations"},_e=ee(()=>o("h2",null,"Recommendations",-1)),pe=new b("reapOne.playlist",22),me={name:"Home",data(){const e=new Date;return{greeting:e.getHours()<12?"Good morning":e.getHours()<18?"Good afternoon":"Good evening",releases:[],playlists:[],picks:[],songs:[],liked:[],breaking:[],recommendations:[],releases:[]}},mounted(){fetch("/api/config").then(e=>{e.status==400&&this.$router.push("/welcome")}),fetch("/api/releases").then(e=>e.json()).then(e=>{this.releases=e.slice(0,3)}),fetch("/api/playlists").then(e=>e.json()).then(async e=>{var s,l;for(let n=0;n<e.length;n++){const a=await(await fetch(`/api/playlists/${n}`)).json();this.playlists.push({name:a.name,description:a.description,cover:a.cover||((l=(s=a.songs)==null?void 0:s[0])==null?void 0:l.cover)||"/assets/img/music_placeholder.png",href:`/playlist/${pe.encode(n)}`,songs:a.songs})}this.pick()}),fetch("/api/me/liked").then(e=>e.json()).then(e=>{this.liked=e.songs.slice(0,3)}),fetch("/api/me/new").then(e=>e.json()).then(e=>{this.breaking=e.songs.slice(0,3)})},methods:{playDiscover(e){fetch("/api/player/load",{method:"POST",body:JSON.stringify({id:e.id,type:"track"})})},playRecommendation(e){const s=new CustomEvent("player.play",{detail:{artist:e.artist,title:e.title,source:e.src||e.url}});window.dispatchEvent(s)},pick(){this.songs=this.playlists.map(e=>e.songs).flat();for(let e=0;e<3;e++)this.picks.push(this.songs[Math.floor(Math.random()*this.songs.length)]);fetch("/api/spotify/recommendations",{method:"POST",body:JSON.stringify({query:`${this.picks[0].artist} ${this.picks[0].title}`})}).then(e=>e.json()).then(e=>{this.recommendations=e.slice(0,3)})}}},ye=Object.assign(me,{setup(e){return(s,l)=>{const n=w("router-link");return i(),r("div",te,[o("div",se,[s.playlists.length?(i(),r("div",ie,[o("h2",null,[c(n,{to:"/collection/playlists",class:"linkOnHover"},{default:d(()=>[ae]),_:1})]),c(p,null,{default:d(()=>[(i(!0),r(f,null,v(s.playlists,(t,a)=>(i(),u(G,{key:a,name:t.name,cover:t.cover,href:t==null?void 0:t.href},null,8,["name","cover","href"]))),128))]),_:1})])):h("",!0),s.liked.length?(i(),r("div",re,[o("h2",null,[c(n,{to:"/collection/tracks",class:"linkOnHover"},{default:d(()=>[oe]),_:1})]),c(S),(i(!0),r(f,null,v(s.liked,(t,a)=>(i(),u($,{key:a,index:a,loadAt:{type:"collection"},source:t.source,id:t.id,title:t.title,playing:t.playing,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])):h("",!0),s.breaking.length?(i(),r("div",le,[o("h2",null,[c(n,{to:"/collection/tracks/breaking",class:"linkOnHover"},{default:d(()=>[ne]),_:1})]),c(S),(i(!0),r(f,null,v(s.breaking,(t,a)=>(i(),u($,{key:a,index:a,loadAt:{type:"collection/breaking"},source:t.source,id:t.id,title:t.title,playing:t.playing,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])):h("",!0)]),o("div",ce,[s.releases.length?(i(),r("div",de,[o("h2",null,[c(n,{to:"/collection/releases",class:"linkOnHover"},{default:d(()=>[he]),_:1})]),c(p,null,{default:d(()=>[(i(!0),r(f,null,v(s.releases,(t,a)=>(i(),u(k,{onPlay:()=>s.playRecommendation(t),key:a,artist:t.artist,title:t.title,cover:t.cover,href:t.url},null,8,["onPlay","artist","title","cover","href"]))),128))]),_:1})])):h("",!0),s.picks.length?(i(),r("div",ue,[o("h2",null,[c(n,{to:"/discover",class:"linkOnHover"},{default:d(()=>[fe]),_:1})]),c(p,null,{default:d(()=>[(i(!0),r(f,null,v(s.picks,(t,a)=>(i(),u(k,{onPlay:()=>s.playDiscover(t),key:a,artist:t.artist,title:t.title,cover:t.cover,id:t.id},null,8,["onPlay","artist","title","cover","id"]))),128))]),_:1})])):h("",!0),s.recommendations.length?(i(),r("div",ve,[_e,c(p,null,{default:d(()=>[(i(!0),r(f,null,v(s.recommendations,(t,a)=>(i(),u(k,{onPlay:()=>s.playRecommendation(t),key:a,artist:t.artist,title:t.title,cover:t.cover,href:t.src},null,8,["onPlay","artist","title","cover","href"]))),128))]),_:1})])):h("",!0)])])}}});var Pe=y(ye,[["__scopeId","data-v-8751849e"]]);export{Pe as default};
