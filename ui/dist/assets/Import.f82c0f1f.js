import{b as y}from"./index.83ecff5a.js";import{_,H as k,o as i,c as d,a as t,b as u,F as m,t as h,d as v,i as b,f as w,e as C,p as P,h as g}from"./index.7a0dd187.js";import{C as F}from"./CloudPlaylist.612904b2.js";window.Buffer=y.Buffer;new k("reapApollo");const D={name:"import",methods:{login(){window.location=`https://eu-apollo.herokuapp.com/user/accessToken?redirect=${encodeURIComponent(window.location.origin+"/#/import/<token>")}`}},mounted(){this.$refs.upFile.addEventListener("change",()=>{var l,r,o,c;const e=(l=this.$refs.upFile.files)==null?void 0:l[0];if(!!e){this.uploadedCoverName=(c=(o=(r=this.$refs.upFile)==null?void 0:r.files)==null?void 0:o[0])==null?void 0:c.name;var s=new FileReader;s.onloadend=()=>{this.cloudPlaylists=JSON.parse(s.result)},s.readAsText(e)}})},data(){if(this.$route.params.data){const e=this.$route.params.data;fetch(`https://eu-apollo.herokuapp.com/user/${e}`).then(async s=>{this.userData=await s.json(),this.cloudPlaylists=this.userData.data.playlists})}return fetch("/api/playlists").then(async e=>{const s=await e.json();for(let l=0;l<s.length;l++){const r=await fetch(`/api/playlists/${l}`);this.localPlaylists.push(await r.json())}}),{localPlaylists:[],cloudPlaylists:[],userData:{}}},components:{CloudPlaylist:F}},n=e=>(P("data-v-17d7b482"),e=e(),g(),e),I={class:"import"},T={class:"action"},$=n(()=>t("h1",null,"Restore From File",-1)),E={type:"file",ref:"upFile",style:{display:"none"},accept:"application/json"},x=n(()=>t("span",{class:"material-symbols-rounded"},"file_upload",-1)),B=n(()=>t("span",{class:"material-symbols-rounded"},"done",-1)),R={class:"action"},S=n(()=>t("h1",null,"Restore From Cloud",-1)),N={key:0},j=n(()=>t("span",{class:"material-symbols-rounded"},"cloud_download",-1)),W=n(()=>t("span",{class:"material-symbols-rounded"},"login",-1)),A={class:"data"};function H(e,s,l,r,o,c){const f=C("CloudPlaylist");return i(),d("div",I,[t("div",T,[$,t("input",E,null,512),t("button",{onClick:s[0]||(s[0]=()=>e.$refs.upFile.click()),class:"iconWithText"},[x,u(" Upload")]),t("button",{onClick:s[1]||(s[1]=p=>e.$refs.playlistsElements.forEach(a=>a.import())),class:"iconWithText"},[B,u(" Apply")])]),t("div",R,[S,o.userData.user?(i(),d(m,{key:0},[o.userData.user?(i(),d("h2",N,"Hello "+h(o.userData.user.userinfo.name)+" ("+h(o.userData.user.userinfo.email)+")",1)):v("",!0),t("button",{onClick:s[2]||(s[2]=p=>e.$refs.playlistsElements.forEach(a=>a.import())),class:"iconWithText"},[j,u(" Synchronise")])],64)):(i(),d("button",{key:1,onClick:s[3]||(s[3]=(...p)=>c.login&&c.login(...p)),class:"iconWithText"},[W,u(" Log In")]))]),t("div",A,[(i(!0),d(m,null,b(o.cloudPlaylists,(p,a)=>(i(),w(f,{onRemove:()=>o.cloudPlaylists.splice(a,1),ref_for:!0,ref:"playlistsElements",key:a,playlist:p,localPlaylists:o.localPlaylists},null,8,["onRemove","playlist","localPlaylists"]))),128))])])}const J=_(D,[["render",H],["__scopeId","data-v-17d7b482"]]);export{J as default};
