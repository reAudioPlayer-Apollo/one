import{S as m,E as v}from"./EditSong.32997447.js";import{H as p,_,M as k,e as n,o as P,f as S,w as u,g as d,a as l,j as x,k as r,t as y}from"./index.7a0dd187.js";const A=new p("reapOne.track",22),b={name:"LightPlaylistEntry",components:{SongCtx:m,EditSong:v,Marquee:k},props:{index:Number,id:Number,artist:{type:String,default:"N/A"},title:{type:String,default:"N/A"},cover:{type:String,default:"/assets/img/music_placeholder.png"},source:String,album:{type:String,default:"N/A"},duration:{type:String,default:"N/A"},favourite:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},loadAt:{type:Object}},data(){return{highlighted:!1,favourited:this.favourite,isAutoPlaylist:this.$route.path=="/collection/tracks",hovering:!1}},computed:{trackId(){return A.encode(this.id)}},methods:{download(){window.open(`/api/tracks/${this.id}/download`)},addToPlaylist(a){fetch(`/api/playlists/${a}/tracks`,{method:"POST",body:JSON.stringify({source:this.source})}).then(i=>{i.status==200&&this.$emit("requestUpdate")})},update(){this.$refs.editSongPopup.showModal=!0},remove(){},onselect(){this.highlighted=!this.highlighted},playAt(){console.log(this.$route.path);const a=this.loadAt||{};a.index=this.index,fetch("/api/player/at",{method:"POST",body:JSON.stringify(a)})},setFavourite(){fetch(`/api/tracks/${this.id}`,{method:"PUT",body:JSON.stringify({favourite:this.favourited,album:this.album,artist:this.artist,title:this.title,duration:this.duration,cover:this.cover,source:this.source})})},displayPlay(){const a=this.$refs.idOrPlay;a.innerHTML="play_arrow",a.classList.add("material-icons-round")},displayId(){const a=this.$refs.idOrPlay;a.innerHTML=this.index+1,a.classList.remove("material-icons-round")}},watch:{added(){console.log("change"),this.$refs.add.innerHTML=this.added?"done":"add"},favourited(){this.setFavourite()},favourite(){console.log("mounted",this.title,this.favourite,this.favourited),this.favourited=this.favourite,this.highlighted=!1}}},w=["id"],M={class:"track"},O=["src"],N={class:"trackwrapper"},C={class:"duration"};function L(a,i,t,E,o,e){const f=n("EditSong"),c=n("Marquee"),h=n("router-link"),g=n("SongCtx");return P(),S(g,{onDownload:e.download,onAddto:e.addToPlaylist,onRemove:e.remove,onUpdate:e.update,onLike:i[5]||(i[5]=s=>o.favourited=!o.favourited),isAutoPlaylist:o.isAutoPlaylist,liked:o.favourited,ref:"ctxMenu"},{default:u(()=>[d(f,{onClose:a.updatePlaylist,ref:"editSongPopup",cover:t.cover,id:t.id,title:t.title,album:t.album,artist:t.artist,source:t.source},null,8,["onClose","cover","id","title","album","artist","source"]),l("div",{id:"bplayer-entry-"+t.id,onDblclick:i[1]||(i[1]=()=>{e.playAt(),e.onselect()}),onClick:i[2]||(i[2]=(...s)=>e.onselect&&e.onselect(...s)),onMouseover:i[3]||(i[3]=(...s)=>e.displayPlay&&e.displayPlay(...s)),onMouseleave:i[4]||(i[4]=(...s)=>e.displayId&&e.displayId(...s)),class:r(["lightPlaylistEntry",{selected:o.highlighted}])},[l("span",{onClick:i[0]||(i[0]=x((...s)=>e.playAt&&e.playAt(...s),["stop"])),ref:"idOrPlay",class:r([{playing:t.playing},"id"])},y(t.index+1),3),l("div",M,[l("img",{src:t.cover||"/assets/img/music_placeholder.png"},null,8,O),l("div",N,[l("span",{class:r(["title",{playing:t.playing}])},[d(h,{class:"linkOnHover",to:`/track/${e.trackId}`},{default:u(()=>[d(c,{text:t.title},null,8,["text"])]),_:1},8,["to"])],2),l("span",{class:r(["artist",{playing:t.playing}])},[d(h,{class:"linkOnHover",to:`/search/artist:${t.artist}`},{default:u(()=>[d(c,{text:t.artist},null,8,["text"])]),_:1},8,["to"])],2)])]),l("span",C,y(t.duration),1)],42,w)]),_:1},8,["onDownload","onAddto","onRemove","onUpdate","isAutoPlaylist","liked"])}const I=_(b,[["render",L],["__scopeId","data-v-da2d9ae8"]]);export{I as L};
