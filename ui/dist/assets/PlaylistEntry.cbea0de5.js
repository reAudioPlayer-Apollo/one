import{S as g,E as v}from"./EditSong.d8f4fadf.js";import{_ as p,M as x,g as d,o as _,e as S,w as h,b as r,a,n,t as c}from"./index.3ba6d211.js";const P={name:"PlaylistEntry",components:{SongCtx:g,EditSong:v,Marquee:x},props:{index:Number,id:Number,source:String,artist:{type:String,default:"N/A"},cover:{type:String,default:"/assets/img/music_placeholder.png"},title:{type:String,default:"N/A"},album:{type:String,default:"N/A"},duration:{type:String,default:"N/A"},favourite:{type:Boolean,default:!1},playing:{type:Boolean,default:!1}},data(){return{highlighted:!1,favourited:this.favourite,isAutoPlaylist:this.$route.path=="/collection/tracks"}},methods:{download(){this.$emit("download",this.index)},addToPlaylist(i){fetch("http://localhost:1234/api/add",{method:"POST",body:JSON.stringify({id:i,source:this.source})}).then(t=>{t.status==200&&this.$emit("requestUpdate")})},remove(){fetch("http://localhost:1234/api/remove",{method:"POST",body:JSON.stringify({playlistId:Number(this.$route.params.id),songId:this.id})}).then(i=>{i.status==200&&this.$emit("requestUpdate")})},update(){this.$refs.editSongPopup.showModal=!0},hideCtxMenu(){this.$refs.ctxMenu.hide()},showCtxMenu(i){console.log("show"),this.$refs.ctxMenu.show(i)},onselect(){this.highlighted=!this.highlighted,this.hideCtxMenu()},displayPlay(){const i=this.$refs.idOrPlay;i.innerHTML="play_arrow",i.classList.add("material-icons-round")},displayId(){const i=this.$refs.idOrPlay;i.innerHTML=this.index+1,i.classList.remove("material-icons-round")},playAt(){console.log(this.$route.path);const i={index:this.index};this.$route.path.includes("/playlist/")&&(i.playlistIndex=Number(this.$route.params.id)),this.$route.path.includes("/collection/tracks")&&(i.type="collection"),fetch("http://localhost:1234/api/at",{method:"POST",body:JSON.stringify(i)})},setFavourite(){fetch("http://localhost:1234/api/updateSong",{method:"POST",body:JSON.stringify({id:this.id,favourite:this.favourited,album:this.album,artist:this.artist,title:this.title,duration:this.duration,cover:this.cover,source:this.source})})}},watch:{favourited(){this.setFavourite()},favourite(){console.log("mounted",this.title,this.favourite,this.favourited),this.favourited=this.favourite,this.highlighted=!1}}},b={class:"track"},k=["src"],w={class:"trackwrapper"},C={class:"duration"};function M(i,t,e,A,l,s){const y=d("EditSong"),u=d("Marquee"),f=d("router-link"),m=d("SongCtx");return _(),S(m,{onDownload:s.download,onAddto:s.addToPlaylist,onRemove:s.remove,onUpdate:s.update,onLike:t[7]||(t[7]=o=>l.favourited=!l.favourited),isAutoPlaylist:l.isAutoPlaylist,liked:l.favourited,ref:"ctxMenu"},{default:h(()=>[r(y,{onClose:i.updatePlaylist,ref:"editSongPopup",cover:e.cover,id:e.id,title:e.title,album:e.album,artist:e.artist,source:e.source},null,8,["onClose","cover","id","title","album","artist","source"]),a("div",{onDblclick:t[3]||(t[3]=()=>{s.playAt(),s.onselect()}),onClick:t[4]||(t[4]=(...o)=>s.onselect&&s.onselect(...o)),onMouseover:t[5]||(t[5]=(...o)=>s.displayPlay&&s.displayPlay(...o)),onMouseleave:t[6]||(t[6]=(...o)=>s.displayId&&s.displayId(...o)),class:n(["playlistEntry",{selected:l.highlighted}])},[a("span",{onClick:t[0]||(t[0]=(...o)=>s.playAt&&s.playAt(...o)),ref:"idOrPlay",class:n([{playing:e.playing},"id"])},c(e.index+1),3),a("div",b,[a("img",{src:e.cover||"/assets/img/music_placeholder.png"},null,8,k),a("div",w,[a("span",{class:n(["title",{playing:e.playing}])},[r(f,{class:"linkOnHover",to:`/track/${e.id}`},{default:h(()=>[r(u,{text:e.title},null,8,["text"])]),_:1},8,["to"])],2),a("span",{class:n(["artist",{playing:e.playing}])},[r(f,{class:"linkOnHover",to:`/search/${e.artist}`},{default:h(()=>[r(u,{text:e.artist},null,8,["text"])]),_:1},8,["to"])],2)])]),a("span",{class:n(["album",{playing:e.playing}])},[r(u,{text:e.album},null,8,["text"])],2),a("span",{onClick:t[1]||(t[1]=o=>l.favourited=!l.favourited),class:n(["favourite material-icons-round",{showfavourite:l.favourited||l.highlighted}])},c(l.favourited?"favorite":"favorite_border"),3),a("span",C,c(e.duration),1),a("span",{onClick:t[2]||(t[2]=(...o)=>s.showCtxMenu&&s.showCtxMenu(...o)),class:n(["more material-icons-round",{hidden:!l.highlighted}])},"more_horiz",2)],34)]),_:1},8,["onDownload","onAddto","onRemove","onUpdate","isAutoPlaylist","liked"])}var E=p(P,[["render",M],["__scopeId","data-v-5f270f5e"]]);export{E as P};
