import{F as N}from"./FullShelf.9b84528f.js";import{F}from"./FindSources.998960d3.js";import{S as H}from"./SpotifyPlaylistEntry.418310b2.js";import{S as B}from"./SpotifyPlaylistHeader.c0d647e0.js";import{_ as I,b as c,d as O,o as n,c as r,e as h,f as S,a as s,w as m,v as j,F as C,h as A,t as P,l as g,i as b,p as U,k as L,g as J,j as M,H as D}from"./index.10a92c10.js";import{A as x}from"./AddAlbumToPlaylist.d9eef697.js";import{C as E}from"./CollectionHeader.e4a1202e.js";import"./MiniPlayer.74369396.js";const R={name:"AddPlaylistToPlaylist",components:{FindSources:F,SpotifyPlaylistHeader:B,SpotifyPlaylistEntry:H},props:{cover:String,description:String,title:String,href:String,id:String},data(){return{showModal:!1,playlists:[],selectedPlaylist:-1,playlist:[],editSong:!1}},methods:{share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/metadata",{method:"POST",body:JSON.stringify({url:this.$refs.source.value})}).then(t=>t.json()).then(t=>{console.log(t),this.dTitle=t.title,this.$refs.album.value=t.album,this.dArtist=t.artists.join(", "),this.dCover=t.cover,this.$refs.source.value=t.src})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},addAll(){for(let t=0;t<this.playlist.length;t++)this.add(t)},add(t){const e=this.playlist[t],l=this.playlists.findIndex(a=>a==this.selectedPlaylist);if(console.log(e,l),l<0){alert("no playlist selected");return}fetch("/api/add",{method:"POST",body:JSON.stringify({id:l,source:e.src,title:e.title,artist:e.artists.join(", "),album:e.album,cover:e.cover})}).then(a=>{a.status==200&&(e.added=!0)})}},watch:{dSource(){this.loadMetadata()},showModal(){!this.showModal||(fetch("/api/playlists").then(t=>t.json()).then(t=>{this.playlists.length=0,this.playlists.push(...t)}),fetch("/api/spotify/playlist",{method:"POST",body:JSON.stringify({playlistId:this.id})}).then(t=>t.json()).then(t=>{this.playlist.length=0,this.playlist.push(...t)}))}}},p=t=>(U("data-v-0b334dcc"),t=t(),L(),t),q={class:"wrapper"},z={class:"header"},G=p(()=>s("h3",null,"Import playlist",-1)),K=p(()=>s("span",{class:"material-icons-round"}," close ",-1)),Q=[K],W=p(()=>s("h4",null,"To Playlist",-1)),X=p(()=>s("br",null,null,-1)),Y={key:0},Z=p(()=>s("h4",null,"Source",-1)),$={class:"content"},tt=p(()=>s("h4",null,"Title",-1)),et={class:"content"},st=p(()=>s("h4",null,"Album",-1)),it={class:"content"},lt=p(()=>s("h4",null,"Artist",-1)),ot={class:"content"},nt=p(()=>s("h4",null,"Cover",-1)),dt={class:"content"},rt=["src"],at={class:"confirm"},ct={key:1},pt=["src"],ut={class:"details"},ht={class:"detailswrapper"},_t=J("Playlist"),yt=["innerHTML"],mt=p(()=>s("hr",null,null,-1)),ft=p(()=>s("hr",null,null,-1)),vt={class:"confirm"};function gt(t,e,l,a,d,o){const _=c("FindSources"),y=c("h7"),k=c("spotify-playlist-header"),w=c("spotify-playlist-entry"),u=c("vue-final-modal"),f=O("observe-visibility");return n(),r("div",null,[h(u,{onClick:t.hideFindSourcesCtx,modelValue:d.showModal,"onUpdate:modelValue":e[13]||(e[13]=i=>d.showModal=i),classes:"modal-container","content-class":"addAlbumToPlaylistPopup"},{default:S(()=>[s("div",q,[s("div",z,[G,s("button",{class:"modal-close",onClick:e[0]||(e[0]=(...i)=>o.close&&o.close(...i))},Q)]),W,m(s("select",{"onUpdate:modelValue":e[1]||(e[1]=i=>d.selectedPlaylist=i)},[(n(!0),r(C,null,A(d.playlists,i=>(n(),r("option",{key:i},P(i),1))),128))],512),[[j,d.selectedPlaylist]]),X,d.editSong?(n(),r("div",Y,[Z,h(_,{ref:"findSources",title:l.title,artist:t.artist},{default:S(()=>[s("div",$,[m(s("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=i=>t.dSource=i),ref:"source"},null,512),[[g,t.dSource]]),s("span",{class:"material-icons-round more",ref:"sourceMore",onClick:e[3]||(e[3]=(...i)=>t.opencontextmenu&&t.opencontextmenu(...i))},"more_vert",512)])]),_:1},8,["title","artist"]),tt,s("div",et,[m(s("input",{"onUpdate:modelValue":e[4]||(e[4]=i=>t.dTitle=i),type:"text"},null,512),[[g,t.dTitle]])]),st,s("div",it,[m(s("input",{"onUpdate:modelValue":e[5]||(e[5]=i=>t.dAlbum=i),type:"text",ref:"album"},null,512),[[g,t.dAlbum]])]),lt,s("div",ot,[m(s("input",{"onUpdate:modelValue":e[6]||(e[6]=i=>t.dArtist=i),type:"text"},null,512),[[g,t.dArtist]])]),nt,s("div",dt,[m(s("input",{type:"text",class:"addSong cover","onUpdate:modelValue":e[7]||(e[7]=i=>t.dCover=i),ref:"cover"},null,512),[[g,t.dCover]]),s("img",{onClick:e[8]||(e[8]=(...i)=>o.openInNewTab&&o.openInNewTab(...i)),class:"addSong cover",src:t.dCover?t.dCover:"/assets/img/music_placeholder.png"},null,8,rt)]),s("div",at,[s("button",{onClick:e[9]||(e[9]=(...i)=>o.add&&o.add(...i)),class:"negative"},"Add")])])):(n(),r("div",ct,[m((n(),r("div",{class:"padding-20 playlisteditor",onClick:e[11]||(e[11]=(...i)=>t.editPlaylist&&t.editPlaylist(...i))},[s("img",{class:"cover",src:l.cover},null,8,pt),s("div",ut,[s("div",ht,[h(y,null,{default:S(()=>[_t]),_:1}),s("span",{class:"material-icons-round share",onClick:e[10]||(e[10]=(...i)=>o.share&&o.share(...i))},"share")]),s("h1",null,P(l.title),1),s("h5",{innerHTML:l.description},null,8,yt)])])),[[f,t.headerVisibilityChanged]]),mt,h(k),ft,(n(!0),r(C,null,A(d.playlist,(i,v)=>(n(),b(w,{onAdd:o.add,key:v,added:i.added,index:v,cover:i.cover,artist:i.artists.join(", "),title:i.title,source:i.source,album:i.album,preview:i.preview},null,8,["onAdd","added","index","cover","artist","title","source","album","preview"]))),128))])),s("div",vt,[s("button",{onClick:e[12]||(e[12]=(...i)=>o.addAll&&o.addAll(...i)),class:"negative"},"Add All")])])]),_:1},8,["onClick","modelValue"])])}var St=I(R,[["render",gt],["__scopeId","data-v-0b334dcc"]]);const bt={components:{AddPlaylistToPlaylist:St},name:"PlaylistItem",methods:{redirect(){this.spotify?this.$refs.import.showModal=!0:this.$router.push(this.href)}},props:{cover:String,title:String,description:String,href:String,spotify:Boolean,id:String}},Pt={class:"wrapper"},kt=["src"],wt=["innerHTML"];function Tt(t,e,l,a,d,o){const _=c("add-playlist-to-playlist");return n(),r("div",Pt,[l.spotify?(n(),b(_,{key:0,cover:l.cover,href:l.href,title:l.title,description:l.description,id:l.id,ref:"import"},null,8,["cover","href","title","description","id"])):M("",!0),s("div",{class:"item",onClick:e[0]||(e[0]=(...y)=>o.redirect&&o.redirect(...y))},[s("img",{src:l.cover},null,8,kt),s("h4",null,P(l.title),1),s("p",{innerHTML:l.description},null,8,wt)])])}var Ct=I(bt,[["render",Tt],["__scopeId","data-v-76a7596c"]]);const At={components:{AddAlbumToPlaylist:x},name:"ReleaseItemBig",methods:{redirect(){this.$router.push(this.href)}},props:{title:String,description:String,href:String}},It={class:"itemBig"},Mt={class:"wrapper"};function Vt(t,e,l,a,d,o){const _=c("add-album-to-playlist");return n(),r("div",It,[h(_,{id:this.href.replace("https://open.spotify.com/album/",""),cover:t.cover,title:l.title,artist:t.artist,ref:"addAlbum"},null,8,["id","cover","title","artist"]),s("div",{class:"item",onClick:e[0]||(e[0]=(...y)=>o.redirect&&o.redirect(...y))},[s("div",Mt,[s("h4",null,P(l.title),1),s("p",null,P(l.description),1)])])])}var Nt=I(At,[["render",Vt],["__scopeId","data-v-a5dc3564"]]);const Ft=new D("reapOne.playlist",22),Ht={components:{CollectionHeader:E,PlaylistItem:Ct,FullShelf:N,PlaylistItemBig:Nt},name:"Playlists",data(){return fetch("/api/playlists").then(t=>t.json()).then(async t=>{for(let e=0;e<t.length;e++){const a=await(await fetch("/api/playlist",{method:"POST",body:JSON.stringify({id:e})})).json();this.playlists.push({name:a.name,description:a.description,cover:a.songs[0].cover,href:`/playlist/${Ft.encode(e)}`})}}),fetch("/api/collection/tracks").then(t=>t.json()).then(t=>{this.likedTracks=t}),fetch("/api/spotify/playlists").then(t=>t.json()).then(t=>{this.spotifyPlaylists=t}),{playlists:[],likedTracks:null,spotifyPlaylists:[]}}},Bt={class:"padding-20"},Ot={class:"playlists"};function jt(t,e,l,a,d,o){const _=c("CollectionHeader"),y=c("playlist-item-big"),k=c("playlist-item"),w=c("full-shelf");return n(),r("div",Bt,[h(_),s("div",Ot,[h(w,{heading:"Playlists"},{default:S(()=>{var u,f,i,v;return[(f=(u=d.likedTracks)==null?void 0:u.songs)!=null&&f.length?(n(),b(y,{key:0,title:"Liked Songs",description:`${(v=(i=d.likedTracks)==null?void 0:i.songs)==null?void 0:v.length} liked Songs`,href:"/collection/tracks"},null,8,["description"])):M("",!0),(n(!0),r(C,null,A(d.playlists,(T,V)=>(n(),b(k,{key:V,href:T.href,cover:T.cover,description:T.description,title:T.name,spotify:!1},null,8,["href","cover","description","title"]))),128))]}),_:1}),h(w,{heading:"Import From Spotify"},{default:S(()=>[(n(!0),r(C,null,A(d.spotifyPlaylists,(u,f)=>(n(),b(k,{key:f,cover:u.cover,description:u.description,title:u.name,id:u.id,spotify:!0,href:`https://open.spotify.com/playlist/${u.id}`},null,8,["cover","description","title","id","href"]))),128))]),_:1})])])}var zt=I(Ht,[["render",jt],["__scopeId","data-v-05968409"]]);export{zt as default};
