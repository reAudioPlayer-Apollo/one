import{A as P}from"./ArtistItem.8ec69019.js";import{I as x}from"./ReleaseItem.7bf9e1b2.js";import{M as C}from"./MiniPlayer.6f3e9d36.js";import{_ as S,g as h,i as M,o,c,b as k,w as v,a as r,j as I,v as V,F as f,d as y,t as _,p as N,h as q,l as D,f as m,k as O,e as d}from"./index.5c6e860d.js";import{S as j}from"./Shelf.d4b6770f.js";import"./FindSources.83efa7f9.js";import"./SpotifyPlaylistEntry.22532634.js";import"./SpotifyPlaylistHeader.4108bf6c.js";import"./AddAlbumToPlaylist.4185c980.js";const B={components:{MiniPlayer:C},name:"AddSongToPlaylist",props:{cover:String,artist:String,title:String,href:String,preview:String},data(){return{showModal:!1,selectedPlaylist:-1,track:{},playlists:[]}},methods:{share(){window.open(this.href)},close(){this.showModal=!1,this.$emit("close")},loadMetadata(){fetch("/api/metadata",{method:"POST",body:JSON.stringify({url:this.href})}).then(s=>s.json()).then(s=>{this.track=s})},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")},add(){const s=this.track,t=this.playlists.findIndex(i=>i==this.selectedPlaylist);if(console.log(s,t),t<0){alert("no playlist selected");return}fetch("/api/add",{method:"POST",body:JSON.stringify({id:t,source:s.src,title:s.title,artist:s.artists.join(", "),album:this.title,cover:this.cover})}).then(i=>{i.status==200&&(s.added=!0,this.close())})}},watch:{showModal(){!this.showModal||(fetch("/api/playlists").then(s=>s.json()).then(s=>{this.playlists.length=0,this.playlists.push(...s)}),this.loadMetadata())}}},w=s=>(N("data-v-9d45f116"),s=s(),q(),s),F={class:"wrapper"},J={class:"header"},U=w(()=>r("h3",null,"Add song",-1)),E=w(()=>r("span",{class:"material-icons-round"}," close ",-1)),K=[E],L=w(()=>r("h4",null,"To Playlist",-1)),R=w(()=>r("br",null,null,-1)),Y=["src"],z={class:"details"},G={class:"detailswrapper"},H=D("Song"),Q={class:"confirm"};function W(s,t,i,T,l,n){const p=h("h7"),u=h("mini-player"),g=h("vue-final-modal"),b=M("observe-visibility");return o(),c("div",null,[k(g,{onClick:s.hideFindSourcesCtx,modelValue:l.showModal,"onUpdate:modelValue":t[5]||(t[5]=a=>l.showModal=a),classes:"modal-container","content-class":"addAlbumToPlaylistPopup"},{default:v(()=>[r("div",F,[r("div",J,[U,r("button",{class:"modal-close",onClick:t[0]||(t[0]=(...a)=>n.close&&n.close(...a))},K)]),L,I(r("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.selectedPlaylist=a)},[(o(!0),c(f,null,y(l.playlists,a=>(o(),c("option",{key:a},_(a),1))),128))],512),[[V,l.selectedPlaylist]]),R,r("div",null,[I((o(),c("div",{class:"padding-20 playlisteditor",onClick:t[3]||(t[3]=(...a)=>s.editPlaylist&&s.editPlaylist(...a))},[r("img",{class:"cover",src:i.cover},null,8,Y),r("div",z,[r("div",G,[k(p,null,{default:v(()=>[H]),_:1}),r("span",{class:"material-icons-round share",onClick:t[2]||(t[2]=(...a)=>n.share&&n.share(...a))},"share")]),r("h1",null,_(i.title),1),r("h5",null,_(i.artist),1)])])),[[b,s.headerVisibilityChanged]])]),r("div",Q,[k(u,{class:"miniPlayer",src:i.preview},null,8,["src"]),r("button",{onClick:t[4]||(t[4]=(...a)=>n.add&&n.add(...a)),class:"negative"},"Add")])])]),_:1},8,["onClick","modelValue"])])}var X=S(B,[["render",W],["__scopeId","data-v-9d45f116"]]);const Z={components:{AddSongToPlaylist:X},name:"SearchItem",methods:{redirect(){this.$refs.addAlbum.showModal=!0}},props:{cover:String,title:String,artist:String,releaseDate:String,href:String,preview:String}},$={class:"wrapper"},tt=["src"],et={key:0,class:"note"};function st(s,t,i,T,l,n){const p=h("add-song-to-playlist");return o(),c("div",$,[k(p,{href:i.href,cover:i.cover,title:i.title,artist:i.artist,preview:i.preview,ref:"addAlbum"},null,8,["href","cover","title","artist","preview"]),r("div",{class:"item",onClick:t[0]||(t[0]=(...u)=>n.redirect&&n.redirect(...u))},[r("img",{src:i.cover},null,8,tt),r("h4",null,_(i.title),1),r("p",null,_(i.artist),1),i.releaseDate?(o(),c("p",et,"Released on "+_(i.releaseDate),1)):m("",!0)])])}var rt=S(Z,[["render",st],["__scopeId","data-v-1c1d30ad"]]);const it={name:"TrackItem",methods:{redirect(){console.log("redirect"),this.$router.push(this.href)}},props:{cover:String,title:String,artist:String,href:String}},ot={class:"wrapper"},lt=["src"];function at(s,t,i,T,l,n){return o(),c("div",ot,[r("div",{class:"item",onClick:t[0]||(t[0]=(...p)=>n.redirect&&n.redirect(...p))},[r("img",{src:i.cover},null,8,lt),r("h4",null,_(i.title),1),r("p",null,_(i.artist),1)])])}var nt=S(it,[["render",at],["__scopeId","data-v-51fc4e5a"]]);const ct={name:"Search",components:{Shelf:j,Item:x,SearchItem:rt,ArtistItem:P,TrackItem:nt},data(){return{query:"",spotifyTracks:[],spotifyArtists:[],tracks:[],artists:[],youtubeTracks:[]}},methods:{search(){const s=this.$route.params.query;!s||fetch("/api/search",{method:"POST",body:JSON.stringify({query:s})}).then(t=>t.json()).then(t=>{this.spotifyTracks.length=0,this.spotifyArtists.length=0,this.tracks.length=0,this.artists.length=0,this.youtubeTracks.length=0,this.spotifyTracks.push(...t.spotifyTracks||[]),this.spotifyArtists.push(...t.spotifyArtists||[]),this.tracks.push(...t.tracks||[]),this.artists.push(...t.artists||[]),this.youtubeTracks.push(...t.youtubeTracks||[])})},enterText(s){s.key==="Enter"&&this.$router.push("/search/"+this.query)}},watch:{$route(){this.search()}},mounted(){this.search()}},dt={class:"search"};function ut(s,t,i,T,l,n){const p=h("TrackItem"),u=h("Shelf"),g=h("search-item"),b=h("Item"),a=h("artist-item");return o(),c("div",dt,[I(r("input",{onKeyup:t[0]||(t[0]=(...e)=>n.enterText&&n.enterText(...e)),"onUpdate:modelValue":t[1]||(t[1]=e=>l.query=e),type:"text"},null,544),[[O,l.query]]),l.tracks.length?(o(),d(u,{key:0,heading:"Songs"},{default:v(()=>[(o(!0),c(f,null,y(l.tracks,e=>(o(),d(p,{key:e.url,cover:e.cover,href:e.url,artist:e.artists.join(", "),title:e.title},null,8,["cover","href","artist","title"]))),128))]),_:1})):m("",!0),l.spotifyTracks.length?(o(),d(u,{key:1,heading:"Songs (Spotify)"},{default:v(()=>[(o(!0),c(f,null,y(l.spotifyTracks,e=>(o(),d(g,{key:e.url,preview:e.preview,cover:e.cover,href:e.url,artist:e.artists.join(", "),title:e.title},null,8,["preview","cover","href","artist","title"]))),128))]),_:1})):m("",!0),l.youtubeTracks.length?(o(),d(u,{key:2,heading:"Songs (Youtube)"},{default:v(()=>[(o(!0),c(f,null,y(l.youtubeTracks,e=>(o(),d(g,{key:e.url,cover:e.cover,href:e.url,artist:e.artists.join(", "),title:e.title},null,8,["cover","href","artist","title"]))),128))]),_:1})):m("",!0),l.artists.length?(o(),d(u,{key:3,heading:"Artists"},{default:v(()=>[(o(!0),c(f,null,y(l.artists,e=>(o(),d(b,{key:e.url,cover:e.cover,href:e.url,artist:e.artists.join(", "),title:e.title},null,8,["cover","href","artist","title"]))),128))]),_:1})):m("",!0),l.spotifyArtists.length?(o(),d(u,{key:4,heading:"Artists (Spotify)"},{default:v(()=>[(o(!0),c(f,null,y(l.spotifyArtists,(e,A)=>(o(),d(a,{key:A,cover:e.cover,description:e.description,name:e.name,id:e.id,showFollowButton:!0},null,8,["cover","description","name","id"]))),128))]),_:1})):m("",!0)])}var St=S(ct,[["render",ut],["__scopeId","data-v-60a8c683"]]);export{St as default};
