import{F as D}from"./FullShelf.34afbeba.js";import{_ as A,o as u,c as g,a as s,t as m,n as x,j as F,k as C,F as y,d as T,e as M,w as j,p as k,h as B,g as I}from"./index.f20fcaa5.js";const N={name:"FootballItem",methods:{redirect(){window.open(this.oref)},remove(r){r.stopPropagation(),this.$emit("remove")}},props:{result:String,date:String,competition:String,href:String,oref:String,team1:String,team2:String,progress:String}},H={class:"itemBig"},L={class:"wrapper topalign"},O={class:"wrapper"},$=["innerHTML"],b=["innerHTML"],P=["innerHTML"],U={class:"wrapper bottomalign"},J={class:"small"};function R(r,t,e,a,n,o){var d;return u(),g("div",H,[s("div",{class:"item",onClick:t[1]||(t[1]=(...p)=>o.redirect&&o.redirect(...p))},[s("div",L,[s("p",null,m(e.competition),1),s("p",{class:x(["right progress",{accent:(d=e.progress)==null?void 0:d.includes("'")}])},m(e.progress),3)]),s("div",O,[s("p",{innerHTML:e.team1,class:"team"},null,8,$),s("h4",{class:"result",innerHTML:e.result},null,8,b),s("p",{innerHTML:e.team2,class:"team"},null,8,P)]),s("div",U,[s("p",J,m(e.date)+", "+m(e.href),1),s("span",{onClick:t[0]||(t[0]=(...p)=>o.remove&&o.remove(...p)),class:"deleteIcon small material-icons-round"},"clear")])])])}var V=A(N,[["render",R],["__scopeId","data-v-01081bf6"]]);const W={components:{FullShelf:D,FootballItem:V},name:"Sports",data(){return{sports:[],watchMatches:[],sourceToAdd:"",supportedSources:["https://onefootball.com/en/team/","https://onefootball.com/en/match/","https://onefootball.com/en/competition/","https://www.cev.eu/match-centres/","https://championsleague.cev.eu/en/match-centres/","https://www.cev.eu/calendar/"]}},mounted(){this.watchMatches=JSON.parse(window.localStorage.getItem("sports.watchMatches"))||[],this.updateMatches()},methods:{removeSource(r,t,e){this.watchMatches.splice(this.watchMatches.indexOf(r),1),this.sports[t].items.splice(e,1),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches))},tryAddSource(){for(const r of this.supportedSources)if(this.sourceToAdd.startsWith(r)){this.addSource();return}alert("unsupported source")},addSource(){this.watchMatches.push(this.sourceToAdd),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches)),this.sourceToAdd=""},updateMatches(){if(!(this.$route.path=="/sports"||this.$route.path=="/sports/")){console.log("not update",this.$route.path);return}fetch("http://localhost:1234/api/match",{method:"POST",body:JSON.stringify({urls:this.watchMatches})}).then(r=>r.json()).then(r=>{this.sports=[];for(const t of r){const e=this.sports.findIndex(a=>a.sport==t.sport);e>=0?this.sports[e].items.push(t):this.sports.push({sport:t.sport,icon:t.sportIcon,items:[t]})}for(const t of this.sports)t.items.sort((e,a)=>{if(e.progress=e.progress.replace("Half time","45'"),a.progress=a.progress.replace("Half time","45'"),(e.progress.includes("Pens")||e.progress.includes("N/A"))&&(e.progress="Full time"),(a.progress.includes("Pens")||a.progress.includes("N/A"))&&(a.progress="Full time"),e.progress.includes("'")&&!a.progress.includes("'"))return-1;if(!e.progress.includes("'")&&a.progress.includes("'"))return 1;if(e.progress.includes("'")&&a.progress.includes("'")){const _=Number(e.progress.replace("'","").replace("+","")),S=Number(a.progress.replace("'","").replace("+",""));return _<S?-1:_==S?0:1}let n=e.date.split(" ")[0],o=a.date.split(" ")[0],d=e.progress.replace("'","").replace("Full time","24:00").replace(" ",""),p=a.progress.replace("'","").replace("Full time","24:00").replace(" ",""),i=new Date,h=new Date;h.setUTCDate(i.getUTCDate()+1);let l=new Date;l.setUTCDate(i.getUTCDate()-1);const c=_=>_.toISOString().split("T")[0];n=n.replace("Today",c(i)).split("/").reverse().join("-"),n=n.replace("Tomorrow",c(h)).split("/").reverse().join("-"),n=n.replace("Yesterday",c(l)).split("/").reverse().join("-"),o=o.replace("Today",c(i)).split("/").reverse().join("-"),o=o.replace("Tomorrow",c(h)).split("/").reverse().join("-"),o=o.replace("Yesterday",c(l)).split("/").reverse().join("-");let v=new Date(`${n}T${d}`.replace(" ","")),w=new Date(`${o}T${p}`.replace(" ",""));return v>w?-1:v==w?0:1})}),setTimeout(this.updateMatches,1e3*45)}}},f=r=>(k("data-v-59d898dd"),r=r(),B(),r),Y={class:"news"},z=f(()=>s("div",{class:"padding-20"},[s("h1",null,"Sports")],-1)),E=f(()=>s("hr",null,null,-1)),K={class:"padding-20"},q={class:"small"},G={class:"addWrapper"},Q=f(()=>s("hr",null,null,-1));function X(r,t,e,a,n,o){const d=I("football-item"),p=I("full-shelf");return u(),g("div",Y,[z,E,s("div",K,[s("p",q,"Supported urls: "+m(n.supportedSources.join("*, ")),1),s("div",G,[F(s("input",{onKeyup:t[0]||(t[0]=(...i)=>r.enterText&&r.enterText(...i)),"onUpdate:modelValue":t[1]||(t[1]=i=>n.sourceToAdd=i),type:"text"},null,544),[[C,n.sourceToAdd]]),s("span",{id:"addToPlaylist",onClick:t[2]||(t[2]=(...i)=>o.tryAddSource&&o.tryAddSource(...i)),class:"material-icons-outlined"},"add_circle")]),Q,(u(!0),g(y,null,T(n.sports,(i,h)=>(u(),M(p,{key:i.sport,heading:i.sport,icon:i.icon},{default:j(()=>[(u(!0),g(y,null,T(i.items,(l,c)=>(u(),M(d,{key:l.href,onRemove:()=>o.removeSource(l.sref,h,c),competition:l.competition,team1:l.team1,team2:l.team2,result:l.result,date:l.date,href:l.href,oref:l.oref,progress:l.progress},null,8,["onRemove","competition","team1","team2","result","date","href","oref","progress"]))),128))]),_:2},1032,["heading","icon"]))),128))])])}var te=A(W,[["render",X],["__scopeId","data-v-59d898dd"]]);export{te as default};
