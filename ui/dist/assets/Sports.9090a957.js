import{F as D}from"./FullShelf.83d67d69.js";import{_ as A,o as u,c as g,a as t,t as m,n as F,w as b,l as k,F as y,h as T,i as M,f as C,p as N,k as B,g as I,b as x}from"./index.caf9dd62.js";const j={name:"FootballItem",methods:{redirect(){window.open(this.oref)},remove(r){r.stopPropagation(),this.$emit("remove")}},props:{result:String,date:String,competition:String,href:String,oref:String,team1:String,team2:String,progress:String}},H={class:"itemBig"},L={class:"wrapper topalign"},O={class:"wrapper"},$=["innerHTML"],P=["innerHTML"],U=["innerHTML"],J={class:"wrapper bottomalign"},V={class:"small"};function E(r,s,e,a,n,o){var d;return u(),g("div",H,[t("div",{class:"item",onClick:s[1]||(s[1]=(...p)=>o.redirect&&o.redirect(...p))},[t("div",L,[t("p",null,m(e.competition),1),t("p",{class:F(["right progress",{accent:(d=e.progress)==null?void 0:d.includes("'")}])},m(e.progress),3)]),t("div",O,[t("p",{innerHTML:e.team1,class:"team"},null,8,$),t("h4",{class:"result",innerHTML:e.result},null,8,P),t("p",{innerHTML:e.team2,class:"team"},null,8,U)]),t("div",J,[t("p",V,m(e.date)+", "+m(e.href),1),t("span",{onClick:s[0]||(s[0]=(...p)=>o.remove&&o.remove(...p)),class:"deleteIcon small material-icons-round"},"clear")])])])}var R=A(j,[["render",E],["__scopeId","data-v-01081bf6"]]);const W={components:{FullShelf:D,FootballItem:R},name:"Sports",data(){return{sports:[],watchMatches:[],sourceToAdd:"",supportedSources:["https://onefootball.com/en/team/","https://onefootball.com/en/match/","https://onefootball.com/en/competition/"]}},mounted(){this.watchMatches=JSON.parse(window.localStorage.getItem("sports.watchMatches"))||[],this.updateMatches()},methods:{removeSource(r,s,e){this.watchMatches.splice(this.watchMatches.indexOf(r),1),this.sports[s].items.splice(e,1),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches))},tryAddSource(){for(const r of this.supportedSources)if(this.sourceToAdd.startsWith(r)){this.addSource();return}alert("unsupported source")},addSource(){this.watchMatches.push(this.sourceToAdd),window.localStorage.setItem("sports.watchMatches",JSON.stringify(this.watchMatches)),this.sourceToAdd=""},updateMatches(){if(!(this.$route.path=="/sports"||this.$route.path=="/sports/")){console.log("not update",this.$route.path);return}fetch("/api/match",{method:"POST",body:JSON.stringify({urls:this.watchMatches})}).then(r=>r.json()).then(r=>{this.sports=[];for(const s of r){const e=this.sports.findIndex(a=>a.sport==s.sport);e>=0?this.sports[e].items.push(s):this.sports.push({sport:s.sport,icon:s.sportIcon,items:[s]})}for(const s of this.sports)s.items.sort((e,a)=>{if(e.progress=e.progress.replace("Half time","45'"),a.progress=a.progress.replace("Half time","45'"),(e.progress.includes("Pens")||e.progress.includes("N/A"))&&(e.progress="Full time"),(a.progress.includes("Pens")||a.progress.includes("N/A"))&&(a.progress="Full time"),e.progress.includes("'")&&!a.progress.includes("'"))return-1;if(!e.progress.includes("'")&&a.progress.includes("'"))return 1;if(e.progress.includes("'")&&a.progress.includes("'")){const _=Number(e.progress.replace("'","").replace("+","")),w=Number(a.progress.replace("'","").replace("+",""));return _<w?-1:_==w?0:1}let n=e.date.split(" ")[0],o=a.date.split(" ")[0],d=e.progress.replace("'","").replace("Full time","24:00").replace(" ",""),p=a.progress.replace("'","").replace("Full time","24:00").replace(" ",""),i=new Date,h=new Date;h.setUTCDate(i.getUTCDate()+1);let l=new Date;l.setUTCDate(i.getUTCDate()-1);const c=_=>_.toISOString().split("T")[0];n=n.replace("Today",c(i)).split("/").reverse().join("-"),n=n.replace("Tomorrow",c(h)).split("/").reverse().join("-"),n=n.replace("Yesterday",c(l)).split("/").reverse().join("-"),o=o.replace("Today",c(i)).split("/").reverse().join("-"),o=o.replace("Tomorrow",c(h)).split("/").reverse().join("-"),o=o.replace("Yesterday",c(l)).split("/").reverse().join("-");let v=new Date(`${n}T${d}`.replace(" ","")),S=new Date(`${o}T${p}`.replace(" ",""));return v>S?-1:v==S?0:1})}),setTimeout(this.updateMatches,1e3*45)}}},f=r=>(N("data-v-4b4b05b3"),r=r(),B(),r),Y={class:"news"},z=f(()=>t("div",{class:"padding-20"},[t("h1",null,"Sports")],-1)),K=f(()=>t("hr",null,null,-1)),q={class:"padding-20"},G={class:"small"},Q=f(()=>t("p",{class:"small"},[t("i",null,[I("CEV matches are temporarily not supported. Check out your favourite games on "),t("a",{href:"https://cev-nex.tk"},"cev-nex.tk"),I(" in the meantime.")])],-1)),X={class:"addWrapper"},Z=f(()=>t("hr",null,null,-1));function ee(r,s,e,a,n,o){const d=x("football-item"),p=x("full-shelf");return u(),g("div",Y,[z,K,t("div",q,[t("p",G,"Supported urls: "+m(n.supportedSources.join("*, ")),1),Q,t("div",X,[b(t("input",{onKeyup:s[0]||(s[0]=(...i)=>r.enterText&&r.enterText(...i)),"onUpdate:modelValue":s[1]||(s[1]=i=>n.sourceToAdd=i),type:"text"},null,544),[[k,n.sourceToAdd]]),t("span",{id:"addToPlaylist",onClick:s[2]||(s[2]=(...i)=>o.tryAddSource&&o.tryAddSource(...i)),class:"material-icons-outlined"},"add_circle")]),Z,(u(!0),g(y,null,T(n.sports,(i,h)=>(u(),M(p,{key:i.sport,heading:i.sport,icon:i.icon},{default:C(()=>[(u(!0),g(y,null,T(i.items,(l,c)=>(u(),M(d,{key:l.href,onRemove:()=>o.removeSource(l.sref,h,c),competition:l.competition,team1:l.team1,team2:l.team2,result:l.result,date:l.date,href:l.href,oref:l.oref,progress:l.progress},null,8,["onRemove","competition","team1","team2","result","date","href","oref","progress"]))),128))]),_:2},1032,["heading","icon"]))),128))])])}var re=A(W,[["render",ee],["__scopeId","data-v-4b4b05b3"]]);export{re as default};
