import{F as b,G as k}from"./FixedPlaylistHeader.f317c5c6.js";import{P as x}from"./PlaylistEntry.4262bf01.js";import{_ as N,o as r,c as d,e as p,n as P,w,f as H,a as i,t as u,F as C,h as S,i as T,g as D,p as I,k as V,b as c,d as B}from"./index.2f14e5a2.js";import"./EditSong.470270d6.js";import"./FindSources.23aed4a7.js";const F={components:{PlaylistEntry:x,FixedPlaylistHeader:b,GridHeader:k},name:"Tracks",data(){return this.updateTracks(),{fixedHeaderHidden:!0,playlist:[],playlistName:"N/A"}},methods:{connect(){const t=this;console.log("attempting reconnect");let s=new WebSocket("ws://localhost:1234/ws");s.onclose=function(){console.log("ws closed"),setTimeout(this.connect,1e3)},s.onopen=()=>{console.log("ws connected")},s.onmessage=function(o){const l=JSON.parse(o.data);t.updateData(l)}},updateData(t){var s;if(t.path=="player.song"){let o=((s=t==null?void 0:t.data)==null?void 0:s.title)||"N/A";for(const l of this.playlist)l.playing=l.title==o}},headerVisibilityChanged(t){this.fixedHeaderHidden=t},updateTracks(){fetch("/api/collection/tracks").then(t=>t.json()).then(t=>{this.playlist=t.songs,this.playlistName=t.name,console.log(this.playlist),this.connect()})},loadPlaylist(){fetch("/api/loadPlaylist",{method:"POST",body:JSON.stringify({type:"collection"})})}}},y=t=>(I("data-v-d0b27bd6"),t=t(),V(),t),E={class:"playlist"},O={class:"padding-20"},A=D("Playlist"),G=y(()=>i("hr",null,null,-1)),J={class:"padding-20"},z={class:"grid"},L=y(()=>i("hr",null,null,-1)),M={class:"playlistEntries"};function W(t,s,o,l,a,n){const h=c("fixed-playlist-header"),f=c("h7"),g=c("grid-header"),v=c("playlist-entry"),m=B("observe-visibility");return r(),d("div",E,[p(h,{onClick:n.loadPlaylist,ref:"fixedHeading",class:P({hidden:a.fixedHeaderHidden}),title:a.playlistName},null,8,["onClick","class","title"]),w((r(),d("div",O,[p(f,null,{default:H(()=>[A]),_:1}),i("h1",null,u(a.playlistName),1),i("h5",null,"Your "+u(a.playlist.length)+" favourite tracks, auto-generated just for you",1)])),[[m,n.headerVisibilityChanged]]),G,i("div",J,[i("span",{id:"loadPlaylist",onClick:s[0]||(s[0]=(...e)=>n.loadPlaylist&&n.loadPlaylist(...e)),class:"material-icons-outlined"},"play_circle_filled"),i("div",z,[p(g,{class:"hideIfMobile"}),L,i("div",M,[(r(!0),d(C,null,S(a.playlist,(e,_)=>(r(),T(v,{key:_,index:_,source:e.source,id:e.id,title:e.title,playing:e.playing,album:e.album,artist:e.artist,cover:e.cover,favourite:e.favourite,duration:e.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])])])])}var U=N(F,[["render",W],["__scopeId","data-v-d0b27bd6"]]);export{U as default};
