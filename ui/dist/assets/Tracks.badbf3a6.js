import{F as k,G as x}from"./FixedPlaylistHeader.56bfab41.js";import{P as b}from"./PlaylistEntry.12ad5f8a.js";import{_ as N,o as c,c as d,g as p,k as w,m as P,w as H,b as C,a as i,t as u,F as S,i as T,f as D,e as r,l as I,p as V,h as B}from"./index.50099120.js";import"./EditSong.79e013d7.js";import"./FindSources.5354eecb.js";const F={components:{PlaylistEntry:b,FixedPlaylistHeader:k,GridHeader:x},name:"Tracks",data(){return this.updateTracks(),{fixedHeaderHidden:!0,playlist:[],playlistName:"N/A"}},methods:{connect(){const e=this;console.log("attempting reconnect");let s=new WebSocket("ws://localhost:1234/ws");s.onclose=function(){console.log("ws closed"),setTimeout(this.connect,1e3)},s.onopen=()=>{console.log("ws connected")},s.onmessage=function(o){const l=JSON.parse(o.data);e.updateData(l)}},updateData(e){var s;if(e.path=="player.song"){let o=((s=e==null?void 0:e.data)==null?void 0:s.title)||"N/A";for(const l of this.playlist)l.playing=l.title==o}},headerVisibilityChanged(e){this.fixedHeaderHidden=e},updateTracks(){fetch("/api/me/liked").then(e=>e.json()).then(e=>{this.playlist=e.songs,this.playlistName=e.name,console.log(this.playlist),this.connect()})},loadPlaylist(){fetch("/api/player/load",{method:"POST",body:JSON.stringify({type:"collection"})})}}},y=e=>(V("data-v-20f00f1f"),e=e(),B(),e),E={class:"playlist"},O={class:"padding-20"},A=y(()=>i("hr",null,null,-1)),G={class:"padding-20"},J={class:"grid"},z=y(()=>i("hr",null,null,-1)),L={class:"playlistEntries"};function M(e,s,o,l,a,n){const h=r("fixed-playlist-header"),f=r("h7"),g=r("grid-header"),m=r("playlist-entry"),v=I("observe-visibility");return c(),d("div",E,[p(h,{onClick:n.loadPlaylist,ref:"fixedHeading",class:w({hidden:a.fixedHeaderHidden}),title:a.playlistName},null,8,["onClick","class","title"]),P((c(),d("div",O,[p(f,null,{default:H(()=>[C("Playlist")]),_:1}),i("h1",null,u(a.playlistName),1),i("h5",null,"Your "+u(a.playlist.length)+" favourite tracks, auto-generated just for you",1)])),[[v,n.headerVisibilityChanged]]),A,i("div",G,[i("span",{id:"loadPlaylist",onClick:s[0]||(s[0]=(...t)=>n.loadPlaylist&&n.loadPlaylist(...t)),class:"material-icons-outlined"},"play_circle_filled"),i("div",J,[p(g,{class:"hideIfMobile"}),z,i("div",L,[(c(!0),d(S,null,T(a.playlist,(t,_)=>(c(),D(m,{key:_,index:_,source:t.source,id:t.id,title:t.title,playing:t.playing,album:t.album,artist:t.artist,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["index","source","id","title","playing","album","artist","cover","favourite","duration"]))),128))])])])])}const R=N(F,[["render",M],["__scopeId","data-v-20f00f1f"]]);export{R as default};
