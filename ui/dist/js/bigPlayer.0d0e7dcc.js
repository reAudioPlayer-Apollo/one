(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bigPlayer"],{1919:function(t,e,o){},"4fce":function(t,e,o){"use strict";o("1919")},"57eb":function(t,e,o){},6208:function(t,e,o){"use strict";o.r(e);o("867d");var n=o("69be"),i={class:"bigPlayer"},a={class:"upNow"},l=["src"],s={class:"playlistOverflow"},c={class:"playlist"};function r(t,e,o,r,d,u){var p=Object(n["resolveComponent"])("spotify-playlist-header"),f=Object(n["resolveComponent"])("light-playlist-entry");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",i,[Object(n["createElementVNode"])("div",a,[Object(n["createElementVNode"])("img",{src:d.cover},null,8,l)]),Object(n["createElementVNode"])("div",s,[Object(n["createElementVNode"])("div",c,[Object(n["createVNode"])(p),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(d.playlist.songs,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(f,{key:e.source,onDownload:t.download,onRequestUpdate:t.updatePlaylist,index:d.playlist.songs.findIndex((function(t){return t.source==e.source})),source:e.source,playing:e.playing,id:e.id,title:e.title,album:e.album,artist:e.artist,cover:e.cover,favourite:e.favourite,duration:e.duration},null,8,["onDownload","onRequestUpdate","index","source","playing","id","title","album","artist","cover","favourite","duration"])})),128))])])])}var d=o("1494"),u=(o("3efd"),{class:"track"}),p=["src"],f={class:"trackwrapper"},h={class:"duration"};function y(t,e,o,i,a,l){var s=Object(n["resolveComponent"])("EditSong"),c=Object(n["resolveComponent"])("Marquee"),r=Object(n["resolveComponent"])("SongCtx");return Object(n["openBlock"])(),Object(n["createBlock"])(r,{onDownload:l.download,onAddto:l.addToPlaylist,onRemove:l.remove,onUpdate:l.update,onLike:e[5]||(e[5]=function(t){return a.favourited=!a.favourited}),isAutoPlaylist:a.isAutoPlaylist,liked:a.favourited,ref:"ctxMenu"},{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(s,{onClose:t.updatePlaylist,ref:"editSongPopup",cover:o.cover,id:o.id,title:o.title,album:o.album,artist:o.artist,source:o.source},null,8,["onClose","cover","id","title","album","artist","source"]),Object(n["createElementVNode"])("div",{onDblclick:e[1]||(e[1]=function(){l.playAt(),l.onselect()}),onClick:e[2]||(e[2]=function(){return l.onselect&&l.onselect.apply(l,arguments)}),onMouseover:e[3]||(e[3]=function(){return l.displayPlay&&l.displayPlay.apply(l,arguments)}),onMouseleave:e[4]||(e[4]=function(){return l.displayId&&l.displayId.apply(l,arguments)}),class:Object(n["normalizeClass"])(["playlistEntry",{selected:a.highlighted}])},[Object(n["createElementVNode"])("span",{onClick:e[0]||(e[0]=function(){return l.playAt&&l.playAt.apply(l,arguments)}),ref:"idOrPlay",class:Object(n["normalizeClass"])([{playing:o.playing},"id"])},Object(n["toDisplayString"])(o.index+1),3),Object(n["createElementVNode"])("div",u,[Object(n["createElementVNode"])("img",{src:o.cover||"/assets/img/music_placeholder.png"},null,8,p),Object(n["createElementVNode"])("div",f,[Object(n["createElementVNode"])("span",{class:Object(n["normalizeClass"])(["title",{playing:o.playing}])},[Object(n["createVNode"])(c,{text:o.title},null,8,["text"])],2),Object(n["createElementVNode"])("span",{class:Object(n["normalizeClass"])(["artist",{playing:o.playing}])},[Object(n["createVNode"])(c,{text:o.artist},null,8,["text"])],2)])]),Object(n["createElementVNode"])("span",h,Object(n["toDisplayString"])(o.duration),1)],34)]})),_:1},8,["onDownload","onAddto","onRemove","onUpdate","isAutoPlaylist","liked"])}o("dfac"),o("f258");var v=o("a279"),b=o("d0cc"),m=o("5acf"),g={name:"LightPlaylistEntry",components:{SongCtx:v["a"],EditSong:m["a"],Marquee:b["a"]},props:{index:Number,id:Number,artist:{type:String,default:"N/A"},title:{type:String,default:"N/A"},cover:{type:String,default:"/assets/img/music_placeholder.png"},source:String,album:{type:String,default:"N/A"},duration:{type:String,default:"N/A"},favourite:{type:Boolean,default:!1},playing:{type:Boolean,default:!1}},data:function(){return{highlighted:!1,favourited:this.favourite,isAutoPlaylist:"/collection/tracks"==this.$route.path,hovering:!1}},methods:{download:function(){window.open("http://localhost:1234/api/download/"+this.id)},addToPlaylist:function(t){var e=this;fetch("http://localhost:1234/api/add",{method:"POST",body:JSON.stringify({id:t,source:this.source})}).then((function(t){200==t.status&&e.$emit("requestUpdate")}))},update:function(){this.$refs.editSongPopup.showModal=!0},remove:function(){fetch("http://localhost:1234/api/remove",{method:"POST",body:JSON.stringify({playlistId:Number(this.$route.params.id),songId:this.id})})},onselect:function(){this.highlighted=!this.highlighted},playAt:function(){console.log(this.$route.path);var t={index:this.index};t.playlistIndex=Number(this.$route.params.id),fetch("http://localhost:1234/api/at",{method:"POST",body:JSON.stringify(t)})},setFavourite:function(){fetch("http://localhost:1234/api/updateSong",{method:"POST",body:JSON.stringify({id:this.id,favourite:this.favourited,album:this.album,artist:this.artist,title:this.title,duration:this.duration,cover:this.cover,source:this.source})})},displayPlay:function(){var t=this.$refs.idOrPlay;t.innerHTML="play_arrow",t.classList.add("material-icons-round")},displayId:function(){var t=this.$refs.idOrPlay;t.innerHTML=this.index+1,t.classList.remove("material-icons-round")}},watch:{added:function(){console.log("change"),this.$refs.add.innerHTML=this.added?"done":"add"},favourited:function(){this.setFavourite()},favourite:function(){console.log("mounted",this.title,this.favourite,this.favourited),this.favourited=this.favourite,this.highlighted=!1}}},O=(o("d939"),o("1c27")),j=o.n(O);const N=j()(g,[["render",y],["__scopeId","data-v-067ce478"]]);var P=N,S=o("bca3"),w={components:{LightPlaylistEntry:P,SpotifyPlaylistHeader:S["a"]},name:"BigPlayer",methods:{fetchPlaylist:function(){var t=this;fetch("http://localhost:1234/api/playlist",{method:"POST"}).then((function(t){return t.json()})).then((function(e){return t.playlist=e}))},updateData:function(t){if("player.song"!=t.path);else{var e,o;this.cover=(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.cover)||"/assets/img/music_placeholder.png";var n,i=(null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.title)||"N/A",a=Object(d["a"])(this.playlist.songs);try{for(a.s();!(n=a.n()).done;){var l=n.value;l.playing=l.title==i}}catch(s){a.e(s)}finally{a.f()}}}},data:function(){var t=this,e=function e(){console.log("attempting reconnect");var o=new WebSocket("ws://localhost:1234/ws");o.onclose=function(){console.log("ws closed"),setTimeout(e,1e3)},o.onopen=function(){console.log("ws connected")},o.onmessage=function(e){var o=JSON.parse(e.data);t.updateData(o)}};return e(),this.fetchPlaylist(),{cover:"/assets/img/music_placeholder.png",playlist:[]}}};o("9ea9");const k=j()(w,[["render",r],["__scopeId","data-v-af136c2e"]]);e["default"]=k},"867d":function(t,e,o){"use strict";var n=o("e6df"),i=o("fe06").findIndex,a=o("513e"),l="findIndex",s=!0;l in[]&&Array(1)[l]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a(l)},"9ea9":function(t,e,o){"use strict";o("b1bc")},b1bc:function(t,e,o){},bca3:function(t,e,o){"use strict";var n=o("69be"),i=function(t){return Object(n["pushScopeId"])("data-v-491e69c7"),t=t(),Object(n["popScopeId"])(),t},a={class:"gridHeader"},l=i((function(){return Object(n["createElementVNode"])("span",{class:"id"},"#",-1)})),s=i((function(){return Object(n["createElementVNode"])("span",{class:"title"},"Title",-1)})),c=[l,s];function r(t,e,o,i,l,s){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",a,c)}var d={name:"SpotifyPlaylistHeader"},u=(o("4fce"),o("1c27")),p=o.n(u);const f=p()(d,[["render",r],["__scopeId","data-v-491e69c7"]]);e["a"]=f},d939:function(t,e,o){"use strict";o("57eb")}}]);
//# sourceMappingURL=bigPlayer.0d0e7dcc.js.map