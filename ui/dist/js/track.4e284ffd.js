(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["track"],{"3ae5":function(e,t,n){"use strict";var a=n("69be"),i={class:"track"},o=["src"],c={class:"trackwrapper"},r={class:"title"},l={class:"artist"};function s(e,t,n,s,d,u){var p=Object(a["resolveComponent"])("mini-player");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{onDblclick:t[2]||(t[2]=function(){u.playAt(),u.onselect()}),onClick:t[3]||(t[3]=function(){return u.onselect&&u.onselect.apply(u,arguments)}),onMouseover:t[4]||(t[4]=function(e){return d.hovering=!0}),onMouseleave:t[5]||(t[5]=function(e){return d.hovering=!1}),class:Object(a["normalizeClass"])(["playlistEntry",{selected:d.highlighted}])},[Object(a["createVNode"])(p,{class:Object(a["normalizeClass"])(["miniPlayer",{hidden:!d.hovering}]),src:n.preview},null,8,["class","src"]),d.hovering?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,onClick:t[0]||(t[0]=function(){return e.edit&&e.edit.apply(e,arguments)}),class:"id"},Object(a["toDisplayString"])(n.index+1),1)),Object(a["createElementVNode"])("div",i,[Object(a["createElementVNode"])("img",{src:n.cover||"/assets/img/music_placeholder.png"},null,8,o),Object(a["createElementVNode"])("div",c,[Object(a["createElementVNode"])("span",r,Object(a["toDisplayString"])(n.title),1),Object(a["createElementVNode"])("span",l,Object(a["toDisplayString"])(n.artist),1)]),Object(a["createCommentVNode"])("",!0)]),Object(a["createElementVNode"])("span",{onClick:t[1]||(t[1]=function(){return u.add&&u.add.apply(u,arguments)}),class:"material-icons-round edit",ref:"add"},"add",512)],34)}n("dfac"),n("3efd"),n("f258");var d=n("cb9b"),u={components:{MiniPlayer:d["a"]},name:"SpotifyPlaylistEntry",props:{index:Number,id:Number,source:String,artist:{type:String,default:"N/A"},title:{type:String,default:"N/A"},added:Boolean,cover:String,album:String,preview:String},data:function(){return{highlighted:!1,favourited:this.favourite,isAutoPlaylist:"/collection/tracks"==this.$route.path,hovering:!1}},methods:{remove:function(){fetch("http://localhost:1234/api/remove",{method:"POST",body:JSON.stringify({playlistId:Number(this.$route.params.id),songId:this.id})})},onselect:function(){this.highlighted=!this.highlighted},playAt:function(){this.$emit("edit",this.index)},add:function(){console.log("add"),this.$emit("add",this.index)}},watch:{added:function(){console.log("change"),this.$refs.add.innerHTML=this.added?"done":"add"}}},p=(n("577c"),n("1c27")),f=n.n(p);const h=f()(u,[["render",s],["__scopeId","data-v-4d350ce2"]]);t["a"]=h},"44bd":function(e,t,n){"use strict";n("a95c")},"577c":function(e,t,n){"use strict";n("c326")},"907b":function(e,t,n){"use strict";n.r(t);n("867d"),n("ed98");var a=n("69be"),i=function(e){return Object(a["pushScopeId"])("data-v-53e843e2"),e=e(),Object(a["popScopeId"])(),e},o={class:"playlist"},c=["src"],r={class:"details"},l=Object(a["createTextVNode"])("Song"),s=i((function(){return Object(a["createElementVNode"])("hr",null,null,-1)})),d={class:"padding-20"},u={class:"grid"},p=i((function(){return Object(a["createElementVNode"])("hr",null,null,-1)})),f={class:"playlistEntries"};function h(e,t,n,i,h,m){var y=Object(a["resolveComponent"])("fixed-playlist-header"),b=Object(a["resolveComponent"])("h7"),v=Object(a["resolveComponent"])("grid-header"),O=Object(a["resolveComponent"])("spotify-playlist-entry"),g=Object(a["resolveComponent"])("draggable"),j=Object(a["resolveDirective"])("observe-visibility");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",o,[Object(a["createVNode"])(y,{onLoadPlaylist:m.loadPlaylist,ref:"fixedHeading",class:Object(a["normalizeClass"])({hidden:h.fixedHeaderHidden}),title:e.playlistName},null,8,["onLoadPlaylist","class","title"]),Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:"padding-20 songdetails",onClick:t[0]||(t[0]=function(){return m.editPlaylist&&m.editPlaylist.apply(m,arguments)})},[Object(a["createElementVNode"])("img",{class:"cover",src:h.cover},null,8,c),Object(a["createElementVNode"])("div",r,[Object(a["createVNode"])(b,null,{default:Object(a["withCtx"])((function(){return[l]})),_:1}),Object(a["createElementVNode"])("h1",null,Object(a["toDisplayString"])(h.title),1),Object(a["createElementVNode"])("h5",null,Object(a["toDisplayString"])(h.artist),1)])])),[[j,m.headerVisibilityChanged]]),s,Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("span",{id:"loadPlaylist",onClick:t[1]||(t[1]=function(){return m.loadPlaylist&&m.loadPlaylist.apply(m,arguments)}),class:"material-icons-outlined"},"play_circle_filled"),Object(a["createElementVNode"])("span",{id:"addToPlaylist",onClick:t[2]||(t[2]=function(){return m.addToPlaylist&&m.addToPlaylist.apply(m,arguments)}),class:"material-icons-outlined"},"add_circle"),Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("h2",null,Object(a["toDisplayString"])("Recommendations based on "+h.title),1),Object(a["createVNode"])(v),p,Object(a["createElementVNode"])("div",f,[Object(a["createVNode"])(g,{modelValue:h.recommendations,"onUpdate:modelValue":t[3]||(t[3]=function(e){return h.recommendations=e})},{item:Object(a["withCtx"])((function(e){var t=e.element;return[Object(a["createVNode"])(O,{onRequestUpdate:m.updatePlaylist,index:h.recommendations.findIndex((function(e){return e.src==t.src})),source:t.src,id:t.id,title:t.title,album:t.album,artist:t.artists.join(", "),preview:t.preview,cover:t.cover,favourite:t.favourite,duration:t.duration},null,8,["onRequestUpdate","index","source","id","title","album","artist","preview","cover","favourite","duration"])]})),_:1},8,["modelValue"])])])])])}var m=n("e599"),y=n("afa6"),b=n("1494"),v=(n("a623"),n("89b1"),n("1c6f"),n("3efd"),n("f258"),n("dfac"),n("500c"),n("c988")),O=n("8ed2"),g=n("2e60"),j=n.n(g),N=n("3ae5"),P={components:{FixedPlaylistHeader:v["a"],GridHeader:O["a"],draggable:j.a,SpotifyPlaylistEntry:N["a"]},name:"Track",data:function(){return this.updatePlaylist(),{fixedHeaderHidden:!0,title:"N/A",artist:"N/A",cover:"/assets/img/music_placeholder.png",recommendations:[]}},methods:{onPlaylistRearrange:function(e){e.moved},connect:function(){var e=this;console.log("attempting reconnect");var t=new WebSocket("ws://localhost:1234/ws");t.onclose=function(){console.log("ws closed"),setTimeout(this.connect,1e3)},t.onopen=function(){console.log("ws connected")},t.onmessage=function(t){var n=JSON.parse(t.data);e.updateData(n)}},headerVisibilityChanged:function(e){this.fixedHeaderHidden=e},addToPlaylist:function(){this.$refs.addSongPopup.showModal=!0},editPlaylist:function(){this.$refs.editPlaylistPopup.showModal=!0},updateData:function(e){if("player.song"==e.path){var t,n,a=(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.title)||"N/A",i=Object(b["a"])(this.playlist);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.playing=o.title==a}}catch(c){i.e(c)}finally{i.f()}}},updatePlaylist:function(){var e=this;this.$route.params.id&&this.$route.path.includes("/track/")&&fetch("http://localhost:1234/api/track",{method:"POST",body:JSON.stringify({id:Number(this.$route.params.id)})}).then(function(){var t=Object(y["a"])(regeneratorRuntime.mark((function t(n){var a,i,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(404!=n.status){t.next=3;break}return e.$router.push("/"),t.abrupt("return");case 3:return t.next=5,n.json();case 5:return i=t.sent,console.log(i),e.title=i.title||"N/A",e.artist=i.artist||"N/A",e.cover=i.cover||"/assets/img/music_placeholder.png",document.title="".concat(e.title," â€¢ ").concat(e.artist),e.connect(),t.next=14,fetch("http://localhost:1234/api/spotify/recommend",{method:"POST",body:JSON.stringify({query:"".concat(e.artist," ").concat(e.title)})});case 14:return o=t.sent,t.next=17,o.json();case 17:c=t.sent,(a=e.recommendations).push.apply(a,Object(m["a"])(c));case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},loadPlaylist:function(){fetch("http://localhost:1234/api/loadPlaylist",{method:"POST",body:JSON.stringify({id:Number(this.$route.params.id),type:"track"})})}},watch:{$route:function(){this.updatePlaylist()}}},k=(n("44bd"),n("1c27")),V=n.n(k);const w=V()(P,[["render",h],["__scopeId","data-v-53e843e2"]]);t["default"]=w},a503:function(e,t,n){},a95c:function(e,t,n){},c0b8:function(e,t,n){"use strict";var a=n("117f");e.exports=function(e,t){var n=[][e];return!!n&&a((function(){n.call(null,t||function(){throw 1},1)}))}},c326:function(e,t,n){},cb9b:function(e,t,n){"use strict";var a=n("69be"),i={class:"miniPlayer"},o=["src"];function c(e,t,n,c,r,l){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",i,[Object(a["createElementVNode"])("audio",{src:n.src,ref:"player"},null,8,o),n.display?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",{key:0,onClick:t[0]||(t[0]=function(){return l.playPause&&l.playPause.apply(l,arguments)}),class:"material-icons-round circle"},Object(a["toDisplayString"])(r.playing?"pause":"play_arrow"),1)):Object(a["createCommentVNode"])("",!0)])}n("3efd");var r={name:"MiniPlayer",props:{src:String,display:{type:Boolean,default:!0}},data:function(){return{playing:!1}},methods:{get:function(e){fetch("http://localhost:1234/api/".concat(e))},pause:function(){this.get("pause")},play:function(){this.get("play")},playPause:function(){var e=this;this.$refs.player.onended||(this.$refs.player.onended=function(){e.playing=!1}),window.player=this.$refs.player,this.playing=this.$refs.player.paused,this.$refs.player.paused?(this.pause(),this.$refs.player.play()):this.$refs.player.pause()}}},l=(n("e383"),n("1c27")),s=n.n(l);const d=s()(r,[["render",c],["__scopeId","data-v-ef9941c4"]]);t["a"]=d},e383:function(e,t,n){"use strict";n("a503")},e599:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("73c1");function i(e){if(Array.isArray(e))return Object(a["a"])(e)}n("4228"),n("526b"),n("3efd"),n("5b8c"),n("2670"),n("324c"),n("5eca");function o(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var c=n("4e3d");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return i(e)||o(e)||Object(c["a"])(e)||r()}},ed98:function(e,t,n){"use strict";var a=n("e6df"),i=n("23ae"),o=n("00d8"),c=n("4deb"),r=n("c0b8"),l=i([].join),s=o!=Object,d=r("join",",");a({target:"Array",proto:!0,forced:s||!d},{join:function(e){return l(c(this),void 0===e?",":e)}})}}]);
//# sourceMappingURL=track.4e284ffd.js.map